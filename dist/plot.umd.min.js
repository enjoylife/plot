// @observablehq/plot v0.6.0 Copyright 2020-2022 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.6.1/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.6.1/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getUTCSeconds(),a=t.getUTCMilliseconds();return`${s=t.getUTCFullYear(),s<0?`-${r(-s,6)}`:s>9999?`+${r(s,6)}`:r(s,4)}-${r(t.getUTCMonth()+1,2)}-${r(t.getUTCDate(),2)}${n||i||o||a?`T${r(n,2)}:${r(i,2)}${o||a?`:${r(o,2)}${a?`.${r(a,3)}`:""}`:""}Z`:""}`;var s}function r(t,e){return`${t}`.padStart(e,"0")}const i=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function o(t,e){return i.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const a=Object.getPrototypeOf(Uint8Array),s=Object.prototype.toString;function l(t,e,n){const r=typeof e;return"string"===r?A(t,c(e),n):"function"===r?A(t,e,n):"number"===r||e instanceof Date||"boolean"===r?A(t,x(e),n):e&&"function"==typeof e.transform?L(e.transform(t),n):L(e,n)}const c=t=>e=>e[t],u=(t,e)=>e,f={transform:t=>t},h=()=>1,d=()=>!0,p=t=>null==t?t:`${t}`,m=t=>null==t?t:+t,g=t=>null==t?t:!!t,y=t=>t?t[0]:void 0,v=t=>t?t[1]:void 0,x=t=>()=>t;function w(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function b(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:tt(t)?[void 0,t]:[t,void 0]}function k(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function $(t,e,n){if(null!=t)return M(t,e,n)}function M(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function L(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof a?t:Array.from(t):t instanceof e?t:e.from(t)}function A(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function E(t,e=Array){return t instanceof e?t.slice():e.from(t)}function z(t){return t instanceof a}function O(t){return t?.toString===s}function C(t){return O(t)&&(void 0!==t.type||void 0!==t.domain)}function R(t){return O(t)&&"function"!=typeof t.transform}function B(t){return R(t)&&void 0===t.value&&void 0===t.channel}function N(t,e,n,r=f){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function S(t,e){return void 0===t&&void 0===e?[y,v]:[t,e]}function P({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=b(e)),void 0===t&&([t]=b(n)),t}function T(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function q(t,e){return T(t).filter((n=>e(t[n],n,t)))}function D(t,e){return A(e,(e=>t[e]))}function j(t){return null!==t&&"object"==typeof t?t.valueOf():t}function W(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function Y(t){let e;return[{transform:()=>e,label:F(t)},t=>e=t]}function _(t){return null==t?[t]:Y(t)}function F(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function I(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return V(r)||V(i)?A(r,((t,e)=>new Date((+r[e]+ +i[e])/2))):A(r,((t,e)=>(+r[e]+ +i[e])/2),Float64Array)},label:t.label}}function G(t){return void 0===t||R(t)?t:{value:t}}function X(t){return t&&"function"==typeof t[Symbol.iterator]}function U(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function H(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function V(t){for(const e of t)if(null!=e)return e instanceof Date}function Z(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&o(e)}function K(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Q(t,e){for(const n of t)if(null!=n)return e(n)}function J(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function tt(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function et(t){return null==t||nt(t)}function nt(t){return/^\s*none\s*$/i.test(t)}function rt(t="middle"){return M(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function it(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function ot(t){return X(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}let at=0;function st(t){console.warn(t),++at}function lt({projection:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n}={},s){if(null==t)return;if("function"==typeof t.stream)return t;let l,c,u="frame";if(O(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:i=(void 0!==e?e:i),insetBottom:o=(void 0!==e?e:o),insetLeft:a=(void 0!==e?e:a),clip:u=u,...l}=t),null==t)return}"function"!=typeof t&&(t=ht(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:g}=s,y=f-d-p-a-i,v=h-m-g-r-o;if(t=t?.({width:y,height:v,clip:u,...l}),null==t)return;u=function(t,n,r,i,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,i,o);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-g);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[i,o]]=e.geoPath(t).bounds(c),a=Math.min(y/(i-n),v/(o-r));a>0?(w-=(a*(n+i)-y)/2,b-=(a*(r+o)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):st("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?pt():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function ct({projection:t}={}){return null!=t&&("function"==typeof t.stream||(O(t)&&({type:t}=t),"function"!=typeof t&&(t=ht(t)),null!=t))}const ut=Math.PI,ft=2*ut;function ht(t){switch(`${t}`.toLowerCase()){case"albers-usa":return dt(e.geoAlbersUsa,.7463,.4673);case"albers":return gt(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return dt(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return dt(e.geoAzimuthalEquidistant,ft,ft);case"conic-conformal":return gt(e.geoConicConformal,ft,ft);case"conic-equal-area":return gt(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return gt(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return dt(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return dt(e.geoEquirectangular,ft,ut);case"gnomonic":return dt(e.geoGnomonic,3.4641,3.4641);case"identity":return pt;case"reflect-y":return mt;case"mercator":return dt(e.geoMercator,ft,ft);case"orthographic":return dt(e.geoOrthographic,2,2);case"stereographic":return dt(e.geoStereographic,2,2);case"transverse-mercator":return dt(e.geoTransverseMercator,ft,ft);default:throw new Error(`unknown projection type: ${t}`)}}function dt(t,e,n){return({width:r,height:i,rotate:o,precision:a=.15,clip:s})=>{const l=t();return null!=a&&l.precision?.(a),null!=o&&l.rotate?.(o),"number"==typeof s&&l.clipAngle?.(s),l.scale(Math.min(r/e,i/n)),l.translate([r/2,i/2]),l}}const pt=x({stream:t=>t}),mt=x(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function gt(t,e,n){return t=dt(t,e,n),e=>{const{parallels:n,domain:r,width:i,height:o}=e,a=t(e);return null!=n&&(a.parallels(n),void 0===r&&a.fitSize([i,o],{type:"Sphere"})),a}}function yt(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:lt(t,e)}}function vt(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}function xt(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const wt=xt((t=>new Intl.NumberFormat(t))),bt=xt(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),kt=xt(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function $t(t){return n(t,"Invalid Date")}const Mt=function(t="en-US"){const e=function(t="en-US"){const e=wt(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?$t:"number"==typeof t?e:p)(t)}(),Lt=Math.PI/180;function At(t){return null!=t&&!Number.isNaN(t)}function Et(t,n){return+At(n)-+At(t)||e.ascending(t,n)}function zt(t,n){return+At(n)-+At(t)||e.descending(t,n)}function Ot(t){return null!=t&&""!=`${t}`}function Ct(t){return isFinite(t)?t:NaN}function Rt(t){return t>0&&isFinite(t)?t:NaN}function Bt(t){return t<0&&isFinite(t)?t:NaN}const Nt="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let St=0;function Pt(){return"plot-clip-"+ ++St}function Tt(t,{title:e,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:l,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:m,strokeDasharray:g,strokeDashoffset:y,opacity:v,mixBlendMode:x,paintOrder:w,pointerEvents:$,shapeRendering:M},{ariaLabel:L,fill:A="currentColor",fillOpacity:E,stroke:z="none",strokeOpacity:O,strokeWidth:C,strokeLinecap:R,strokeLinejoin:B,strokeMiterlimit:N,paintOrder:S}){null===A&&(s=null,l=null),null===z&&(c=null,f=null),et(A)?et(z)||et(s)||(z="none"):et(z)&&!et(c)&&(A="none");const[P,T]=b(s,A),[q,D]=k(l,E),[j,W]=b(c,z),[Y,_]=k(f,O),[F,I]=k(v);nt(W)||(void 0===u&&(u=C),void 0===d&&(d=R),void 0===h&&(h=B),void 0!==m||/^\s*round\s*$/i.test(h)||(m=N),nt(T)||void 0!==w||(w=S));const[G,X]=k(u);return null!==A&&(t.fill=Ht(T,"currentColor"),t.fillOpacity=Vt(D,1)),null!==z&&(t.stroke=Ht(W,"none"),t.strokeWidth=Vt(X,1),t.strokeOpacity=Vt(_,1),t.strokeLinejoin=Ht(h,"miter"),t.strokeLinecap=Ht(d,"butt"),t.strokeMiterlimit=Vt(m,4),t.strokeDasharray=Ht(g,"none"),t.strokeDashoffset=Ht(y,"0")),t.target=p(a),t.ariaLabel=p(L),t.ariaDescription=p(i),t.ariaHidden=p(o),t.opacity=Vt(I,1),t.mixBlendMode=Ht(x,"normal"),t.paintOrder=Ht(w,"normal"),t.pointerEvents=Ht($,"auto"),t.shapeRendering=Ht(M,"auto"),{title:{value:e,optional:!0},href:{value:n,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:P,scale:"color",optional:!0},fillOpacity:{value:q,scale:"opacity",optional:!0},stroke:{value:j,scale:"color",optional:!0},strokeOpacity:{value:Y,scale:"opacity",optional:!0},strokeWidth:{value:G,optional:!0},opacity:{value:F,scale:"opacity",optional:!0}}}function qt(t,e){e&&t.text((t=>Mt(e[t])))}function Dt(t,e){e&&t.text((([t])=>Mt(e[t])))}function jt(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Xt(t,"aria-label",(t=>n[t])),i&&Xt(t,"fill",(t=>i[t])),o&&Xt(t,"fill-opacity",(t=>o[t])),a&&Xt(t,"stroke",(t=>a[t])),s&&Xt(t,"stroke-opacity",(t=>s[t])),l&&Xt(t,"stroke-width",(t=>l[t])),c&&Xt(t,"opacity",(t=>c[t])),u&&Gt(t,(t=>u[t]),e),function(t,e){e&&t.filter((t=>Ot(e[t]))).append("title").call(qt,e)}(t,r)}function Wt(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Xt(t,"aria-label",(([t])=>n[t])),i&&Xt(t,"fill",(([t])=>i[t])),o&&Xt(t,"fill-opacity",(([t])=>o[t])),a&&Xt(t,"stroke",(([t])=>a[t])),s&&Xt(t,"stroke-opacity",(([t])=>s[t])),l&&Xt(t,"stroke-width",(([t])=>l[t])),c&&Xt(t,"opacity",(([t])=>c[t])),u&&Gt(t,(([t])=>u[t]),e),function(t,e){e&&t.filter((([t])=>Ot(e[t]))).append("title").call(Dt,e)}(t,r)}function Yt(t,n,r){const i=e.group(t,(t=>n[t]));return void 0===r&&i.size>t.length>>1&&st("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),i.values()}function*_t(t,e,{z:n},r){const{z:i}=r,o=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:s,href:l}){return[t,e,n,r,i,o,a,s,l].filter((t=>void 0!==t))}(r),a=[...e,...o];for(const e of i?Yt(t,i,n):[t]){let t,n;t:for(const r of e){for(const t of a)if(!At(t[r])){n&&n.push(-1);continue t}if(void 0!==t){n.push(r);for(let e=0;e<o.length;++e){if(j(o[e][r])!==t[e]){yield n,t=o.map((t=>j(t[r]))),n=[r];continue t}}}else n&&(yield n),t=o.map((t=>j(t[r]))),n=[r]}n&&(yield n)}}function Ft(t,n,r,i,o){switch(Xt(t,"aria-label",n.ariaLabel),Xt(t,"aria-description",n.ariaDescription),Xt(t,"aria-hidden",n.ariaHidden),Xt(t,"fill",n.fill),Xt(t,"fill-opacity",n.fillOpacity),Xt(t,"stroke",n.stroke),Xt(t,"stroke-width",n.strokeWidth),Xt(t,"stroke-opacity",n.strokeOpacity),Xt(t,"stroke-linejoin",n.strokeLinejoin),Xt(t,"stroke-linecap",n.strokeLinecap),Xt(t,"stroke-miterlimit",n.strokeMiterlimit),Xt(t,"stroke-dasharray",n.strokeDasharray),Xt(t,"stroke-dashoffset",n.strokeDashoffset),Xt(t,"shape-rendering",n.shapeRendering),Xt(t,"paint-order",n.paintOrder),Xt(t,"pointer-events",n.pointerEvents),n.clip){case"frame":{const{x:e,y:n}=r,{width:o,height:a,marginLeft:s,marginRight:l,marginTop:c,marginBottom:u}=i,f=Pt();t.attr("clip-path",`url(#${f})`).append("clipPath").attr("id",f).append("rect").attr("x",s-(e?.bandwidth?e.bandwidth()/2:0)).attr("y",c-(n?.bandwidth?n.bandwidth()/2:0)).attr("width",o-l-s).attr("height",a-c-u);break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=Pt();t.attr("clip-path",`url(#${r})`).append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}}function It(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),Xt(t,"opacity",e.opacity)}function Gt(t,n,r){t.each((function(t){const i=n(t);if(null!=i){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",i),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Xt(t,e,n){null!=n&&t.attr(e,n)}function Ut(t,e,{x:n,y:r},i=Nt,o=Nt){i+=e.dx,o+=e.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&t.attr("transform",`translate(${i},${o})`)}function Ht(t,e){if((t=p(t))!==e)return t}function Vt(t,e){if((t=m(t))!==e)return t}const Zt=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Kt(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!Zt.test(t))throw new Error(`invalid class name: ${t}`);return t}function Qt(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Jt({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-i:(a+e-i)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-o:(r+n-o)/2]}class te{constructor({name:t="x",axis:e,ticks:n,tickSize:r=("fx"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:y}={}){this.name=t,this.axis=M(e,"axis",["top","bottom"]),this.ticks=re(n),this.tickSize=m(r),this.tickPadding=m(i),this.tickFormat=ie(o),this.fontVariant=Ht(a,"normal"),this.grid=g(s),this.label=p(l),this.labelAnchor=$(c,"labelAnchor",["center","left","right"]),this.labelOffset=m(u),this.line=g(f),this.tickRotate=m(h),this.ariaLabel=p(d),this.ariaDescription=p(y)}render(t,{[this.name]:n,fy:r},{width:i,height:o,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetLeft:u=0,facetMarginTop:f,facetMarginBottom:h,labelMarginLeft:d=0,labelMarginRight:p=0},m){const{axis:g,fontVariant:y,grid:v,label:x,labelAnchor:w,labelOffset:b,line:k,name:$,tickRotate:M}=this,L="top"===g?-1:1,A=L*("x"===$?0:"top"===g?a-f:l-h)+("top"===g?a:o-l);return vt("svg:g",m).call(ne,this).attr("transform",`translate(${u},${A})`).call(ae("top"===g?e.axisTop:e.axisBottom,n,this)).call(se,M).attr("font-size",null).attr("font-family",null).attr("font-variant",y).call(k?()=>{}:t=>t.select(".domain").remove()).call(v?r?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?D(i,t):i).map((t=>`M0,${e(t)+n}v${r}`)).join(""))}(t,r,-A):(E=L*(l+a-o),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("y2",E)):()=>{}).call(x?t=>t.append("text").attr("fill","currentColor").attr("transform",`translate(${"center"===w?(i+c-s)/2:"right"===w?i+p:-d},${b*L})`).attr("dy","top"===g?"1em":"-0.32em").attr("text-anchor","center"===w?"middle":"right"===w?"end":"start").text(x):()=>{}).node();var E}}class ee{constructor({name:t="y",axis:e,ticks:n,tickSize:r=("fy"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:y}={}){this.name=t,this.axis=M(e,"axis",["left","right"]),this.ticks=re(n),this.tickSize=m(r),this.tickPadding=m(i),this.tickFormat=ie(o),this.fontVariant=Ht(a,"normal"),this.grid=g(s),this.label=p(l),this.labelAnchor=$(c,"labelAnchor",["center","top","bottom"]),this.labelOffset=m(u),this.line=g(f),this.tickRotate=m(h),this.ariaLabel=p(d),this.ariaDescription=p(y)}render(t,{[this.name]:n,fx:r},{width:i,height:o,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetTop:u=0,facetMarginLeft:f,facetMarginRight:h},d){const{axis:p,fontVariant:m,grid:g,label:y,labelAnchor:v,labelOffset:x,line:w,name:b,tickRotate:k}=this,$="left"===p?-1:1,M=$*("y"===b?0:"left"===p?c-f:s-h)+("right"===p?i-s:c);return vt("svg:g",d).call(ne,this).attr("transform",`translate(${M},${u})`).call(ae("right"===p?e.axisRight:e.axisLeft,n,this)).call(se,k).attr("font-size",null).attr("font-family",null).attr("font-variant",m).call(w?()=>{}:t=>t.select(".domain").remove()).call(g?r?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?D(i,t):i).map((t=>`M${e(t)+n},0h${r}`)).join(""))}(t,r,-M):(L=$*(c+s-i),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("x2",L)):()=>{}).call(y?t=>t.append("text").attr("fill","currentColor").attr("font-variant",null==m?null:"normal").attr("transform",`translate(${x*$},${"center"===v?(o+a-l)/2:"bottom"===v?o-l:a})${"center"===v?" rotate(-90)":""}`).attr("dy","center"===v?"right"===p?"-0.32em":"0.75em":"bottom"===v?"1.4em":"-1em").attr("text-anchor","center"===v?"middle":"right"===p?"end":"start").text(y):()=>{}).node();var L}}function ne(t,{name:e,label:n,ariaLabel:r=`${e}-axis`,ariaDescription:i=n}){Xt(t,"aria-label",r),Xt(t,"aria-description",i)}function re(t){return null===t?[]:t}function ie(t){return null===t?()=>null:t}function oe(t,n){return void 0===t?V(n)?$t:p:"function"==typeof t?t:("string"==typeof t?V(n)?e.utcFormat:e.format:x)(t)}function ae(t,e,{ticks:n,tickSize:r,tickPadding:i,tickFormat:o}){return e.tickFormat||(o=oe(o,e.domain())),t(e).ticks(Array.isArray(n)?null:n,"function"==typeof o?null:o).tickFormat("function"==typeof o?o:null).tickSizeInner(r).tickSizeOuter(0).tickPadding(i).tickValues(Array.isArray(n)?n:null)}function se(t,e){if(e=+e)for(const n of t.selectAll("text")){const t=+n.getAttribute("x"),r=+n.getAttribute("y");if(Math.abs(r)>Math.abs(t)){const t=Math.sign(r);n.setAttribute("transform",`translate(0, ${r+4*t*Math.cos(e*Lt)}) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)<10?"middle":e<0^t>0?"start":"end")}else{const r=Math.sign(t);n.setAttribute("transform",`translate(${t+4*r*Math.abs(Math.sin(e*Lt))}, 0) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)>60?"middle":r>0?"start":"end")}n.removeAttribute("x"),n.removeAttribute("y"),n.setAttribute("dy","0.32em")}}const le=Symbol("position"),ce=Symbol("color"),ue=Symbol("radius"),fe=Symbol("length"),he=Symbol("opacity"),de=Symbol("symbol"),pe=new Map([["x",le],["y",le],["fx",le],["fy",le],["r",ue],["color",ce],["opacity",he],["symbol",de],["length",fe]]),me=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",ye(e.schemeBrBG,e.interpolateBrBG)],["prgn",ye(e.schemePRGn,e.interpolatePRGn)],["piyg",ye(e.schemePiYG,e.interpolatePiYG)],["puor",ye(e.schemePuOr,e.interpolatePuOr)],["rdbu",ye(e.schemeRdBu,e.interpolateRdBu)],["rdgy",ye(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",ye(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",ye(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",ye(e.schemeSpectral,e.interpolateSpectral)],["burd",ve(e.schemeRdBu,e.interpolateRdBu)],["buylrd",ve(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",ge(e.schemeBlues,e.interpolateBlues)],["greens",ge(e.schemeGreens,e.interpolateGreens)],["greys",ge(e.schemeGreys,e.interpolateGreys)],["oranges",ge(e.schemeOranges,e.interpolateOranges)],["purples",ge(e.schemePurples,e.interpolatePurples)],["reds",ge(e.schemeReds,e.interpolateReds)],["turbo",xe(e.interpolateTurbo)],["viridis",xe(e.interpolateViridis)],["magma",xe(e.interpolateMagma)],["inferno",xe(e.interpolateInferno)],["plasma",xe(e.interpolatePlasma)],["cividis",xe(e.interpolateCividis)],["cubehelix",xe(e.interpolateCubehelixDefault)],["warm",xe(e.interpolateWarm)],["cool",xe(e.interpolateCool)],["bugn",ge(e.schemeBuGn,e.interpolateBuGn)],["bupu",ge(e.schemeBuPu,e.interpolateBuPu)],["gnbu",ge(e.schemeGnBu,e.interpolateGnBu)],["orrd",ge(e.schemeOrRd,e.interpolateOrRd)],["pubu",ge(e.schemePuBu,e.interpolatePuBu)],["pubugn",ge(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",ge(e.schemePuRd,e.interpolatePuRd)],["rdpu",ge(e.schemeRdPu,e.interpolateRdPu)],["ylgn",ge(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",ge(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",ge(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",ge(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",we(e.interpolateRainbow)],["sinebow",we(e.interpolateSinebow)]]);function ge(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function ye(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function ve(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function xe(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function we(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function be(t){const e=`${t}`.toLowerCase();if(!me.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return me.get(e)}function ke(t,e){const n=be(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const $e=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Me(t){const e=`${t}`.toLowerCase();if(!$e.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return $e.get(e)}const Le=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Ae(t){return null!=t&&Le.has(`${t}`.toLowerCase())}function Ee({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Oe(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function ze({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Oe(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Oe(t,e,n){return void 0===t&&void 0===e&&void 0===n?Nt?[1,0]:[.5,.5]:[e,n]}function Ce(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("function"!=typeof t.floor||"function"!=typeof t.offset)throw new Error("invalid interval; missing floor or offset function");return t}}function Re(t,{interval:e}){return(t={...G(t)}).interval=Ce(void 0===t.interval?e:t.interval),t}function Be(t,e,n,r){const{[t]:i,[`${t}1`]:o,[`${t}2`]:a}=n,{value:s,interval:c}=Re(i,n);if(null==s||null==c&&!r)return n;const u=F(i);if(null==c){let e;const r={transform:t=>e||(e=l(t,s)),label:u};return{...n,[t]:void 0,[`${t}1`]:void 0===o?r:o,[`${t}2`]:void 0===a?r:a}}let f,h;function d(t){return void 0!==h&&t===f?h:h=A(l(f=t,s),(t=>c.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===o?{transform:d,label:u}:o,[`${t}2`]:void 0===a?{transform:t=>d(t).map((t=>c.offset(t))),label:u}:a})}function Ne(t,e,n){const{[t]:r}=n,{value:i,interval:o}=Re(r,n);return null==i||null==o?n:e({...n,[t]:{label:F(r),transform:t=>{const e=A(l(t,i),(t=>o.floor(t))),n=e.map((t=>o.offset(t)));return e.map(V(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function Se(t={}){return Be("x",Ee,t,!0)}function Pe(t={}){return Be("y",ze,t,!0)}function Te(t={}){return Be("x",Ee,t)}function qe(t={}){return Be("y",ze,t)}function De(t={}){return Ne("x",Ee,t)}function je(t={}){return Ne("y",ze,t)}const We=t=>e=>t(1-e),Ye=[0,1],_e=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Fe(t){const e=`${t}`.toLowerCase();if(!_e.has(e))throw new Error(`unknown interpolator: ${e}`);return _e.get(e)}function Ie(t,n,r,{type:i,nice:o,clamp:a,zero:s,domain:l=He(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(pe.get(t)===ue?Ze(r,l):pe.get(t)===fe?Ke(r,l):pe.get(t)===he?Ye:void 0),interpolate:p=(pe.get(t)===ce?null==f&&void 0!==d?e.interpolateRgb:Me(void 0!==f?f:"cyclical"===i?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=Ce(h),"cyclical"!==i&&"sequential"!==i||(i="linear"),m=!!m,"function"!=typeof p&&(p=Fe(p)),1===p.length?(m&&(p=We(p),m=!1),void 0===d&&2===(d=Float64Array.from(l,((t,e)=>e/(l.length-1)))).length&&(d=Ye),n.interpolate((d===Ye?x:tn)(p))):n.interpolate(p),s){const[t,n]=e.extent(l);(t>0||n<0)&&(it(l=E(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return m&&(l=e.reverse(l)),n.domain(l).unknown(c),o&&(n.nice(!0===o?void 0:o),l=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:i,domain:l,range:d,scale:n,interpolate:p,interval:h}}function Ge(t,n,{exponent:r=1,...i}){return Ie(t,e.scalePow().exponent(r),n,{...i,type:"pow"})}function Xe(t,n,{domain:r=[0],unknown:i,scheme:o="rdylbu",interpolate:a,range:s=(void 0!==a?e.quantize(a,r.length+1):pe.get(t)===ce?ke(o,r.length+1):void 0),reverse:l}){const c=it(L(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const i=e.descending(t,n);return 0===i||i===r}(t,n,c))))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(s=e.reverse(s)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===s?[]:s).unknown(i),domain:r,range:s}}function Ue(t,n=Ct){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function He(t,e){const n=pe.get(t);return(n===ue||n===he||n===fe?Ve:Ue)(e)}function Ve(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,Ct))):1]}function Ze(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const i=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,Rt))),o=n.map((t=>3*Math.sqrt(t/i))),a=30/e.max(o);return a<1?o.map((t=>t*a)):o}function Ke(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),i=n.map((t=>12*t/r)),o=60/e.max(i);return o<1?i.map((t=>t*o)):i}function Qe(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Ue(t,Rt);if(n<0)return Ue(t,Bt)}return[1,10]}function Je(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function tn(t){return(e,n)=>r=>t(e+r*(n-e))}function en(t,n,r,i,{type:o,nice:a,clamp:s,domain:l=Ue(i),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(pe.get(t)===ce?null==f&&void 0!==h?e.interpolateRgb:Me(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[g,y]=l;if(g=Math.min(g,u),y=Math.max(y,u),"function"!=typeof p&&(p=Fe(p)),void 0!==h&&(p=1===p.length?tn(p)(...h):e.piecewise(p,h)),m&&(p=We(p)),d){const t=r.apply(u),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,u,y]).unknown(c).interpolator(p),s&&n.clamp(s),a&&n.nice(a),{type:o,domain:[g,y],pivot:u,interpolate:p,scale:n}}function nn(t,n,{exponent:r=1,...i}){return en(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?sn:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...i,type:"diverging-pow"})}function rn(t,n,{constant:r=1,...i}){return en(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,i)}const on={apply:t=>t,invert:t=>t},an={apply:Math.log,invert:Math.exp},sn={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function ln(t,e,n,r){return Ie(t,e,n,r)}const cn=Math.sqrt(3),un=2/cn,fn={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*un,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},hn=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",fn],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolX],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function dn(t){return t&&"function"==typeof t.draw}function pn(t){return!!dn(t)||"string"==typeof t&&hn.has(t.toLowerCase())}function mn(t){if(null==t||dn(t))return t;const e=hn.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const gn=Symbol("ordinal");function yn(t,n,r,{type:i,interval:o,domain:a,range:s,reverse:l,hint:c}){return o=Ce(o),void 0===a&&(a=wn(r,o,t)),"categorical"!==i&&i!==gn||(i="ordinal"),l&&(a=e.reverse(a)),n.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),n.range(s)),{type:i,domain:a,range:s,scale:n,hint:c,interval:o}}function vn(t,n,{type:r,interval:i,domain:o,range:a,scheme:s,unknown:l,...c}){let u;if(i=Ce(i),void 0===o&&(o=wn(n,i,t)),pe.get(t)===de)u=function(t){return{fill:bn(t,"fill"),stroke:bn(t,"stroke")}}(n),a=void 0===a?function(t){return et(t.fill)?e.symbolsStroke:e.symbolsFill}(u):A(a,mn);else if(pe.get(t)===ce&&(void 0!==a||"ordinal"!==r&&r!==gn||(a=function(t,e="greys"){const n=new Set,[r,i]=ke(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(i);else{if(!1!==e)return;n.add(r)}return[...n]}(o,s),void 0!==a&&(s=void 0)),void 0===s&&void 0===a&&(s="ordinal"===r?"turbo":"tableau10"),void 0!==s))if(void 0!==a){const t=Me(s),n=a[0],r=a[1]-a[0];a=({length:i})=>e.quantize((e=>t(n+r*e)),i)}else a=be(s);if(l===e.scaleImplicit)throw new Error("implicit unknown is not supported");return yn(t,e.scaleOrdinal().unknown(l),n,{...c,type:r,domain:o,range:a,hint:u})}function xn(t,e,n,r){let{round:i}=n;return void 0!==i&&t.round(i=!!i),(t=yn(r,t,e,n)).round=i,t}function wn(t,n,r){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&pe.get(r)===le)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(i,Et)}function bn(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function kn(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,round:a,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...d}={}){const p={};for(const[e,m]of t){const t=d[e],g=On(e,m,{round:pe.get(e)===le?a:void 0,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...t});if(g){let{percent:a,transform:s,inset:l,insetTop:c=(void 0!==l?l:"y"===e?n:0),insetRight:u=(void 0!==l?l:"x"===e?r:0),insetBottom:f=(void 0!==l?l:"y"===e?i:0),insetLeft:h=(void 0!==l?l:"x"===e?o:0)}=t||{};if(null==s)s=void 0;else if("function"!=typeof s)throw new Error("invalid scale transform; not a function");g.percent=!!a,g.transform=s,"x"===e||"fx"===e?(g.insetLeft=+h,g.insetRight=+u):"y"!==e&&"fy"!==e||(g.insetTop=+c,g.insetBottom=+f),p[e]=g}}return p}function $n(t){return Object.fromEntries(Object.entries(t).map((([t,{scale:e}])=>[t,e])))}function Mn(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,s=o+n,l=i-a-r;t.range=[s,Math.max(s,l)],Sn(t)||(t.range=En(t)),t.scale.range(t.range)}An(t)}function Ln(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,s=o+n,l=i-a-r;t.range=[Math.max(s,l),s],Sn(t)?t.range.reverse():t.range=En(t),t.scale.range(t.range)}An(t)}function An(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),i=t.paddingInner?t.paddingInner():1,o=t.paddingOuter?t.paddingOuter():t.padding(),a=e-i,s=Math.abs(r-n)/Math.max(1,a+2*o);return(s-Math.floor(s))*a}(t)<=30&&t.scale.round(!0)}function En(t){const e=t.scale.domain().length+Pn(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,i)=>n+i/(e-1)*(r-n)))}function zn(t,e,n){return On(t,void 0===n?void 0:[{hint:n}],{...e})}function On(t,n=[],r={}){const i=function(t,e,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:s}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==s||(n=Rn);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===Rn)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const l=pe.get(t);if(l===ce&&void 0===i&&void 0===o&&Nn(r,e,tt))return"identity";if(l===de&&void 0===i&&Nn(r,e,pn))return"identity";if(l===ue)return"sqrt";if(l===he||l===fe)return"linear";if(l===de)return"ordinal";if((r||i||[]).length>2)return Bn(l);if(void 0!==r)return H(r)?Bn(l):V(r)?"utc":l!==ce||null==a&&!Ae(o)?"linear":"diverging";const c=e.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(H)?Bn(l):c.some(V)?"utc":l!==ce||null==a&&!Ae(o)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&Sn({type:i})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(V)?st(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Cn(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Cn(i)}".`):e.some(Z)?st(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Cn(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Cn(i)}".`):e.some(K)&&st(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Cn(i)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Cn(i)}".`)}switch(r.type=i,i){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=Dn(n,r,Yn);break;case"identity":switch(pe.get(t)){case le:r=Dn(n,r,Yn);break;case de:r=Dn(n,r,jn)}break;case"utc":case"time":r=Dn(n,r,Wn)}switch(i){case"diverging":return function(t,n,r){return en(t,e.scaleDiverging(),on,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return nn(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return nn(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:i=1,domain:o=Ue(n,i<0?Bt:Rt),...a}){return en(t,e.scaleDivergingLog().base(r=+r),an,n,{domain:o,pivot:i,...a})}(t,n,r);case"diverging-symlog":return rn(t,n,r);case"categorical":case"ordinal":case gn:return vn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return Ie(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return Ge(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return Xe(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:i=(void 0===r?5:(r=[...r]).length),n:o=i,scheme:a="rdylbu",domain:s=Je(n),interpolate:l,reverse:c}){return void 0===r&&(r=void 0!==l?e.quantize(l,o):pe.get(t)===ce?ke(a,o):void 0),Xe(t,0,{domain:e.scaleQuantile(s,void 0===r?{length:o}:r).quantiles(),range:r,reverse:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:i=(void 0===r?5:(r=[...r]).length),scheme:o="rdylbu",domain:a=He(t,n),unknown:s,interpolate:l,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,i),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),i=h.length+1,r=void 0!==l?e.quantize(l,i):pe.get(t)===ce?ke(o,i):void 0):(h=e.quantize(e.interpolateNumber(u,f),i+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),it(L(a))<0&&h.reverse(),Xe(t,0,{domain:h,range:r,reverse:c,unknown:s})}(t,n,r);case"pow":return Ge(t,n,r);case"log":return function(t,n,{base:r=10,domain:i=Qe(n),...o}){return Ie(t,e.scaleLog().base(r),n,{...o,domain:i})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...i}){return Ie(t,e.scaleSymlog().constant(r),n,i)}(t,n,r);case"utc":return function(t,n,r){return ln(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return ln(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:i=.5,...o}){return xn(e.scalePoint().align(r).padding(i),n,o,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:i=.1,paddingInner:o=i,paddingOuter:a=("fx"===t||"fy"===t?0:i),...s}){return xn(e.scaleBand().align(r).paddingInner(o).paddingOuter(a),n,s,t)}(t,n,r);case"identity":return pe.get(t)===le?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${i}`)}}function Cn(t){return"symbol"==typeof t?t.description:t}const Rn={toString:()=>"projection"};function Bn(t){switch(t){case le:return"point";case ce:return gn;default:return"ordinal"}}function Nn(t,e,n){return void 0!==t?Q(t,n)&&J(t,n):e.some((({value:t})=>void 0!==t&&Q(t,n)))&&e.every((({value:t})=>void 0===t||J(t,n)))}function Sn({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===gn}function Pn({type:t}){return"threshold"===t}function Tn({range:t,domain:e=t}){return Math.sign(it(e))*Math.sign(it(t))}function qn(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function Dn(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function jn(t){return A(t,mn)}function Wn(t){return A(t,Fn)}function Yn(t){return z(t)?t:A(t,_n,Float64Array)}function _n(t){return null==t?NaN:+t}function Fn(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?o(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function In({scale:t,type:e,domain:n,range:r,label:i,interpolate:o,interval:a,transform:s,percent:l,pivot:c}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const u=t.unknown?t.unknown():void 0;return{type:e,domain:E(n),...void 0!==r&&{range:E(r)},...void 0!==s&&{transform:s},...l&&{percent:l},...void 0!==i&&{label:i},...void 0!==u&&{unknown:u},...void 0!==a&&{interval:a},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==c&&{pivot:c,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function Gn(t,n,r){if(void 0===n.ticks){const i=t.interval;if(void 0!==i){const[r,o]=e.extent(t.scale.domain());n.ticks=i.range(i.floor(r),i.offset(i.floor(o)))}else{const[i,o]=e.extent(t.scale.range());n.ticks=(o-i)/r}}void 0===n.tickFormat&&Sn(t)&&(n.tickFormat=Mt)}function Xn(t,e,n){void 0===t.labelAnchor&&(t.labelAnchor=Sn(e)?"center":Tn(e)<0?"left":"right"),void 0===t.label&&(t.label=Vn(n,e,t,"x")),e.label=t.label}function Un(t,e,n,r){void 0===t.labelAnchor&&(t.labelAnchor=Sn(n)?"center":e&&"top"===e.axis?"bottom":"top"),void 0===t.label&&(t.label=Vn(r,n,t,"y")),n.label=t.label}function Hn(t,e,n,r){r&&(e.label=r.label),void 0===e.label&&(e.label=Vn(n,e,null,t))}function Vn(t=[],e,n,r){let i;for(const{label:e}of t)if(void 0!==e)if(void 0===i)i=e;else if(i!==e)return;if(void 0!==i){if(function({type:t}){return"time"===t||"utc"===t}(e)&&/^(date|time|year)$/i.test(i))return;if(!Sn(e)&&(e.percent&&(i=`${i} (%)`),"x"===r||"y"===r)){const t=Tn(e);t&&(i="x"===r||n&&"center"===n.labelAnchor?"x"===r==t<0?`← ${i}`:`${i} →`:`${t<0?"↑ ":"↓ "}${i}`)}}return i}function Zn(t){return Sn(t)&&void 0===t.interval?void 0:"tabular-nums"}function Kn(t={},e){let{filter:n,sort:r,reverse:i,transform:o,initializer:a,...s}=t;if(void 0===o&&(null!=n&&(o=nr(n)),null==r||B(r)||(o=Jn(o,or(r))),i&&(o=Jn(o,rr))),null!=e&&null!=a)throw new Error("transforms cannot be applied after initializers");return{...s,...(null===r||B(r))&&{sort:r},transform:Jn(o,e)}}function Qn(t={},e){let{filter:n,sort:r,reverse:i,initializer:o,...a}=t;return void 0===o&&(null!=n&&(o=nr(n)),null==r||B(r)||(o=tr(o,or(r))),i&&(o=tr(o,rr))),{...a,...(null===r||B(r))&&{sort:r},initializer:tr(o,e)}}function Jn(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,L(n),r)}}function tr(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,i,...o){let a,s,l,c,u,f;return({data:s=n,facets:l=r,channels:a}=t.call(this,n,r,i,...o)),({data:u=s,facets:f=l,channels:c}=e.call(this,s,l,{...i,...a},...o)),{data:u,facets:f,channels:{...a,...c}}}}function er(t,e){return(null!=t.initializer?Qn:Kn)(t,e)}function nr(t){return(e,n)=>{const r=l(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function rr(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function ir(t,e){return{...(R(t)&&void 0!==t.channel?Qn:er)(e,or(t)),sort:null}}function or(t){return("function"==typeof t&&1!==t.length?ar:sr)(t)}function ar(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function sr(t){let e,n;if(({channel:e,value:t,order:n=Et}={...G(t)}),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=Et;break;case"descending":n=zt;break;default:throw new Error(`invalid order: ${n}`)}return(r,i,o)=>{let a;if(void 0===e)a=l(r,t);else{if(void 0===o)throw new Error("channel sort requires an initializer");if(a=o[e],!a)return{};a=a.value}const s=(t,e)=>n(a[t],a[e]);return{data:r,facets:i.map((t=>t.slice().sort(s)))}}}function lr(t,e){return fr(null,null,t,e)}function cr(t={y:"count"},e={}){const{x:n=f}=e;if(null==n)throw new Error("missing channel: x");return fr(n,null,t,e)}function ur(t={x:"count"},e={}){const{y:n=f}=e;if(null==n)throw new Error("missing channel: y");return fr(null,n,t,e)}function fr(t,e,{data:n=kr,filter:r,sort:i,reverse:o,...a}={},s={}){a=dr(a,s),n=yr(n,f),i=null==i?void 0:pr("sort",i,s),r=null==r?void 0:mr("filter",r,s);const[c,u]=_(t),[h,d]=_(e),{z:p,fill:m,stroke:g,x1:y,x2:v,y1:x,y2:w,...k}=s,[$,M]=_(p),[L]=b(m),[A]=b(g),[E,z]=_(L),[O,C]=_(A);return{..."z"in s&&{z:$||p},..."fill"in s&&{fill:E||m},..."stroke"in s&&{stroke:O||g},...Kn(k,((s,c)=>{const f=l(s,t),h=l(s,e),m=l(s,p),g=l(s,L),y=l(s,A),v=vr(a,{z:m,fill:g,stroke:y}),x=[],w=[],b=f&&u([]),k=h&&d([]),$=m&&M([]),E=g&&z([]),O=y&&C([]);let R=0;for(const t of a)t.initialize(s);i&&i.initialize(s),r&&r.initialize(s);for(const t of c){const e=[];for(const e of a)e.scope("facet",t);i&&i.scope("facet",t),r&&r.scope("facet",t);for(const[o,l]of gr(t,v))for(const[t,c]of gr(l,h))for(const[l,u]of gr(c,f))if(!r||r.reduce(u)){e.push(R++),w.push(n.reduce(u,s)),f&&b.push(l),h&&k.push(t),m&&$.push(v===m?o:m[u[0]]),g&&E.push(v===g?o:g[u[0]]),y&&O.push(v===y?o:y[u[0]]);for(const t of a)t.reduce(u);i&&i.reduce(u)}x.push(e)}return xr(x,i,o),{data:w,facets:x}})),...!hr(a,"x")&&(c?{x:c}:{x1:y,x2:v}),...!hr(a,"y")&&(h?{y:h}:{y1:x,y2:w}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function hr(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function dr(t,e){const n=Object.entries(t);return null!=e.title&&void 0===t.title&&n.push(["title",Mr]),null!=e.href&&void 0===t.href&&n.push(["href",$r]),n.map((([t,n])=>null==n?{name:t,initialize(){},scope(){},reduce(){}}:pr(t,n,e)))}function pr(t,e,n){const r=mr(t,e,n),[i,o]=Y(r.label);let a;return{name:t,output:i,initialize(t){r.initialize(t),a=o([])},scope(t,e){r.scope(t,e)},reduce(t,e){a.push(r.reduce(t,e))}}}function mr(t,e,n){const r=W(t,n),i=yr(e,r);let o,a;return{label:F(i===Ar?null:r,i.label),initialize(t){o=void 0===r?t:l(t,r),"data"===i.scope&&(a=i.reduce(T(t),o))},scope(t,e){i.scope===t&&(a=i.reduce(e,o))},reduce:(t,e)=>null==i.scope?i.reduce(t,o,e):i.reduce(t,o,a,e)}}function gr(t,n){return n?e.sort(e.group(t,(t=>n[t])),y):[[,t]]}function yr(t,n){if(t&&"function"==typeof t.reduce)return t;if("function"==typeof t)return r=t,{reduce:(t,e,n)=>r(D(e,t),n)};var r;if(/^p\d{2}$/i.test(t))return wr(w(t));switch(`${t}`.toLowerCase()){case"first":return $r;case"last":return Lr;case"count":return Ar;case"distinct":return Er;case"sum":return null==n?Ar:zr;case"proportion":return Or(n,"data");case"proportion-facet":return Or(n,"facet");case"deviation":return wr(e.deviation);case"min":return wr(e.min);case"min-index":return wr(e.minIndex);case"max":return wr(e.max);case"max-index":return wr(e.maxIndex);case"mean":return br(e.mean);case"median":return br(e.median);case"variance":return wr(e.variance);case"mode":return wr(e.mode);case"x":return Rr;case"x1":return Nr;case"x2":return Sr;case"y":return Br;case"y1":return Pr;case"y2":return Tr}throw new Error(`invalid reduce: ${t}`)}function vr(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function xr(t,e,n){if(e){const n=e.output.transform(),r=(t,e)=>Et(n[t],n[e]);t.forEach((t=>t.sort(r)))}n&&t.forEach((t=>t.reverse()))}function wr(t){return{reduce:(e,n)=>t(e,(t=>n[t]))}}function br(t){return{reduce(e,n){const r=t(e,(t=>n[t]));return V(n)?new Date(r):r}}}const kr={reduce:(t,e)=>D(e,t)},$r={reduce:(t,e)=>e[t[0]]},Mr={reduce(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),v),i=r.slice(-5).reverse();if(i.length<r.length){const t=r.slice(0,-4);i[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,v)]}return i.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},Lr={reduce:(t,e)=>e[t[t.length-1]]},Ar={label:"Frequency",reduce:t=>t.length},Er={label:"Distinct",reduce:(t,n)=>{const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},zr=wr(e.sum);function Or(t,n){return null==t?{scope:n,label:"Frequency",reduce:(t,e,n=1)=>t.length/n}:{scope:n,reduce:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function Cr(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const Rr={reduce:(t,e,{x1:n,x2:r})=>Cr(n,r)},Br={reduce:(t,e,{y1:n,y2:r})=>Cr(n,r)},Nr={reduce:(t,e,{x1:n})=>n},Sr={reduce:(t,e,{x2:n})=>n},Pr={reduce:(t,e,{y1:n})=>n},Tr={reduce:(t,e,{y2:n})=>n};function qr(t,{scale:e,type:n,value:r,filter:i,hint:o}){return{scale:e,type:n,value:l(t,r),label:F(r),filter:i,hint:o}}function Dr(t,e,{projection:n}){let r,i;const o=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:o}])=>{let a;return void 0!==n&&("x"===n?r=void 0===r?t:"*":"y"===n&&(i=void 0===i?t:"*"),a=e[n]),[t,void 0===a?o:A(o,a)]})));if(n)if("x"===r&&"y"===i)!function(t,e){const{x:n,y:r}=t,i=n.length,o=t.x=new Float64Array(i).fill(NaN),a=t.y=new Float64Array(i).fill(NaN);let s;const l=e.stream({point(t,e){o[s]=t,a[s]=e}});for(s=0;s<i;++s)l.point(n[s],r[s])}(o,n);else if(r||i)throw new Error("projection requires x and y channels");return o}function jr(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function Wr(t,e,n){const r=Yr(t,e);return A(Yr(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Yr(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function _r([t,n],[r,i]){return e.ascending(n,i)||e.ascending(t,r)}function Fr([t,n],[r,i]){return e.descending(n,i)||e.ascending(t,r)}function Ir({y:t,fy:e,fx:n},r){const i=e?e.scale.domain().length:1,o=t?Sn(t)?t.scale.domain().length:Math.max(7,17/i):r?17:1;return!!(t||e||r)*Math.max(1,Math.min(60,o*i))*20+30*!!n+60}function Gr(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Xr(t,e={},n,r){let{columns:i,tickFormat:o,fontVariant:a=Zn(t),swatchSize:s=15,swatchWidth:l=s,swatchHeight:c=s,marginLeft:u=0,className:f,style:h,width:d}=e;const p=yt(e);f=Kt(f),o=oe(o,t.domain);const m=vt("div",p).attr("class",f).attr("style",`\n        --swatchWidth: ${+l}px;\n        --swatchHeight: ${+c}px;\n      `);let g;return null!=i?(g=`\n      .${f}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${f}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${f}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,m.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(n,t).call((t=>t.append("div").attr("class",`${f}-label`).attr("title",o).text(o)))):(g=`\n      .${f} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${f}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(n,t).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`\n        .${f} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===u?"":`\n          margin-left: ${+u}px;`}${void 0===d?"":`\n          width: ${d}px;`}\n        }\n        ${r(f)}\n        ${g}\n      `))).style("font-variant",Ht(a,"normal")).call(Qt,h).node()}const Ur=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:i=(void 0!==t.hint?.stroke?t.hint.stroke:et(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:a=1.5,r:s=4.5,...l}={},c){const[u,f]=b(n),[h,d]=b(i),p=Gr(c,u),m=Gr(c,h),g=s*s*Math.PI;return r=k(r)[1],o=k(o)[1],a=k(a)[1],Xr(t,l,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===u?t=>p.scale(t):null).attr("stroke","color"===h?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.path();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${o};\n      }`))}],["color",Vr],["opacity",function({type:t,interpolate:n,...r},{legend:i=!0,color:o=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===i&&(i="ramp");if("ramp"!==`${i}`.toLowerCase())throw new Error(`${i} opacity legends are not supported`);return Vr({type:t,...r,interpolate:Zr(o)},{legend:i,...a})}]]);function Hr(t,{label:e,ticks:n,tickFormat:r}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const i=r[e];n===t?n={...n,[e]:i}:n[e]=i}return n}(i,t,{label:e,ticks:n,tickFormat:r})}function Vr(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!Sn(t)&&!Pn(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Xr(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:i=6,width:o=240,height:a=44+i,marginTop:s=18,marginRight:l=0,marginBottom:c=16+i,marginLeft:u=0,style:f,ticks:h=(o-u-l)/64,tickFormat:d,fontVariant:p=Zn(t),round:m=!0,className:g}=n;const y=yt(n);g=Kt(g),null===d&&(d=()=>null);const v=vt("svg",y).attr("class",g).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",a).attr("viewBox",`0 0 ${o} ${a}`).call((t=>t.append("style").text(`\n        .${g} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${g} text {\n          white-space: pre;\n        }\n      `))).call(Qt,f);let x,w=t=>t.selectAll(".tick line").attr("y1",s+c-a);const b=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:k,domain:$,range:M,interpolate:L,scale:E,pivot:z}=t;if(L){const t=void 0===M?L:e.piecewise(1===L.length?tn(L):L,M);x=b(E.copy(),e.quantize(e.interpolateNumber(u,o-l),Math.min($.length+(void 0!==z),void 0===M?1/0:M.length)));const n=256,r=y.document.createElement("canvas");r.width=n,r.height=1;const i=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)i.fillStyle=t(e/r),i.fillRect(e,0,1,1);v.append("image").attr("x",u).attr("y",s).attr("width",o-u-l).attr("height",a-s-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===k){const t=$,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;x=b(e.scaleLinear().domain([-1,M.length-1]),[u,o-l]),v.append("g").selectAll().data(M).enter().append("rect").attr("x",((t,e)=>x(e-1))).attr("y",s).attr("width",((t,e)=>x(e)-x(e-1))).attr("height",a-s-c).attr("fill",(t=>t)),h=A(t,((t,e)=>e)),d=e=>n(t[e],e)}else x=b(e.scaleBand().domain($),[u,o-l]),v.append("g").selectAll().data($).enter().append("rect").attr("x",x).attr("y",s).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",a-s-c).attr("fill",E),w=()=>{};return v.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(x).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(i).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Ht(p,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&v.append("text").attr("x",u).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(r),v.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Zr(t){const{r:n,g:r,b:i}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${i},${t})`}const Kr=Symbol("selection");function Qr(t={}){const{facet:n,style:r,caption:i,ariaLabel:o,ariaDescription:a}=t,s=Kt(t.className),l=void 0===t.marks?[]:t.marks.flat(1/0).map(ei),c=new Map,u=new Map;for(const e of pe.keys())C(t[e])&&"fx"!==e&&"fy"!==e&&u.set(e,[]);let f,h,d,p,m,g;if(void 0!==n){const{x:t,y:r}=n;if(null!=t||null!=r){if(g=L(n.data),null==g)throw new Error("missing facet data");if(d={},null!=t){const e=qr(g,{value:t,scale:"fx"});d.fx=e,u.set("fx",[e])}if(null!=r){const t=qr(g,{value:r,scale:"fy"});d.fy=t,u.set("fy",[t])}h=T(g),f=function(t,{fx:n,fy:r}){return n&&r?function(t,{value:n},{value:r}){return e.groups(t,(t=>n[t]),(t=>r[t])).flatMap((([t,e])=>e.map((([e,n])=>[[t,e],n]))))}(t,n,r):li(t,n||r)}(h,d),p=f.map(v)}}for(const r of l){if(c.has(r))throw new Error("duplicate mark; each mark must be unique");const i=void 0===p?void 0:"auto"===r.facet?r.data===n.data?p:void 0:"include"===r.facet?p:"exclude"===r.facet?m||(m=p.map((t=>Uint32Array.from(e.difference(h,t))))):void 0,{data:o,facets:a,channels:s}=r.initialize(i,d);ii(s,t),c.set(r,{data:o,facets:a,channels:s}),h?.length>1&&"auto"===r.facet&&r.data!==n.data&&L(r.data)?.length===g.length&&st(`Warning: the ${r.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}const y=kn(ai(u,c),t),x=$n(y),w=function({x:t,y:e,fx:n,fy:r},{x:i={},y:o={},fx:a={},fy:s={},axis:l=!0,grid:c,line:u,label:f,facet:{axis:h=l,grid:d,label:p=f}={}}={}){let{axis:m=l}=i,{axis:g=l}=o,{axis:y=h}=a,{axis:v=h}=s;return t?!0===m&&(m="bottom"):m=null,e?!0===g&&(g="left"):g=null,n?!0===y&&(y="bottom"===m?"top":"bottom"):y=null,r?!0===v&&(v="left"===g?"right":"left"):v=null,{...m&&{x:new te({grid:c,line:u,label:f,fontVariant:Zn(t),...i,axis:m})},...g&&{y:new ee({grid:c,line:u,label:f,fontVariant:Zn(e),...o,axis:g})},...y&&{fx:new te({name:"fx",grid:d,label:p,fontVariant:Zn(n),...a,axis:y})},...v&&{fy:new ee({name:"fy",grid:d,label:p,fontVariant:Zn(r),...s,axis:v})}}}(y,t),b=function(t,e,n,r={}){const{x:{axis:i}={},y:{axis:o}={},fx:{axis:a}={},fy:{axis:s}={}}=n;let{facet:{margin:l,marginTop:c=(void 0!==l?l:"top"===a?30:0),marginRight:u=(void 0!==l?l:"right"===s?40:0),marginBottom:f=(void 0!==l?l:"bottom"===a?30:0),marginLeft:h=(void 0!==l?l:"left"===s?40:0)}={}}=r;c=+c,u=+u,f=+f,h=+h;const d=Math.max(("top"===i?30:0)+c,o||s?20:.5-Nt),p=Math.max(("bottom"===i?30:0)+f,o||s?20:.5+Nt),m=Math.max(("right"===o?40:0)+u,i||a?20:.5+Nt),g=Math.max(("left"===o?40:0)+h,i||a?20:.5-Nt);let{margin:y,marginTop:v=(void 0!==y?y:d),marginRight:x=(void 0!==y?y:m),marginBottom:w=(void 0!==y?y:p),marginLeft:b=(void 0!==y?y:g)}=r;v=+v,x=+x,w=+w,b=+b;let{width:k=640,height:$=Ir(t,e||ct(r))+Math.max(0,v-d+w-p)}=r;return k=+k,$=+$,{width:k,height:$,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,facetMarginTop:c,facetMarginRight:u,facetMarginBottom:f,facetMarginLeft:h}}(y,function(t){for(const{channels:e}of t.values())if(e.geometry)return!0;return!1}(c),w,t);!function({x:t,y:e,fx:n,fy:r},i){n&&Mn(n,i),r&&Ln(r,i),t&&Mn(t,n?{width:n.scale.bandwidth()}:i),e&&Ln(e,r?{height:r.scale.bandwidth()}:i)}(y,b),function({x:t,y:e,fx:n,fy:r},{x:i,y:o,fx:a,fy:s}){a&&Gn(n,a,80),s&&Gn(r,s,35),i&&Gn(t,i,80),o&&Gn(e,o,35)}(y,w);const{fx:k,fy:$}=x,M=$&&{marginTop:0,marginBottom:0,height:$.bandwidth()},A=k&&{marginRight:0,marginLeft:0,width:k.bandwidth()},E={...b,...A,...M},z=yt(t,E),O=new Set;for(const[e,n]of c)if(null!=e.initializer){const{facets:r,channels:i}=e.initializer(n.data,n.facets,n.channels,x,E,z);if(void 0!==r&&(n.facets=r),void 0!==i){oi(i),ii(i,t),Object.assign(n.channels,i);for(const{scale:t}of Object.values(i))null!=t&&O.add(t)}}if(O.size){for(const t of O)if(pe.get(t)===le)throw new Error(`initializers cannot declare position scales: ${t}`);const e=kn(ai(new Map,c,(t=>O.has(t))),t),n=$n(e);Object.assign(y,e),Object.assign(x,n)}!function(t,e,{x:n,y:r,fx:i,fy:o},a,s){if(i&&(Xn(i,e.fx,t.get("fx")),void 0===i.labelOffset)){const{facetMarginTop:t,facetMarginBottom:e}=a;i.labelOffset="top"===i.axis?t:e}if(o&&(Un(o,i,e.fy,t.get("fy")),void 0===o.labelOffset)){const{facetMarginLeft:t,facetMarginRight:e}=a;o.labelOffset="left"===o.axis?t:e}if(n&&(Xn(n,e.x,t.get("x")),void 0===n.labelOffset)){const{marginTop:t,marginBottom:e,facetMarginTop:r,facetMarginBottom:i}=a;n.labelOffset="top"===n.axis?t-r:e-i}if(r&&(Un(r,n,e.y,t.get("y")),void 0===r.labelOffset)){const{marginRight:t,marginLeft:e,facetMarginLeft:n,facetMarginRight:i}=a;r.labelOffset="left"===r.axis?e-n:t-i}for(const[n,r]of pe)r!==le&&e[n]&&Hn(n,e[n],t.get(n),s[n])}(u,y,w,b,t);for(const t of c.values())t.values=Dr(t.channels,x,z);const{width:R,height:B}=b,N=vt("svg",z).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",R).attr("height",B).attr("viewBox",`0 0 ${R} ${B}`).attr("aria-label",o).attr("aria-description",a).call((t=>t.append("style").text(`\n        .${s} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${s} text,\n        .${s} tspan {\n          white-space: pre;\n        }\n      `))).call(Qt,r).node(),S=w[void 0!==f&&$?"fy":"y"],P=w[void 0!==f&&k?"fx":"x"];S&&N.appendChild(S.render(null,x,b,z)),P&&N.appendChild(P.render(null,x,b,z));let D=[];if(void 0!==f){const t=$&&$.domain(),n=k&&k.domain(),r=function({fx:t,fy:e}){return new(t&&e?ui:ci)}(d);f.forEach((([t],e)=>r.set(t,e)));const i=e.select(N);if($&&w.y){const e=w.y,o=si(e),a="bottom"===e.labelAnchor?t.length-1:"center"===e.labelAnchor?t.length>>1:0;i.selectAll().data(t).enter().append(((t,i)=>(i===a?e:o).render(k&&q(n,(e=>r.has([e,t]))),x,{...b,...M,offsetTop:$(t)},z)))}if(k&&w.x){const e=w.x,o=si(e),a="right"===e.labelAnchor?n.length-1:"center"===e.labelAnchor?n.length>>1:0,{marginLeft:s,marginRight:l}=b;i.selectAll().data(n).enter().append(((n,i)=>(i===a?e:o).render($&&q(t,(t=>r.has([n,t]))),x,{...b,...A,labelMarginLeft:s,labelMarginRight:l,offsetLeft:k(n)},z)))}i.selectAll().data(function({fx:t,fy:n}){return t&&n?e.cross(t.domain(),n.domain()):t?t.domain():n.domain()}(x).filter(r.has,r)).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e){return t&&e?([n,r])=>`translate(${t(n)},${e(r)})`:t?e=>`translate(${t(e)},0)`:t=>`translate(0,${e(t)})`}(k,$)).each((function(t){const e=r.get(t);for(const[t,{channels:n,values:r,facets:i}]of c){const o=i?t.filter(i[e]??i[0],n,r):null,a=t.render(o,x,r,E,z);null!=a&&this.appendChild(a)}}))}else for(const[t,{channels:e,values:n,facets:r}]of c){const i=r?t.filter(r[0],e,n):null,o=t.render(i,x,n,b,z);null!=o&&(N.appendChild(o),void 0!==o[Kr]&&(D=ni(t,o[Kr]),o.addEventListener("input",(()=>{j.value=ni(t,o[Kr])}))))}let j=N;const W=function(t,e,n){const r=[];for(const[i,o]of Ur){const a=n[i];if(a?.legend&&i in t){const n=o(t[i],Hr(e,t[i],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(y,z,t);if(null!=i||W.length>0){const{document:t}=z;j=t.createElement("figure"),j.style.maxWidth="initial";for(const t of W)j.appendChild(t);if(j.appendChild(N),null!=i){const e=t.createElement("figcaption");e.appendChild(i instanceof Node?i:t.createTextNode(i)),j.appendChild(e)}}j.scale=function(t){return e=>{if(!pe.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?In(t[e]):void 0}}(y),j.legend=function(t,e,n={}){return(r,i)=>{if(!Ur.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Ur.get(r)(t[r],Hr(e,n[r],i),(e=>t[e]))}}(y,z,t),j.value=D;const Y=function(){const t=at;return at=0,t}();return Y>0&&e.select(N).append("text").attr("x",R).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${Y.toLocaleString("en-US")} warning${1===Y?"":"s"}. Please check the console.`),j}class Jr{constructor(t,e={},n={},r){const{facet:i="auto",sort:o,dx:a,dy:s,clip:l,channels:c}=n;this.data=t,this.sort=B(o)?o:null,this.initializer=Qn(n).initializer,this.transform=this.initializer?n.transform:Kn(n).transform,this.facet=null==i||!1===i?null:M(!0===i?"include":i,"facet",["auto","include","exclude"]),e=ot(e),void 0!==c&&(e={...ot(c),...e}),void 0!==r&&(e={...Tt(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+a||0,this.dy=+s||0,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),$(t,"clip",["frame","sphere"])}(l)}initialize(t,n){let r=L(this.data);void 0===t&&null!=r&&(t=[T(r)]),null!=this.transform&&(({facets:t,data:r}=this.transform(r,t)),r=L(r));const i=function(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,qr(e,n)])))}(this.channels,r);return null!=this.sort&&function(t,n,r,i){const{reverse:o,reduce:a=!0,limit:s}=i;for(const l in i){if(!pe.has(l))continue;let{value:c,reverse:u=o,reduce:f=a,limit:h=s}=G(i[l]);if(void 0===u&&(u="width"===c||"height"===c),null==f||!1===f)continue;const d=jr(t,l)||n&&jr(n,l);if(!d)throw new Error(`missing channel for scale: ${l}`);const p=d.value,[m=0,g=1/0]=X(h)?h:h<0?[h]:[0,h];if(null==c)d.domain=()=>{let t=p;return u&&(t=t.slice().reverse()),0===m&&g===1/0||(t=t.slice(m,g)),t};else{const n="data"===c?r:"height"===c?Wr(t,"y1","y2"):"width"===c?Wr(t,"x1","x2"):Yr(t,c,"y"===c?"y2":"x"===c?"x2":void 0),i=yr(!0===f?"max":f,n);d.domain=()=>{let t=e.rollup(T(p),(t=>i.reduce(t,n)),(t=>p[t]));return t=e.sort(t,u?Fr:_r),0===m&&g===1/0||(t=t.slice(m,g)),t.map(y)}}}}(i,n,r,this.sort),{data:r,facets:t,channels:i}}filter(t,e,n){for(const r in e){const{filter:i=At}=e[r];if(null!==i){const e=n[r];t=t.filter((t=>i(e[t])))}}return t}plot({marks:t=[],...e}={}){return Qr({...e,marks:[...t,this]})}}function ti(...t){return t.plot=Jr.prototype.plot,t}function ei(t){return"function"==typeof t?.render?t:new ri(t)}function ni(t,e){return null===e?t.data:D(t.data,e)}class ri extends Jr{constructor(t){if(super(),null!=t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");this.render=t}}render(){}}function ii(t,e){for(const n in t){const r=t[n],{scale:i}=r;if(null!=i){const{percent:t,interval:n,transform:o=(t?t=>100*t:Ce(n)?.floor)}=e[i]||{};null!=o&&(r.value=A(r.value,o))}}return t}function oi(t){for(const e in t){const n=t[e];let{scale:r}=n;if(!0===r){switch(e){case"fill":case"stroke":r="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":r="opacity";break;default:r=pe.has(e)?e:null}n.scale=r}}}function ai(t,e,n=d){for(const{channels:r}of e.values())for(const e in r){const i=r[e],{scale:o}=i;if(null!=o&&n(o)){const e=t.get(o);void 0!==e?e.push(i):t.set(o,[i])}}return t}function si(t){return void 0===t||void 0===t.label?t:Object.assign(Object.create(t),{label:void 0})}function li(t,{value:n}){return e.groups(t,(t=>n[t]))}class ci{constructor(){this._=new e.InternMap}has(t){return this._.has(t)}get(t){return this._.get(t)}set(t,e){return this._.set(t,e),this}}class ui extends ci{has([t,e]){const n=super.get(t);return!!n&&n.has(e)}get([t,e]){const n=super.get(t);return n&&n.get(e)}set([t,n],r){const i=super.get(t);return i?i.set(n,r):super.set(t,new e.InternMap([[n,r]])),this}}const fi=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function hi(t=e.curveLinear,n){if("function"==typeof t)return t;const r=fi.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function di(t={y:"count"},e={}){[t,e]=xi(t,e);const{x:n,y:r}=e;return vi(wi(n,e,f),null,null,r,t,Ee(e))}function pi(t={x:"count"},e={}){[t,e]=xi(t,e);const{x:n,y:r}=e;return vi(null,wi(r,e,f),n,null,t,ze(e))}function mi(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?$r:n.reduce,filter:null},n)}function gi(t){return mi(di,"y",t)}function yi(t){return mi(pi,"x",t)}function vi(t,e,n,r,{data:i=kr,filter:o=Ar,sort:a,reverse:s,...c}={},u={}){t=bi(t),e=bi(e),c=dr(c,u),i=yr(i,f),a=null==a?void 0:pr("sort",a,u),o=null==o?void 0:mr("filter",o,u),null!=n&&hr(c,"x","x1","x2")&&(n=null),null!=r&&hr(c,"y","y1","y2")&&(r=null);const[h,d]=_(t),[p,m]=_(t),[g,y]=_(e),[v,x]=_(e),[w,k]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[$,M]=_(w),{x:L,y:A,z:E,fill:z,stroke:O,x1:C,x2:R,y1:B,y2:N,domain:S,cumulative:P,thresholds:T,interval:q,...D}=u,[j,W]=_(E),[Y]=b(z),[F]=b(O),[G,X]=_(Y),[U,H]=_(F);return{..."z"in u&&{z:j||E},..."fill"in u&&{fill:G||z},..."stroke"in u&&{stroke:U||O},...Kn(D,((n,r)=>{const u=l(n,w),f=l(n,E),h=l(n,Y),p=l(n,F),g=vr(c,{z:f,fill:h,stroke:p}),v=[],b=[],k=u&&M([]),$=f&&W([]),L=h&&X([]),A=p&&H([]),z=t?t(n):[[,,t=>t]],O=e?e(n):[[,,t=>t]],C=t&&d([]),R=t&&m([]),B=e&&y([]),N=e&&x([]);let S=0;for(const t of c)t.initialize(n);a&&a.initialize(n),o&&o.initialize(n);for(const t of r){const e=[];for(const e of c)e.scope("facet",t);a&&a.scope("facet",t),o&&o.scope("facet",t);for(const[r,s]of gr(t,g))for(const[t,l]of gr(s,u))for(const[s,d,m]of z){const y=m(l);for(const[l,m,v]of O){const x={x1:s,x2:d,y1:l,y2:m},w=v(y);if(!o||o.reduce(w,x)){e.push(S++),b.push(i.reduce(w,n,x)),u&&k.push(t),f&&$.push(g===f?r:f[w[0]]),h&&L.push(g===h?r:h[w[0]]),p&&A.push(g===p?r:p[w[0]]),C&&(C.push(s),R.push(d)),B&&(B.push(l),N.push(m));for(const t of c)t.reduce(w,x);a&&a.reduce(w)}}}v.push(e)}return xr(v,a,s),{data:b,facets:v}})),...!hr(c,"x")&&(h?{x1:h,x2:p,x:I(h,p)}:{x:L,x1:C,x2:R}),...!hr(c,"y")&&(g?{y1:g,y2:v,y:I(g,v)}:{y:A,y1:B,y2:N}),...$&&{[k]:$},...Object.fromEntries(c.map((({name:t,output:e})=>[t,e])))}}function xi({cumulative:t,domain:e,thresholds:n,interval:r,...i},o){return[i,{cumulative:t,domain:e,thresholds:n,interval:r,...o}]}function wi(t,{cumulative:n,domain:r,thresholds:i,interval:o},a){return void 0===(t={...G(t)}).domain&&(t.domain=r),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=i),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=a),t.thresholds=function(t,n){if(void 0===t)return void 0===n?ki:function(t){if(!$i(t=Ce(t)))throw new Error(`invalid interval: ${t}`);return t}(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return ki}throw new Error(`invalid thresholds: ${t}`)}return t}(t.thresholds,t.interval),t}function bi(t){if(null==t)return;const{value:n,cumulative:r,domain:i=e.extent,thresholds:o}=t,a=t=>{let a=l(t,n,Array);const s=e.bin().value((t=>a[t]));if(V(a)||(function(t){return $i(t)&&"function"==typeof t&&t()instanceof Date}(c=o)||X(c)&&V(c))){a=a.map(Fn);let[t,n]="function"==typeof i?i(a):i,r="function"!=typeof o||$i(o)?o:o(a,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),$i(r)&&(i===e.extent&&(t=r.floor(t),n=r.ceil(new Date(+n+1))),r=r.range(t,n)),s.thresholds(r).domain([t,n])}else{a=a.map(_n);let t=i,n=o;if($i(n)){let[r,i]="function"==typeof t?t(a):t;t===e.extent&&(r=n.floor(r),i=n.offset(n.floor(i)),t=[r,i]),n=n.range(r,i)}s.thresholds(n).domain(t)}var c;let u=s(T(t)).map(Mi);return r&&(u=(r<0?u.reverse():u).map(Li)),u.map(Ai)};return a.label=F(n),a}function ki(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function $i(t){return!!t&&"function"==typeof t.range}function Mi(t){return[t,new Set(t)]}function Li([t],e,n){return[t,{get size(){for(let t=0;t<=e;++t)if(n[t][1].size)return 1;return 0},has(t){for(let r=0;r<=e;++r)if(n[r][1].has(t))return!0;return!1}}]}function Ai([{x0:t,x1:e},n]){return[t,e,n.size?t=>t.filter(n.has,n):Ei]}function Ei(){return new Uint32Array(0)}function zi(t={}){const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:f}:t}function Oi(t={}){const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:f}:t}function Ci(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{y1:n,y:r=n,x:i,...o}=e,[a,s,l,c]=Pi(r,i,"x",t,o);return{...a,y1:n,y:s,x1:l,x2:c,x:I(l,c)}}function Ri(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{x1:n,x:r=n,y:i,...o}=e,[a,s,l,c]=Pi(r,i,"y",t,o);return{...a,x1:n,x:s,y1:l,y2:c,y:I(l,c)}}function Bi({x:t,x1:e,x2:n,...r}={}){return void 0===e&&void 0===n?Ci({x:t,...r}):([e,n]=N(t,e,n),{...r,x1:e,x2:n})}function Ni({y:t,y1:e,y2:n,...r}={}){return void 0===e&&void 0===n?Ri({y:t,...r}):([e,n]=N(t,e,n),{...r,y1:e,y2:n})}function Si(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}const Pi=function(t,n=h,r,{offset:i,order:o,reverse:a},s){const u=P(s),[f,d]=_(t),[p,m]=Y(n),[g,y]=Y(n);return i=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return qi;case"center":case"silhouette":return Di;case"wiggle":return ji}throw new Error(`unknown offset: ${t}`)}(i),o=function(t,e,n){if(void 0===t&&e===ji)return Xi;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return _i;case"z":return Fi;case"sum":return Ii;case"appearance":return Gi;case"inside-out":return Xi}return Ui(c(t))}if("function"==typeof t)return Ui(t);if(Array.isArray(t))return r=t,(t,e,n,i)=>Hi(i,r);var r;throw new Error(`invalid order: ${t}`)}(o,i,r),[Kn(s,((r,s)=>{const c=null==t?void 0:d(l(r,t)),f=l(r,n,Float64Array),h=l(r,u),p=o&&o(r,c,f,h),g=r.length,v=m(new Float64Array(g)),x=y(new Float64Array(g)),w=[];for(const t of s){const n=c?Array.from(e.group(t,(t=>c[t])).values()):[t];p&&Vi(n,p);for(const t of n){let e=0,n=0;a&&t.reverse();for(const r of t){const t=f[r];t<0?e=x[r]=(v[r]=e)+t:t>0?n=x[r]=(v[r]=n)+t:x[r]=v[r]=n}}w.push(n)}return i&&i(w,v,x,h),{data:r,facets:s}})),f,p,g]};function Ti(t,e){let n=0,r=0;for(const i of t){const t=e[i];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function qi(t,e,n){for(const r of t)for(const t of r){const[r,i]=Ti(t,n);for(const o of t){const t=1/(i-r||1);e[o]=t*(e[o]-r),n[o]=t*(n[o]-r)}}}function Di(t,e,n){for(const r of t){for(const t of r){const[r,i]=Ti(t,n);for(const o of t){const t=(i+r)/2;e[o]-=t,n[o]-=t}}Wi(r,e,n)}Yi(t,e,n)}function ji(t,n,r,i){for(const o of t){const t=new e.InternMap;let a=0;for(const s of o){let o=-1;const l=s.map((t=>Math.abs(r[t]-n[t]))),c=s.map((e=>{o=i?i[e]:++o;const a=r[e]-n[e],s=t.has(o)?a-t.get(o):0;return t.set(o,a),s})),u=[0,...e.cumsum(c)];for(const t of s)n[t]+=a,r[t]+=a;const f=e.sum(l);f&&(a-=e.sum(l,((t,e)=>(c[e]/2+u[e])*t))/f)}Wi(o,n,r)}Yi(t,n,r)}function Wi(t,n,r){const i=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=i,r[t]-=i}function Yi(t,n,r){const i=t.length;if(1===i)return;const o=t.map((t=>t.flat())),a=o.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),s=e.min(a);for(let t=0;t<i;t++){const e=s-a[t];for(const i of o[t])n[i]+=e,r[i]+=e}}function _i(t,e,n){return n}function Fi(t,e,n,r){return r}function Ii(t,n,r,i){return Hi(i,e.groupSort(T(t),(t=>e.sum(t,(t=>r[t]))),(t=>i[t])))}function Gi(t,n,r,i){return Hi(i,e.groupSort(T(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])))}function Xi(t,n,r,i){const o=T(t),a=e.groupSort(o,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])),s=e.rollup(o,(t=>e.sum(t,(t=>r[t]))),(t=>i[t])),l=[],c=[];let u=0;for(const t of a)u<0?(u+=s.get(t),l.push(t)):(u-=s.get(t),c.push(t));return Hi(i,c.reverse().concat(l))}function Ui(t){return e=>l(e,t)}function Hi(t,n){return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function Vi(t,e){for(const n of t)n.sort(((t,n)=>Et(e[t],e[n])))}const Zi={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ki extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,z:a,curve:s,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0},z:{value:P(e),optional:!0}},e,Zi),this.z=a,this.curve=hi(s,l)}filter(t){return t}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:c=s}=r;return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,n,0,0).call((n=>n.selectAll().data(_t(t,[a,s,l,c],this,r)).enter().append("path").call(It,this).call(Wt,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>s[t])).x1((t=>l[t])).y1((t=>c[t]))))).node()}}function Qi(t,e){const{x:n=u,...r}=gi(e);return new Ki(t,Ni(Oi({...r,x1:n,x2:void 0})))}function Ji(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}={}){t.markerStart=to(n),t.markerMid=to(r),t.markerEnd=to(i)}function to(t){if(null==t||!1===t)return null;if(!0===t)return ro;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return eo;case"dot":return no;case"circle":case"circle-fill":return ro;case"circle-stroke":return io}throw new Error(`invalid marker: ${t}`)}function eo(t,e){return vt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function no(t,e){return vt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function ro(t,e){return vt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function io(t,e){return vt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let oo=0;function ao(t,e,{stroke:n}={}){return lo(t,e,n&&(t=>n[t]))}function so(t,e,{stroke:n}={}){return lo(t,e,n&&(([t])=>n[t]))}function lo(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:i},o=(()=>i)){const a=new Map;function s(t){return function(e){const n=o(e);let r=a.get(t);r||a.set(t,r=new Map);let i=r.get(n);if(!i){const e={document:this.ownerDocument},o=this.parentNode.insertBefore(t(n,e),this),a="plot-marker-"+ ++oo;o.setAttribute("id",a),r.set(n,i=`url(#${a})`)}return i}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}const co={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class uo extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,curve:a,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,co),this.curve=hi(a,s),Ji(this,e)}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:c=s}=r,{curve:u}=this;return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(It,this).attr("d",(t=>{const n=e.path(),r=u(n);return r.lineStart(),r.point(a[t],s[t]),r.point(l[t],c[t]),r.lineEnd(),n})).call(jt,this,r).call(ao,this,r))).node()}}function fo(t,e={}){let{x:n,x1:r,x2:i,y:o,y1:a,y2:s,...l}=e;return[r,i]=ho(n,r,i),[a,s]=ho(o,a,s),new uo(t,{...l,x1:r,x2:i,y1:a,y2:s})}function ho(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const po={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class mo extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,bend:a=0,headAngle:s=60,headLength:l=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,po),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+s,this.headLength=+l,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,i){const{x1:o,y1:a,x2:s=o,y2:l=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,g=c?t=>c[t]:x(void 0===u?1:u),y=f*Lt,v=h*Lt/2,w=d/1.5;return vt("svg:g",i).call(Ft,this,e,r,i).call(Ut,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(It,this).attr("d",(t=>{let e=o[t],n=a[t],r=s[t],i=l[t];const c=Math.hypot(r-e,i-n);if(c<=p+m)return null;let u=Math.atan2(i-n,r-e);const f=Math.min(w*g(t),c/3),h=Math.hypot(c/Math.tan(y),c)/2;if(p||m)if(h<1e5){const t=Math.sign(y),[o,a]=function([t,e],[n,r],i,o){const a=n-t,s=r-e,l=Math.hypot(a,s),c=o*Math.sqrt(i*i-l*l/4)/l;return[(t+n)/2-s*c,(e+r)/2+a*c]}([e,n],[r,i],h,t);if(p&&([e,n]=go([o,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=go([o,a,h],[r,i,m],t*Math.sign(m));u+=Math.atan2(n-a,e-o)-Math.atan2(i-a,r-o),r=e,i=n}}else{const t=r-e,o=i-n,a=Math.hypot(t,o);p&&(e+=t/a*p,n+=o/a*p),m&&(r-=t/a*m,i-=o/a*m)}const d=u+y,x=d+v,b=d-v,k=r-f*Math.cos(x),$=i-f*Math.sin(x),M=r-f*Math.cos(b),L=i-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${y>0?1:0} `:"L"}${r},${i}M${k},${$}L${r},${i}L${M},${L}`})).call(jt,this,n))).node()}}function go([t,e,n],[r,i,o],a){const s=r-t,l=i-e,c=Math.hypot(s,l),u=(s*s+l*l-o*o+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(s*u+l*f)/c,e+(l*u-s*f)/c]}class yo extends Jr{constructor(t,e,n={},r){super(t,e,n,r);const{inset:i=0,insetTop:o=i,insetRight:a=i,insetBottom:s=i,insetLeft:l=i,rx:c,ry:u}=n;this.insetTop=m(o),this.insetRight=m(a),this.insetBottom=m(s),this.insetLeft=m(l),this.rx=Ht(c,"auto"),this.ry=Ht(u,"auto")}render(t,e,n,r,i){const{rx:o,ry:a}=this;return vt("svg:g",i).call(Ft,this,e,r,i).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("rect").call(It,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(Xt,"rx",o).call(Xt,"ry",a).call(jt,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:i}){const{insetLeft:o,insetRight:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:i}){const{insetTop:o,insetBottom:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}}const vo={ariaLabel:"bar"};class xo extends yo{constructor(t,e={}){const{x1:n,x2:r,y:i}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},e,vo)}_transform(t,e,{x:n}){t.call(Ut,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:i}=this;return qn(t)?r+i:t=>Math.min(e[t],n[t])+i}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this;return qn(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}class wo extends yo{constructor(t,e={}){const{x:n,y1:r,y2:i}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:i,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,vo)}_transform(t,e,{y:n}){t.call(Ut,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:i}=this;return qn(t)?r+i:t=>Math.min(e[t],n[t])+i}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this;return qn(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}function bo(t,e={y:u,x2:f}){return new xo(t,Bi(Te(zi(e))))}function ko(t,e={x:u,y2:f}){return new wo(t,Ni(qe(Oi(e))))}function $o(t,e={}){return Ao(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Mo(t,e={}){return Ao(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Lo(t={},n={}){const r=P(n),i=Object.entries(t).map((([t,e])=>{const r=W(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[i,o]=Y(r);return{key:t,input:r,output:i,setOutput:o,map:Eo(e)}}));return{...Kn(n,((t,n)=>{const o=l(t,r),a=i.map((({input:e})=>l(t,e))),s=i.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of o?e.group(t,(t=>o[t])).values():[t])i.forEach((({map:t},e)=>t.map(n,a[e],s[e])));return{data:t,facets:n}})),...Object.fromEntries(i.map((({key:t,output:e})=>[t,e])))}}const Ao=Lo;function Eo(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return Oo(t);switch(`${t}`.toLowerCase()){case"cumsum":return Co;case"rank":return Oo(e.rank);case"quantile":return Oo(zo)}throw new Error(`invalid map: ${t}`)}function zo(t){const n=e.count(t)-1;return e.rank(t).map((t=>t/n))}function Oo(t){return{map(e,n,r){const i=t(D(n,e));if(i.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=i[t]}}}const Co={map(t,e,n){let r=0;for(const i of t)n[i]=r+=e[i]}},Ro={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Bo(t){return void 0===t.sort&&void 0===t.reverse?ir({channel:"r",order:"descending"},t):t}class No extends Jr{constructor(t,n={}){const{x:r,y:i,r:o,rotate:a,symbol:s=e.symbolCircle,frameAnchor:l}=n,[c,u]=k(a,0),[f,h]=function(t){if(null==t||dn(t))return[void 0,t];if("string"==typeof t){const e=hn.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[d,p]=k(o,null==f?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:d,scale:"r",filter:Rt,optional:!0},rotate:{value:c,optional:!0},symbol:{value:f,scale:"symbol",optional:!0}},Bo(n),Ro),this.r=p,this.rotate=u,this.symbol=h,this.frameAnchor=rt(l);const{channels:m}=this,{symbol:g}=m;if(g){const{fill:t,stroke:e}=m;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,r:u,rotate:f,symbol:h}=r,[d,p]=Jt(this,i),m=this.symbol===e.symbolCircle,{r:g}=this;return Bt(g)&&(t=[]),vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,{x:l&&a,y:c&&s}).call((n=>n.selectAll().data(t).enter().append(m?"circle":"path").call(It,this).call(m?t=>{t.attr("cx",l?t=>l[t]:d).attr("cy",c?t=>c[t]:p).attr("r",u?t=>u[t]:g)}:t=>{const n=l&&c?t=>`translate(${l[t]},${c[t]})`:l?t=>`translate(${l[t]},${p})`:c?t=>`translate(${d},${c[t]})`:()=>`translate(${d},${p})`;t.attr("transform",f?t=>`${n(t)} rotate(${f[t]})`:this.rotate?t=>`${n(t)} rotate(${this.rotate})`:n).attr("d",(t=>{const n=e.path(),r=u?u[t]:g;return(h?h[t]:this.symbol).draw(n,r*r*Math.PI),n}))}).call(jt,this,r))).node()}}function So(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=S(n,r)),new No(t,{...i,x:n,y:r})}const Po={ariaLabel:"rule",fill:null,stroke:"currentColor"};class To extends Jr{constructor(t,e={}){const{x:n,y1:r,y2:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Po),this.insetTop=m(a),this.insetBottom=m(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y1:l,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return vt("svg:g",i).call(Ft,this,e,r).call(Ut,this,{x:s&&o},Nt,0).call((e=>e.selectAll().data(t).enter().append("line").call(It,this).attr("x1",s?t=>s[t]:(p+u-d)/2).attr("x2",s?t=>s[t]:(p+u-d)/2).attr("y1",l&&!qn(a)?t=>l[t]+g:h+g).attr("y2",c&&!qn(a)?a.bandwidth?t=>c[t]+a.bandwidth()-y:t=>c[t]-y:f-m-y).call(jt,this,n))).node()}}class qo extends Jr{constructor(t,e={}){const{x1:n,x2:r,y:i,inset:o=0,insetRight:a=o,insetLeft:s=o}=e;super(t,{y:{value:i,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},e,Po),this.insetRight=m(a),this.insetLeft=m(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{y:s,x1:l,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return vt("svg:g",i).call(Ft,this,e,r,i).call(Ut,this,{y:s&&a},0,Nt).call((e=>e.selectAll().data(t).enter().append("line").call(It,this).attr("x1",l&&!qn(o)?t=>l[t]+g:p+g).attr("x2",c&&!qn(o)?o.bandwidth?t=>c[t]+o.bandwidth()-y:t=>c[t]-y:u-d-y).attr("y1",s?t=>s[t]:(h+f-m)/2).attr("y2",s?t=>s[t]:(h+f-m)/2).call(jt,this,n))).node()}}function Do(t,e){let{x:n=f,y:r,y1:i,y2:o,...a}=qe(e);return[i,o]=Wo(r,i,o),new To(t,{...a,x:n,y1:i,y2:o})}function jo(t,e){let{y:n=f,x:r,x1:i,x2:o,...a}=Te(e);return[i,o]=Wo(r,i,o),new qo(t,{...a,y:n,x1:i,x2:o})}function Wo(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Yo={ariaLabel:"tick",fill:null,stroke:"currentColor"};class _o extends Jr{constructor(t,e,n){super(t,e,n,Yo)}render(t,e,n,r,i){return vt("svg:g",i).call(Ft,this,e,r,i).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(It,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(jt,this,n))).node()}}class Fo extends _o{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetTop:o=i,insetBottom:a=i}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=m(o),this.insetBottom=m(a)}_transform(t,e,{x:n}){t.call(Ut,e,{x:n},Nt,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}}class Io extends _o{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetRight:o=i,insetLeft:a=i}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=m(o),this.insetLeft=m(a)}_transform(t,e,{y:n}){t.call(Ut,e,{y:n},0,Nt)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Go(t,e={}){const{x:n=f,...r}=e;return new Fo(t,{...r,x:n})}function Xo(t,e={}){const{y:n=f,...r}=e;return new Io(t,{...r,y:n})}function Uo(t){const e=Ho(t),n=Vo(t);return t.map((t=>t<e||t>n?t:NaN))}function Ho(t,n){const r=2.5*Zo(t,n)-1.5*Ko(t,n);return e.min(t,(t=>t>=r?t:NaN))}function Vo(t,n){const r=2.5*Ko(t,n)-1.5*Zo(t,n);return e.max(t,(t=>t<=r?t:NaN))}function Zo(t,n){return e.quantile(t,.25,n)}function Ko(t,n){return e.quantile(t,.75,n)}const Qo={ariaLabel:"cell"};class Jo extends yo{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,Qo)}_transform(t,e){t.call(Ut,e,{},0,0)}}const ta={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ea={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},na={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},ra={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ia={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class oa extends Jr{constructor(t,e={}){const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:i,optional:!0}},e,ta),this.curve=hi(o,a),Ji(this,e)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,{curve:f}=this,[h,d]=Jt(this,i),p=l?t=>l[t]:x(h),m=c?t=>c[t]:x(d),g=this;function y(t){let n=-1;const i=[],o={};for(const t in r)o[t]=[];const a=[],s=[],l=[],c=[];function u(e,u){e=t[e],u=t[u],i.push(++n),a[n]=p(e),l[n]=m(e),s[n]=p(u),c[n]=m(u);for(const t in r)o[t].push(r[t][u])}const{halfedges:h,hull:d,triangles:y}=e.Delaunay.from(t,p,m);for(let t=0;t<h.length;++t){const e=h[t];e>t&&u(y[t],y[e])}for(let t=0;t<d.length;++t)u(d[t],d[(t+1)%d.length]);e.select(this).selectAll().data(i).join("path").call(It,g).attr("d",(t=>{const n=e.path(),r=f(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n})).call(jt,g,o).call(ao,g,o)}return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class aa extends Jr{constructor(t,e={},n,r=(({z:t})=>t)){const{x:i,y:o}=e;super(t,{x:{value:i,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=Jt(this,i),d=l?t=>l[t]:x(f),p=c?t=>c[t]:x(h),m=this;function g(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(It,m).attr("d",m._render(n,i)).call(jt,m,r)}return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class sa extends aa{constructor(t,e={}){super(t,e,ea),this.fill="none"}_render(t){return t.render()}}class la extends aa{constructor(t,e={}){super(t,e,na,P)}_render(t){return t.renderHull()}}class ca extends Jr{constructor(t,e={}){const{x:n,y:r,z:i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:i,optional:!0}},e,ra)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=Jt(this,i),d=l?t=>l[t]:x(f),p=c?t=>c[t]:x(h);function m(t){const n=fa(e.Delaunay.from(t,d,p),i);e.select(this).selectAll().data(t).enter().append("path").call(It,this).attr("d",((t,e)=>n.renderCell(e))).call(jt,this,r)}return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(m):e=>e.datum(t).each(m)).node()}}class ua extends aa{constructor(t,e){super(t,e,ia),this.fill="none"}_render(t,e){return fa(t,e).render()}}function fa(t,e){const{width:n,height:r,marginTop:i,marginRight:o,marginBottom:a,marginLeft:s}=e;return t.voronoi([s,i,n-o,r-a])}function ha(t,e,{x:n,y:r,...i}={}){return[n,r]=S(n,r),new t(e,{...i,x:n,y:r})}const da={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class pa extends Jr{constructor(t,{x:n,y:r,z:i,weight:o,fill:a,stroke:s,...l}={}){const c=ga(a)&&(a="currentColor",!0),u=ga(s)&&(s="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:P({z:i,fill:a,stroke:s}),optional:!0},weight:{value:o,optional:!0}},function(t,n,r){const i=100;let{bandwidth:o,thresholds:a}=t;return o=void 0===o?20:+o,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?Yn(a):+a,Qn(t,(function(t,s,l,c,u,f){const h=l.weight?Yn(l.weight.value):null,d=l.z?.value,{z:p}=this,[m,g]=Jt(this,u),{width:y,height:v}=u;let{x:x,y:w}=Dr({...l.x&&{x:l.x},...l.y&&{y:l.y}},c,f);x&&(x=Yn(x)),w&&(w=Yn(w));const b=Object.fromEntries(Object.entries(l).filter((([t])=>!ma.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],$=r&&[],M=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:g).weight(h?t=>h[t]:1).size([y,v]).bandwidth(o),L=[];for(const t of s){const e=[];L.push(e);for(const n of d?Yt(t,d,p):[t]){const t=M.contours(n);e.push([n,t])}}let A=a;if(!z(A)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}A=Float64Array.from({length:a-1},((e,n)=>t*i*(n+1)/a))}const E=[],O=[];for(const t of L){const e=[];E.push(e);for(const[n,r]of t)for(const t of A){e.push(O.length),O.push(r(t/i)),k&&k.push(t),$&&$.push(t);for(const t in b)b[t].value.push(l[t].value[n[0]])}}return k&&k.push(0),$&&$.push(0),{data:t,facets:E,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...$&&{stroke:{value:$,scale:"color"}},contours:{value:O}}}}))}({...l,fill:a,stroke:s},c,u),da),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=i}filter(t){return t}render(t,n,r,i,o){const{contours:a}=r,s=e.geoPath();return e.create("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(It,this).call(jt,this,r).attr("d",(t=>s(a[t]))))).node()}}const ma=new Set(["x","y","z","weight"]);function ga(t){return/^density$/i.test(t)}const ya={ariaLabel:"frame",fill:"none",stroke:"currentColor"};class va extends Jr{constructor(t={}){const{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,rx:a,ry:s}=t;super(void 0,void 0,t,ya),this.insetTop=m(n),this.insetRight=m(r),this.insetBottom=m(i),this.insetLeft=m(o),this.rx=m(a),this.ry=m(s)}render(t,e,n,r,i){const{marginTop:o,marginRight:a,marginBottom:s,marginLeft:l,width:c,height:u}=r,{insetTop:f,insetRight:h,insetBottom:d,insetLeft:p,rx:m,ry:g}=this;return vt("svg:rect",i).call(Ft,this,e,r,i).call(It,this).call(Ut,this,{}).attr("x",l+p).attr("y",o+f).attr("width",c-l-a-p-h).attr("height",u-o-s-f-d).attr("rx",m).attr("ry",g).node()}}const xa={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class wa extends Jr{constructor(t,e={}){const[n,r]=k(e.r,3);super(t,{geometry:{value:e.geometry},r:{value:n,scale:"r",filter:Rt,optional:!0}},Bo(e),xa),this.r=r}render(t,n,r,i,o){const{geometry:a,r:s}=r,l=e.geoPath(o.projection),{r:c}=this;return Bt(c)?t=[]:void 0!==c&&l.pointRadius(c),vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(It,this).attr("d",s?t=>l.pointRadius(s[t])(a[t]):t=>l(a[t])).call(jt,this,r)})).node()}}function ba(t,{geometry:e=f,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new wa(t,{geometry:e,...n})}const ka=.5;function $a(t,e,n,r){const i=r*(1.5/cn),o=new Map;for(const a of t){let t=e[a],s=n[a];if(isNaN(t)||isNaN(s))continue;let l=Math.round(s=(s-0)/i),c=Math.round(t=(t-ka)/r-(1&l)/2),u=s-l;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=l+(s<l?-1:1),i=t-n,o=s-r;e*e+u*u>i*i+o*o&&(c=n+(1&l?1:-1)/2,l=r)}const f=`${c},${l}`;let h=o.get(f);void 0===h&&(o.set(f,h=[]),h.x=(c+(1&l)/2)*r+ka,h.y=l*i+0),h.push(a)}return o.values()}const Ma={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class La extends Jr{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(void 0,void 0,{clip:e,...n},Ma),this.binWidth=m(t)}render(t,e,n,r,i){const{binWidth:o}=this,{marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,width:u,height:f}=r,h=c-ka,d=u-s-ka,p=a-0,m=f-l-0,g=o/2,y=g*un,v=y/2,x=2*g,w=1.5*y,b=`m0,${-y}l${g},${v}v${y}l${-g},${v}`,k=Math.floor(h/x),$=Math.ceil(d/x),M=Math.floor((p+v)/w),L=Math.ceil((m-v)/w)+1,A=[];for(let t=M;t<L;++t)for(let e=k;e<$;++e)A.push(`M${e*x+(1&t)*g},${t*w}${b}`);return vt("svg:g",i).call(Ft,this,e,r,i).call((t=>t.append("path").call(It,this).call(Ut,this,{},Nt+ka,Nt+0).attr("d",A.join("")))).node()}}const Aa={ariaLabel:"image",fill:null,stroke:null};class Ea extends Jr{constructor(t,e={}){let{x:n,y:r,width:i,height:o,src:a,preserveAspectRatio:s,crossOrigin:l,frameAnchor:c}=e;void 0===i&&void 0!==o?i=o:void 0===o&&void 0!==i&&(o=i);const[u,f]="string"==typeof(h=a)&&(function(t){return/^\.*\//.test(t)}(h)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(h))?[void 0,h]:[h,void 0];var h;const[d,m]=k(i,16),[g,y]=k(o,16);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},width:{value:d,filter:Rt,optional:!0},height:{value:g,filter:Rt,optional:!0},src:{value:u,optional:!0}},e,Aa),this.src=f,this.width=m,this.height=y,this.preserveAspectRatio=Ht(s,"xMidYMid"),this.crossOrigin=p(l),this.frameAnchor=rt(c)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,width:c,height:u,src:f}=n,[h,d]=Jt(this,r);return vt("svg:g",i).call(Ft,this,e,r,i).call(Ut,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(It,this).attr("x",c&&s?t=>s[t]-c[t]/2:c?t=>h-c[t]/2:s?t=>s[t]-this.width/2:h-this.width/2).attr("y",u&&l?t=>l[t]-u[t]/2:u?t=>d-u[t]/2:l?t=>l[t]-this.height/2:d-this.height/2).attr("width",c?t=>c[t]:this.width).attr("height",u?t=>u[t]:this.height).call(Xt,"href",f?t=>f[t]:this.src).call(Xt,"preserveAspectRatio",this.preserveAspectRatio).call(Xt,"crossorigin",this.crossOrigin).call(jt,this,n))).node()}}const za={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1},Oa=Symbol("projected");class Ca extends Jr{constructor(t,e={}){const{x:n,y:r,z:i}=e,o=function({curve:t,tension:e}){return"function"!=typeof t&&"projected"===`${t}`.toLowerCase()?Oa:hi(t,e)}(e);super(t,{x:{value:n,scale:o===Oa?void 0:"x"},y:{value:r,scale:o===Oa?void 0:"y"},z:{value:P(e),optional:!0}},e,za),this.z=i,this.curve=o,Ji(this,e)}filter(t){return t}render(t,n,r,i,o){const{x:a,y:s}=r,{curve:l}=this;return vt("svg:g",o).call(Ft,this,n,i,o).call(Ut,this,n).call((n=>n.selectAll().data(_t(t,[a,s],this,r)).enter().append("path").call(It,this).call(Wt,this,r).call(so,this,r).attr("d",l===Oa?function(t,n,r){const i=e.geoPath(t);return n=Yn(n),r=Yn(r),t=>{let e=[];const o=[e];for(const i of t)-1===i?(e=[],o.push(e)):e.push([n[i],r[i]]);return i({type:"MultiLineString",coordinates:o})}}(o.projection,a,s):e.line().curve(l).defined((t=>t>=0)).x((t=>a[t])).y((t=>s[t]))))).node()}}function Ra(t,e,n){var r=0===t||1===t?0:Math.exp(Na(e+n)-Na(e)-Na(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*Ba(t,e,n)/e:1-r*Ba(1-t,n,e)/n)}function Ba(t,e,n){var r,i,o,a,s=1e-30,l=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<s&&(d=s),a=d=1/d;l<=100&&(d=1+(i=l*(n-l)*t/((f+(r=2*l))*(e+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=(d=1/d)*h,d=1+(i=-(e+l)*(c+l)*t/((e+r)*(u+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=o=(d=1/d)*h,!(Math.abs(o-1)<3e-7));l++);return a}function Na(t){var e,n,r,i=0,o=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);i<6;i++)a+=o[i]/++n;return Math.log(2.506628274631*a/e)-r}function Sa(t,e){var n=function(t,e,n){var r,i,o,a,s,l,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(o=t<.5?t:1-t,l=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(o))))/(1+a*(.99229+.04481*a))-a,t<.5&&(l=-l),c=(l*l-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=l*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),l=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),i=Math.log(n/(e+n)),l=t<(a=Math.exp(e*r)/e)/(f=a+(s=Math.exp(n*i)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Na(e)-Na(n)+Na(e+n);m<10;m++){if(0===l||1===l)return l;if((l-=a=(s=(Ra(l,e,n)-t)/(a=Math.exp(d*Math.log(l)+p*Math.log(1-l)+h)))/(1-.5*Math.min(1,s*(d/l-p/(1-l)))))<=0&&(l=.5*(l+a)),l>=1&&(l=.5*(l+a+1)),Math.abs(a)<1e-8*l&&m>0)break}return l}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Pa={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ta extends Jr{constructor(t,e={}){const{x:n,y:r,z:i,ci:o=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:P(e),optional:!0}},e,Pa),this.z=i,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${o}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,{ci:l}=this;return vt("svg:g",i).call(Ft,this,e,r,i).call(Ut,this,e).call((e=>e.selectAll().data(s?Yt(t,s,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(It,this).call(Wt,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,o,a))).call(l&&!nt(this.fill)?t=>t.select(qa).attr("stroke","none").call(It,this).call(Wt,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,o,a))):()=>{}))))).node()}}function qa(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class Da extends Ta{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>r[t])),l=Wa(t,r,n),c=Ya(t,r,n,(1-i)/2,l);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>r[t])),a=Wa(t,r,n);return`M${a(i)},${i}L${a(o)},${o}`}}class ja extends Ta{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>n[t])),l=Wa(t,n,r),c=Ya(t,n,r,(1-i)/2,l);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=Wa(t,n,r);return`M${i},${a(i)}L${o},${a(o)}`}}function Wa(t,e,n){let r=0,i=0,o=0,a=0;for(const s of t){const t=e[s],l=n[s];r+=t,i+=l,o+=t*l,a+=t*t}const s=t.length,l=(s*o-r*i)/(s*a-r*r),c=(i-l*r)/s;return t=>l*t+c}function Ya(t,n,r,i,o){const a=e.sum(t,(t=>n[t]))/t.length;let s=0,l=0;for(const e of t)s+=(n[e]-a)**2,l+=(r[e]-o(n[e]))**2;const c=Math.sqrt(l/(t.length-2)),u=Sa(i,t.length-2);return(e,n)=>{const r=o(e),i=c*Math.sqrt(1/t.length+(e-a)**2/s);return r+n*u*i}}const _a={ariaLabel:"rect"};class Fa extends Jr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,inset:a=0,insetTop:s=a,insetRight:l=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,_a),this.insetTop=m(s),this.insetRight=m(l),this.insetBottom=m(c),this.insetLeft=m(u),this.rx=Ht(f,"auto"),this.ry=Ht(h,"auto")}render(t,e,n,r,i){const{x:o,y:a}=e,{x1:s,y1:l,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:g}=r,{insetTop:y,insetRight:v,insetBottom:x,insetLeft:w,rx:b,ry:k}=this;return vt("svg:g",i).call(Ft,this,e,r,i).call(Ut,this,{x:s&&c&&o,y:l&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(It,this).attr("x",s&&c&&!qn(o)?t=>Math.min(s[t],c[t])+w:p+w).attr("y",l&&u&&!qn(a)?t=>Math.min(l[t],u[t])+y:f+y).attr("width",s&&c&&!qn(o)?t=>Math.max(0,Math.abs(c[t]-s[t])-w-v):m-h-p-v-w).attr("height",l&&u&&!qn(a)?t=>Math.max(0,Math.abs(l[t]-u[t])-y-x):g-f-d-y-x).call(Xt,"rx",b).call(Xt,"ry",k).call(jt,this,n))).node()}}const Ia={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class Ga extends Jr{constructor(t,e={}){const{x:n,y:r,text:i=(X(t)&&U(t)?f:u),frameAnchor:o,textAnchor:a=(/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle"),lineAnchor:s=(/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle"),lineHeight:c=1,lineWidth:h=1/0,monospace:d,fontFamily:m=(d?"ui-monospace, monospace":void 0),fontSize:g,fontStyle:y,fontVariant:v,fontWeight:x,rotate:w}=e,[b,$]=k(w,0),[L,A]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Va.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(g);var E;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:L,optional:!0},rotate:{value:(E=b,null==E?null:{transform:t=>l(t,E,Float64Array),label:F(E)}),optional:!0},text:{value:i,filter:Ot}},e,Ia),this.rotate=$,this.textAnchor=Ht(a,"middle"),this.lineAnchor=M(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+h,this.monospace=!!d,this.fontFamily=p(m),this.fontSize=A,this.fontStyle=p(y),this.fontVariant=p(v),this.fontWeight=p(x),this.frameAnchor=rt(o)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,rotate:c,text:u,fontSize:f}=n,{rotate:h}=this,[d,p]=Jt(this,r);return vt("svg:g",i).call(Ft,this,e,r,i).call(Ha,this,u,r).call(Ut,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(It,this).call(Xa,this,u).attr("transform",c?s&&l?t=>`translate(${s[t]},${l[t]}) rotate(${c[t]})`:s?t=>`translate(${s[t]},${p}) rotate(${c[t]})`:l?t=>`translate(${d},${l[t]}) rotate(${c[t]})`:t=>`translate(${d},${p}) rotate(${c[t]})`:h?s&&l?t=>`translate(${s[t]},${l[t]}) rotate(${h})`:s?t=>`translate(${s[t]},${p}) rotate(${h})`:l?t=>`translate(${d},${l[t]}) rotate(${h})`:`translate(${d},${p}) rotate(${h})`:s&&l?t=>`translate(${s[t]},${l[t]})`:s?t=>`translate(${s[t]},${p})`:l?t=>`translate(${d},${l[t]})`:`translate(${d},${p})`).call(Xt,"font-size",f&&(t=>f[t])).call(jt,this,n))).node()}}function Xa(t,{monospace:n,lineAnchor:r,lineHeight:i,lineWidth:o},a){if(!a)return;const s=isFinite(o)?n?t=>Za(t,o,Ja):t=>Za(t,100*o,Qa):t=>t.split(/\r\n?|\n/g);t.each((function(t){const n=s(Mt(a[t])),o=n.length,l="top"===r?.71:"bottom"===r?1-o:(164-100*o)/200;if(o>1)for(let t=0;t<o;++t){if(!n[t])continue;const r=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");r.setAttribute("x",0),r.setAttribute("y",(l+t)*i+"em"),r.textContent=n[t],this.appendChild(r)}else l&&this.setAttribute("y",l*i+"em"),this.textContent=n[0]}))}function Ua(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=S(n,r)),new Ga(t,{...i,x:n,y:r})}function Ha(t,e,n){Xt(t,"text-anchor",e.textAnchor),Xt(t,"font-family",e.fontFamily),Xt(t,"font-size",e.fontSize),Xt(t,"font-style",e.fontStyle),Xt(t,"font-variant",void 0===e.fontVariant&&(function(t){for(const e of t)if(null!=e)return"number"==typeof e}(n)||V(n))?"tabular-nums":e.fontVariant),Xt(t,"font-weight",e.fontWeight)}const Va=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Za(t,e,n=((t,e,n)=>n-e)){const r=[];let i,o=0;for(const[a,s,l]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===i&&(i=a),o>i&&n(t,i,s)>e&&(r.push(t.slice(i,o)),i=a),l?(r.push(t.slice(i,s)),i=void 0):o=s;return r}const Ka={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47};function Qa(t,e,n){let r=0;for(let i=e;i<n;++i){r+=Ka[t[i]]||Ka.e;const e=t.charCodeAt(i);if(e>=55296&&e<=56319){const e=t.charCodeAt(i+1);e>=56320&&e<=57343&&++i}}return r}function Ja(t,e,n){return n-e}function ts(t={}){let{path:n=f,delimiter:r,frameAnchor:i,treeLayout:o=e.tree,treeSort:a,treeSeparation:s,treeAnchor:c,...u}=t;c=ns(c),a=os(a),void 0===i&&(i=c.frameAnchor);const d=ss(r),p=bs(u,cs),[m,g]=Y(),[y,v]=Y();return{x:m,y:y,frameAnchor:i,...Kn(u,((t,r)=>{const i=d(l(t,n)),u=g([]),f=v([]);let m=-1;const y=[],x=[],w=e.stratify().path((t=>i[t])),b=o();b.nodeSize&&b.nodeSize([1,1]),b.separation&&void 0!==s&&b.separation(s??h);for(const t of p)t[ws]=t[vs]([]);for(const e of r){const n=[],r=w(e.filter((t=>null!=i[t]))).each((e=>e.data=t[e.data]));null!=a&&r.sort(a),b(r);for(const t of r.descendants()){n.push(++m),y[m]=t.data,c.position(t,m,u,f);for(const e of p)e[ws][m]=e[xs](t)}x.push(n)}return{data:y,facets:x}})),...Object.fromEntries(p)}}function es(t={}){let{path:n=f,delimiter:r,curve:i="bump-x",stroke:o="#555",strokeWidth:a=1.5,strokeOpacity:s=.5,treeLayout:c=e.tree,treeSort:u,treeSeparation:d,treeAnchor:p,...m}=t;p=ns(p),u=os(u),m={curve:i,stroke:o,strokeWidth:a,strokeOpacity:s,...m};const g=ss(r),y=bs(m,us),[v,x]=Y(),[w,b]=Y(),[k,$]=Y(),[M,L]=Y();return{x1:v,x2:w,y1:k,y2:M,...Kn(m,((t,r)=>{const i=g(l(t,n)),o=x([]),a=b([]),s=$([]),f=L([]);let m=-1;const v=[],w=[],k=e.stratify().path((t=>i[t])),M=c();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==d&&M.separation(d??h);for(const t of y)t[ws]=t[vs]([]);for(const e of r){const n=[],r=k(e.filter((t=>null!=i[t]))).each((e=>e.data=t[e.data]));null!=u&&r.sort(u),M(r);for(const{source:t,target:e}of r.links()){n.push(++m),v[m]=e.data,p.position(t,m,o,s),p.position(e,m,a,f);for(const n of y)n[ws][m]=n[xs](e,t)}w.push(n)}return{data:v,facets:w}})),...Object.fromEntries(y)}}function ns(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return rs;case"right":return is}throw new Error(`invalid tree anchor: ${t}`)}const rs={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,i){r[n]=e,i[n]=-t}},is={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,i){r[n]=-e,i[n]=-t}};function os(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?as(cs(t)):as(function(t){return e=>e.data?.[t]}(t))}function as(t){return(e,n)=>Et(t(e),t(n))}function ss(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function ls(t){return O(t)&&"function"==typeof t.node}function cs(t){if(ls(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return hs;case"node:path":return fs;case"node:internal":return ms;case"node:depth":return ds;case"node:height":return ps}throw new Error(`invalid node value: ${t}`)}}function us(t){if(ls(t))return t.node;if(O(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return gs(hs);case"parent:path":return gs(fs);case"parent:depth":return gs(ds);case"parent:height":return gs(ps);case"node:name":return hs;case"node:path":return fs;case"node:internal":return ms;case"node:depth":return ds;case"node:height":return ps}throw new Error(`invalid link value: ${t}`)}}function fs(t){return t.id}function hs(t){return function(t){let e=t.length;for(;--e>0&&!ys(t,e););return t.slice(e+1)}(t.id)}function ds(t){return t.depth}function ps(t){return t.height}function ms(t){return!!t.children}function gs(t){return(e,n)=>null==n?void 0:t(n)}function ys(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const vs=2,xs=3,ws=4;function bs(t,e){const n=[];for(const r in t){const i=t[r],o=e(i);void 0!==o&&n.push([r,...Y(i),o])}return n}function ks(t,e={}){let{fill:n,stroke:r,strokeWidth:i,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=et(h)&&et(d),text:m="node:name",textStroke:g="white",title:y="node:path",dx:v,dy:x,...w}=e;return void 0===v&&(v=ns(w.treeAnchor).dx),ti(fo(t,es({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:i,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,...w})),p?So(t,ts({fill:void 0===n?"node:internal":n,title:y,...w})):null,null!=m?Ua(t,ts({text:m,fill:void 0===n?"currentColor":n,stroke:g,dx:v,dy:x,title:y,...w})):null)}const $s={ariaLabel:"vector",fill:null,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round"};class Ms extends Jr{constructor(t,e={}){const{x:n,y:r,length:i,rotate:o,anchor:a="middle",frameAnchor:s}=e,[l,c]=k(i,12),[u,f]=k(o,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:l,scale:"length",optional:!0},rotate:{value:u,optional:!0}},e,$s),this.length=c,this.rotate=f,this.anchor=M(a,"anchor",["start","middle","end"]),this.frameAnchor=rt(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,length:c,rotate:u}=n,{length:f,rotate:h,anchor:d}=this,[p,m]=Jt(this,r),g=c?t=>c[t]:()=>f,y=u?t=>u[t]:()=>h,v=s?t=>s[t]:()=>p,x=l?t=>l[t]:()=>m,w="start"===d?0:"end"===d?1:.5;return vt("svg:g",i).attr("fill","none").call(Ft,this,e,r,i).call(Ut,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("path").call(It,this).attr("d",(t=>{const e=g(t),n=y(t)*Lt,r=Math.sin(n)*e,i=-Math.cos(n)*e,o=(r+i)/5,a=(r-i)/5;return`M${v(t)-r*w},${x(t)-i*w}l${r},${i}m${-a},${-o}l${a},${o}l${-o},${a}`})).call(jt,this,n))).node()}}function Ls(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(o=a,i=a-1):r=a+1}return o}function As(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(o=a,i=a-1):r=a+1}return o}function Es(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(o=a,r=a+1):i=a-1}return o}function zs(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(o=a,r=a+1):i=a-1}return o}function Os(t,e,n,r,i){for(;r<=i;){var o=r+i>>>1,a=t[o],s=void 0!==n?n(a,e):a-e;if(0===s)return o;s<=0?r=o+1:i=o-1}return-1}function Cs(t,e,n,r,i,o){return"function"==typeof n?o(t,e,n,void 0===r?0:0|r,void 0===i?t.length-1:0|i):o(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Rs={ge:function(t,e,n,r,i){return Cs(t,e,n,r,i,Ls)},gt:function(t,e,n,r,i){return Cs(t,e,n,r,i,As)},lt:function(t,e,n,r,i){return Cs(t,e,n,r,i,Es)},le:function(t,e,n,r,i){return Cs(t,e,n,r,i,zs)},eq:function(t,e,n,r,i){return Cs(t,e,n,r,i,Os)}},Bs=function(t){if(!t||0===t.length)return new Xs(null);return new Xs(Gs(t))};function Ns(t,e,n,r,i){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=i,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Ss=Ns.prototype;function Ps(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function Ts(t,e){var n=Gs(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function qs(t,e){var n=t.intervals([]);n.push(e),Ts(t,n)}function Ds(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),Ts(t,n),1)}function js(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var i=n(t[r]);if(i)return i}}function Ws(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var i=n(t[r]);if(i)return i}}function Ys(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function _s(t,e){return t-e}function Fs(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Is(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Gs(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(_s);var r=e[e.length>>1],i=[],o=[],a=[];for(n=0;n<t.length;++n){var s=t[n];s[1]<r?i.push(s):r<s[0]?o.push(s):a.push(s)}var l=a,c=a.slice();return l.sort(Fs),c.sort(Is),new Ns(r,Gs(i),Gs(o),l,c)}function Xs(t){this.root=t}Ss.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Ss.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?qs(this,t):this.left.insert(t):this.left=Gs([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?qs(this,t):this.right.insert(t):this.right=Gs([t]);else{var n=Rs.ge(this.leftPoints,t,Fs),r=Rs.ge(this.rightPoints,t,Is);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Ss.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Ds(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Ds(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var i=this.left,o=this.right;n.count-=r.count,n.right=r.left,r.left=i,r.right=o}Ps(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Ps(this,this.left):Ps(this,this.right);return 1}for(i=Rs.ge(this.leftPoints,t,Fs);i<this.leftPoints.length&&this.leftPoints[i][0]===t[0];++i)if(this.leftPoints[i]===t){this.count-=1,this.leftPoints.splice(i,1);for(o=Rs.ge(this.rightPoints,t,Is);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),1}return 0},Ss.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return js(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Ws(this.rightPoints,t,e)}return Ys(this.leftPoints,e)},Ss.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?js(this.leftPoints,e,n):t>this.mid?Ws(this.rightPoints,t,n):Ys(this.leftPoints,n)};var Us=Xs.prototype;Us.insert=function(t){this.root?this.root.insert(t):this.root=new Ns(t[0],null,null,[t],[t])},Us.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Us.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Us.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Us,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Us,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});const Hs=({marginLeft:t})=>[1,t],Vs=({width:t,marginRight:e})=>[-1,t-e],Zs=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Ks=({marginTop:t})=>[1,t],Qs=({height:t,marginBottom:e})=>[-1,t-e],Js=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function tl(t){return"string"==typeof t?{anchor:t}:t}function el(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function nl(t,e,n,r,i){const{r:o}=i;if(null!=o&&"number"!=typeof o){const{channels:t,sort:e,reverse:n}=i;i={...i,channels:{r:{value:o,scale:"r"},...ot(t)}},void 0===e&&void 0===n&&(i.sort={channel:"r",order:"descending"})}return Qn(i,(function(o,a,{[e]:s,r:c},u,h){if(!s)throw new Error(`missing channel: ${e}`);s=Yn(l(s.value,u[s.scale]||f));const d=c?void 0:void 0!==this.r?this.r:void 0!==i.r?m(i.r):3;c&&(c=Yn(l(c.value,u[c.scale]||f)));let[p,g]=n(h);const y=p?il:rl,v=new Float64Array(s.length),x=c?t=>c[t]:()=>d;for(let t of a){const e=Bs();t=t.filter(c?t=>Ct(s[t])&&Rt(c[t]):t=>Ct(s[t]));const n=new Float64Array(2*t.length+2);for(const i of t){const t=x(i),o=p?t+r:0,a=s[i]-t,l=s[i]+t;let u=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=v[t]-o,a=s[i]-s[t],l=r+(c?c[i]+c[t]:2*d),f=Math.sqrt(l*l-a*a);n[u++]=e-f,n[u++]=e+f}));let f=n.slice(0,u);p&&(f=f.filter((t=>t>=0)));t:for(const t of f.sort(y)){for(let e=0;e<u;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;v[i]=t+o;break}e.insert([a,l,i])}}p||(p=1);for(const t of a)for(const e of t)v[e]=v[e]*p+g;return{data:o,facets:a,channels:{[e]:{value:s},[t]:{value:v},...c&&{r:{value:c}}}}}))}function rl(t,e){return Math.abs(t)-Math.abs(e)}function il(t,e){return t-e}function ol(t){if(void 0===t)return cl;if("function"==typeof t)return al(((e,n)=>t(D(n,e))));if(/^p\d{2}$/i.test(t))return sl(w(t));switch(`${t}`.toLowerCase()){case"deviation":return fl;case"first":return cl;case"last":return ul;case"max":return hl;case"mean":return dl;case"median":return pl;case"min":return ml;case"sum":return gl;case"extent":return ll}throw new Error(`invalid basis: ${t}`)}function al(t){return{map(e,n,r){const i=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/i}}}function sl(t){return al(((e,n)=>t(e,(t=>n[t]))))}const ll={map(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=o-i;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-i)/a}},cl=al(((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(At(r))return r}})),ul=al(((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(At(r))return r}})),fl={map(t,n,r){const i=e.mean(t,(t=>n[t])),o=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:o?(n[e]-i)/o:0}},hl=sl(e.max),dl=sl(e.mean),pl=sl(e.median),ml=sl(e.min),gl=sl(e.sum);function yl(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:i,anchor:o,strict:a}=t;if(void 0===o&&void 0!==i&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(i),st(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return xl(w(t));switch(t.toLowerCase()){case"deviation":return xl(e.deviation);case"max":return wl(e.max);case"mean":return kl;case"median":return xl(e.median);case"min":return wl(e.min);case"mode":return wl(e.mode);case"sum":return bl;case"variance":return xl(e.variance);case"difference":return El;case"ratio":return zl;case"first":return Ol;case"last":return Cl}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return wl(t)}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(o,n),a)}function vl(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function xl(t){return(e,n,r)=>r?{map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));let s=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++s;for(let i=0,l=r.length-e+1;i<l;++i)isNaN(a[i+e-1])&&++s,o[r[i+n]]=0===s?t(a.subarray(i,i+e)):NaN,isNaN(a[i])&&--s}}:{map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));for(let i=-n;i<0;++i)o[r[i+n]]=t(a.subarray(0,i+e));for(let i=0,s=r.length-n;i<s;++i)o[r[i+n]]=t(a.subarray(i,i+e))}}}function wl(t){return(e,n,r)=>r?{map(r,i,o){let a=0;for(let t=0;t<e-1;++t)a+=At(i[r[t]]);for(let s=0,l=r.length-e+1;s<l;++s)a+=At(i[r[s+e-1]]),a===e&&(o[r[s+n]]=t(D(i,vl(r,s,s+e)))),a-=At(i[r[s]])}}:{map(r,i,o){for(let a=-n;a<0;++a)o[r[a+n]]=t(D(i,vl(r,0,a+e)));for(let a=0,s=r.length-n;a<s;++a)o[r[a+n]]=t(D(i,vl(r,a,a+e)))}}}function bl(t,e,n){return n?{map(n,r,i){let o=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++o:a+=+t}for(let s=0,l=n.length-t+1;s<l;++s){const l=r[n[s]],c=r[n[s+t-1]];null===c||isNaN(c)?++o:a+=+c,i[n[s+e]]=0===o?a:NaN,null===l||isNaN(l)?--o:a-=+l}}}:{map(n,r,i){let o=0;const a=n.length;for(let i=0,s=Math.min(a,t-e-1);i<s;++i)o+=+r[n[i]]||0;for(let s=-e,l=a-e;s<l;++s)o+=+r[n[s+t-1]]||0,i[n[s+e]]=o,o-=+r[n[s]]||0}}}function kl(t,e,n){if(n){const r=bl(t,e,n);return{map(n,i,o){r.map(n,i,o);for(let r=0,i=n.length-t+1;r<i;++r)o[n[r+e]]/=t}}}return{map(n,r,i){let o=0,a=0;const s=n.length;for(let i=0,l=Math.min(s,t-e-1);i<l;++i){let t=r[n[i]];null===t||isNaN(t=+t)||(o+=t,++a)}for(let l=-e,c=s-e;l<c;++l){let s=r[n[l+t-1]],c=r[n[l]];null===s||isNaN(s=+s)||(o+=s,++a),i[n[l+e]]=o/a,null===c||isNaN(c=+c)||(o-=c,--a)}}}}function $l(t,e,n,r){for(let i=n+r;n<i;++n){const r=t[e[n]];if(At(r))return r}}function Ml(t,e,n,r){for(let i=n+r-1;i>=n;--i){const n=t[e[i]];if(At(n))return n}}function Ll(t,e,n,r){for(let i=n+r;n<i;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function Al(t,e,n,r){for(let i=n+r-1;i>=n;--i){let n=t[e[i]];if(null!==n&&!isNaN(n=+n))return n}}function El(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s-a}}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Al(r,n,o,t)-Ll(r,n,o,t)}}}function zl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s/a}}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Al(r,n,o,t)/Ll(r,n,o,t)}}}function Ol(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o]]}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=$l(r,n,o,t)}}}function Cl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o+t-1]]}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Ml(r,n,o,t)}}}function Rl(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Tl;case"max":return ql}throw new Error(`unknown selector: ${t}`)}function Bl(t){return Dl(null,Sl,t)}function Nl(t){return Dl(null,Pl,t)}function*Sl(t){yield t[0]}function*Pl(t){yield t[t.length-1]}function*Tl(t,n){yield e.least(t,(t=>n[t]))}function*ql(t,n){yield e.greatest(t,(t=>n[t]))}function Dl(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const i=P(r);return Kn(r,((r,o)=>{const a=l(r,i),s=l(r,t),c=[];for(const t of o){const r=[];for(const i of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(i,s))r.push(t);c.push(r)}return{data:r,facets:c}}))}const jl={ariaLabel:"brush",fill:"#777",fillOpacity:.3,stroke:"#fff"};class Wl extends Jr{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",optional:!0},y:{value:n,scale:"y",optional:!0}},r,jl),this.initialX=r.initialX,this.initialY=r.initialY,this.activeElement=null}render(t,n,r,i,o){const{x:a,y:s}=r,{x:l,y:c}=n,{ariaLabel:u,ariaDescription:f,ariaHidden:h,...d}=this,{marginLeft:p,width:m,marginRight:g,marginTop:y,height:v,marginBottom:x}=i,w=this,b=(a&&s?e.brush:a?e.brushX:e.brushY)().extent([[p,y],[m-g,v-x]]),k=e.create("svg:g",o).call(Ft,{ariaLabel:u,ariaDescription:f,ariaHidden:h},n,i,o).call(b).call((t=>t.selectAll(".selection").attr("shape-rendering",null).call(Ft,d,i,o).call(Ut,this,n)));if(this.initialX&&this.initialY&&l&&c){const[t,e]=this.initialX.map(l),[n,r]=this.initialY.map(c);k.call(b.move,[[t,n],[e,r]])}if(this.initialX&&a){const[t,e]=this.initialX.map(l);k.call(b.move,[t,e])}else if(this.initialY&&s){const[t,e]=this.initialY.map(c);k.call(b.move,[t,e])}b.on("start end brush",(function(n){const{type:r,selection:i}=n;"start"===r&&w.activeElement!==this&&(null!==w.activeElement&&(e.select(w.activeElement).call(n.target.clear,n),w.activeElement[Kr]=null),w.activeElement=this);let o,u,f=null;if(i){if(f=t,a){let[t,e]=s?[i[0][0],i[1][0]]:i;o=[l.invert(t),l.invert(e)],l.bandwidth&&(t-=l.bandwidth()),f=f.filter((n=>t<=a[n]&&a[n]<=e))}if(s){let[t,e]=a?[i[0][1],i[1][1]]:i;u=[c.invert(t),c.invert(e)],c.bandwidth&&(t-=c.bandwidth()),f=f.filter((n=>t<=s[n]&&s[n]<=e))}}if(!function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;++r)if(t[r]!==e[r])return!1;return!0}(this[Kr],f)||"end"===n.type){this[Kr]=f;const t=null===f?w.data:D(w.data,f);this.dispatchEvent(new CustomEvent("input",{bubbles:!0,detail:{type:n.type,selected:t,extentX:o,extentY:u}}))}}));const $=k.node();return $[Kr]=null,$}}const Yl={ariaLabel:"pointer",fill:"none",stroke:"#3b5fc0",strokeWidth:1.5};class _l extends Jr{constructor(t,{x:e,y:n,n:r=1,r:i=(isFinite(r)?120:20),mode:o="auto",...a}={}){super(t,[{name:"x",value:e,scale:"x",optional:!0},{name:"y",value:n,scale:"y",optional:!0}],a,Yl),this.n=+r,this.r=+i,this.mode=function(t="auto",e,n){switch(t=`${t}`.toLowerCase()){case"auto":t=null==n?"x":null==e?"y":"xy";break;case"x":case"y":case"xy":break;default:throw new Error(`invalid mode: ${t}`)}if(/^x/.test(t)&&null==e)throw new Error("missing channel: x");if(/y$/.test(t)&&null==n)throw new Error("missing channel: y");return t}(o,e,n)}render(t,{x:n,y:r},{x:i,y:o},a){const{marginLeft:s,width:l,marginRight:c,marginTop:u,height:f,marginBottom:h}=a,{mode:d,n:p,r:m}=this,g=m*m,y=new Set;let v=[],x=null;const w=e.create("svg:g"),b=w.append("g").call(Ft,this,a).call(It,this).node(),k=n?.bandwidth?.(),$=r?.bandwidth?.(),M=i&&o?k&&$?t=>Fl("rect",{x:i[t],y:o[t],width:k,height:$}):k?t=>Fl("line",{x1:i[t],x2:i[t]+k,y1:o[t],y2:o[t]}):$?t=>Fl("line",{x1:i[t],x2:i[t],y1:o[t],y2:o[t]+$}):t=>Fl("circle",{cx:i[t],cy:o[t],r:4}):i?k?t=>Fl("rect",{x:i[t],y:u,width:k,height:f-h-u}):t=>Fl("line",{x1:i[t],x2:i[t],y1:u,y2:f-h}):$?t=>Fl("rect",{x:s,y:o[t],width:l-c-s,height:$}):t=>Fl("line",{y1:o[t],y2:o[t],x1:s,x2:l-c});function L(t){const e=[];let n=!1;return t.forEach((t=>{let r=v[t];r||(r=M(t),b.appendChild(r),n=!0),e[t]=r})),v.forEach(((t,r)=>{e[r]||(t.remove(),n=!0)})),n&&(v=e),n}function A(t){if(null===t)L([]);else if(!L(t))return;E[Kr]=t,E.dispatchEvent(new Event("input",{bubbles:!0}))}w.append("rect").attr("fill","none").attr("pointer-events","all").attr("width",l+s+c).attr("height",f+u+h).on("pointerdown pointerover pointermove",(a=>{if("pointerdown"===a.type){const t=!x;if(y.add(a.pointerId),!t&&a.shiftKey||(x=[]),!t&&!a.shiftKey)return A(x)}if(x&&!y.has(a.pointerId))return;let[s,l]=e.pointer(a);n.bandwidth&&(s-=n.bandwidth()/2),r.bandwidth&&(l-=r.bandwidth()/2);let c=t;switch(d){case"xy":m<1/0&&(c=c.filter((t=>{const e=i[t]-s,n=o[t]-l;return e*e+n*n<=g}))),c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=i[t]-s,r=o[t]-l,a=i[e]-s,c=o[e]-l;return n*n+r*r-(a*a+c*c)})),c=c.slice(0,p));break;case"x":if(m<1/0){const[t,e]=[s-m,s+m];c=c.filter((n=>t<=i[n]&&i[n]<=e))}c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=i[t]-s,r=i[e]-s;return n*n-r*r})),c=c.slice(0,p));break;case"y":if(m<1/0){const[t,e]=[l-m,l+m];c=c.filter((n=>t<=o[n]&&o[n]<=e))}c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=o[t]-l,r=o[e]-l;return n*n-r*r})),c=c.slice(0,p))}A(x?x=Array.from(e.union(x,c)):c)})).on("pointerup",(t=>{x&&!x.length&&A(x=null),y.delete(t.pointerId)})).on("pointerout",(()=>{x||A(null)}));const E=w.node();return E[Kr]=null,E}}function Fl(t,n){const r=document.createElementNS(e.namespaces.svg,t);for(const t in n)r.setAttribute(t,n[t]);return r}t.Area=Ki,t.Arrow=mo,t.BarX=xo,t.BarY=wo,t.Brush=Wl,t.Cell=Jo,t.Density=pa,t.Dot=No,t.Frame=va,t.Geo=wa,t.Hexgrid=La,t.Image=Ea,t.Line=Ca,t.Link=uo,t.Mark=Jr,t.Pointer=_l,t.Rect=Fa,t.RuleX=To,t.RuleY=qo,t.Text=Ga,t.TickX=Fo,t.TickY=Io,t.Vector=Ms,t.area=function(t,e){return void 0===e?Qi(t,{x:y,y:v}):new Ki(t,e)},t.areaX=function(t,e){const{y:n=u,...r}=yi(e);return new Ki(t,Bi(zi({...r,y1:n,y2:void 0})))},t.areaY=Qi,t.arrow=function(t,e={}){let{x:n,x1:r,x2:i,y:o,y1:a,y2:s,...l}=e;return[r,i]=ho(n,r,i),[a,s]=ho(o,a,s),new mo(t,{...l,x1:r,x2:i,y1:a,y2:s})},t.barX=bo,t.barY=ko,t.bin=function(t={fill:"count"},e={}){[t,e]=xi(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=wi(e,t),n=wi(n,t),[e.value,n.value]=S(e.value,n.value),{x:e,y:n}}(e);return vi(n,r,null,null,t,Ee(ze(e)))},t.binX=di,t.binY=pi,t.boxX=function(t,e={}){const{x:n={transform:t=>t},y:r=null,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?ur:lr;return ti(jo(t,f({x1:Ho,x2:Vo},{x:n,y:r,stroke:a,strokeOpacity:s,...u})),bo(t,f({x1:"p25",x2:"p75"},{x:n,y:r,fill:i,fillOpacity:o,...u})),Go(t,f({x:"p50"},{x:n,y:r,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),So(t,Lo({x:Uo},{x:n,y:r,z:r,stroke:a,strokeOpacity:s,...u})))},t.boxY=function(t,e={}){const{y:n={transform:t=>t},x:r=null,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?cr:lr;return ti(Do(t,f({y1:Ho,y2:Vo},{x:r,y:n,stroke:a,strokeOpacity:s,...u})),ko(t,f({y1:"p25",y2:"p75"},{x:r,y:n,fill:i,fillOpacity:o,...u})),Xo(t,f({y:"p50"},{x:r,y:n,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),So(t,Lo({y:Uo},{x:r,y:n,z:r,stroke:a,strokeOpacity:s,...u})))},t.brush=function(t,{x:e,y:n,...r}={}){return[e,n]=S(e,n),new Wl(t,{...r,x:e,y:n})},t.brushX=function(t,{x:e=f,...n}={}){return new Wl(t,{...n,x:e})},t.brushY=function(t,{y:e=f,...n}={}){return new Wl(t,{...n,y:e})},t.cell=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=S(n,r),new Jo(t,{...i,x:n,y:r})},t.cellX=function(t,e={}){let{x:n=u,fill:r,stroke:i,...o}=e;return void 0===r&&void 0===b(i)[0]&&(r=f),new Jo(t,{...o,x:n,fill:r,stroke:i})},t.cellY=function(t,e={}){let{y:n=u,fill:r,stroke:i,...o}=e;return void 0===r&&void 0===b(i)[0]&&(r=f),new Jo(t,{...o,y:n,fill:r,stroke:i})},t.circle=function(t,e){return So(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return ks(t,{...n,treeLayout:e.cluster})},t.column=Y,t.delaunayLink=function(t,e){return ha(oa,t,e)},t.delaunayMesh=function(t,e){return ha(sa,t,e)},t.density=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=S(n,r),new pa(t,{...i,x:n,y:r})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=el(t));let{anchor:n="left",padding:r=1}=tl(t);switch(`${n}`.toLowerCase()){case"left":n=Hs;break;case"right":n=Vs;break;case"middle":n=Zs;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return nl("x","y",n,m(r),e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=el(t));let{anchor:n="bottom",padding:r=1}=tl(t);switch(`${n}`.toLowerCase()){case"top":n=Ks;break;case"bottom":n=Qs;break;case"middle":n=Js;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return nl("y","x",n,m(r),e)},t.dot=So,t.dotX=function(t,e={}){const{x:n=f,...r}=e;return new No(t,je({...r,x:n}))},t.dotY=function(t,e={}){const{y:n=f,...r}=e;return new No(t,De({...r,y:n}))},t.filter=function(t,e){return er(e,nr(t))},t.formatIsoDate=$t,t.formatMonth=function(t="en-US",e="short"){const n=bt(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=kt(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=function(t){return new va(t)},t.geo=ba,t.graticule=function({strokeOpacity:t=.1,...n}={}){return ba(e.geoGraticule10(),{strokeOpacity:t,...n})},t.group=function(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=S(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return fr(n,r,t,e)},t.groupX=cr,t.groupY=ur,t.groupZ=lr,t.hexagon=function(t,e){return So(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){e=void 0===e?20:m(e),t=dr(t,n);const{z:r,fill:i,stroke:o}=n;return void 0===o&&et(i)&&hr(t,"fill")&&(n.stroke="none"),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||hr(t,"r")||(n.r=e/2),Qn(n,((n,i,{x:o,y:a,z:s,fill:c,stroke:u,symbol:f},h,d,p)=>{if(void 0===o)throw new Error("missing channel: x");if(void 0===a)throw new Error("missing channel: y");({x:o,y:a}=Dr({x:o,y:a},h,p)),o=Yn(o),a=Yn(a),s=s?s.value:l(n,r),c=c?.value,u=u?.value,f=f?.value;const m=vr(t,{z:s,fill:c,stroke:u,symbol:f}),g=s&&[],y=c&&[],v=u&&[],x=f&&[],w=[],b=[],k=[];let $=-1;for(const e of t)e.initialize(n);for(const n of i){const r=[];for(const e of t)e.scope("facet",n);for(const[i,l]of gr(n,m))for(const n of $a(l,o,a,e)){r.push(++$),b.push(n.x),k.push(n.y),s&&g.push(m===s?i:s[n[0]]),c&&y.push(m===c?i:c[n[0]]),u&&v.push(m===u?i:u[n[0]]),f&&x.push(m===f?i:f[n[0]]);for(const e of t)e.reduce(n)}w.push(r)}return{data:n,facets:w,channels:{x:{value:b},y:{value:k},...s&&{z:{value:g}},...c&&{fill:{value:y,scale:!0}},...u&&{stroke:{value:v,scale:!0}},...f&&{symbol:{value:x,scale:!0}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:!0,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new La(t)},t.hull=function(t,e){return ha(la,t,e)},t.image=function(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=S(n,r)),new Ea(t,{...i,x:n,y:r})},t.initializer=Qn,t.legend=function(t={}){for(const[e,n]of Ur){const r=t[e];if(C(r)){const i=yt(t);let o;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&C(t.color)?"color":void 0)}=t;o={fill:e,stroke:n}}return n(zn(e,r,o),Hr(i,r,t),(e=>C(t[e])?zn(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=S(n,r),new Ca(t,{...i,x:n,y:r})},t.lineX=function(t,e={}){const{x:n=f,y:r=u,...i}=e;return new Ca(t,yi({...i,x:n,y:r}))},t.lineY=function(t,e={}){const{x:n=u,y:r=f,...i}=e;return new Ca(t,gi({...i,x:n,y:r}))},t.linearRegressionX=function(t,e={}){const{y:n=u,x:r=f,stroke:i,fill:o=(et(i)?"currentColor":i),...a}=e;return new Da(t,yi({...a,x:r,y:n,fill:o,stroke:i}))},t.linearRegressionY=function(t,e={}){const{x:n=u,y:r=f,stroke:i,fill:o=(et(i)?"currentColor":i),...a}=e;return new ja(t,gi({...a,x:n,y:r,fill:o,stroke:i}))},t.link=fo,t.map=Lo,t.mapX=$o,t.mapY=Mo,t.marks=ti,t.normalize=ol,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),$o(ol(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Mo(ol(t),e)},t.plot=Qr,t.pointer=function(t,{x:e,y:n,...r}={}){return[e,n]=S(e,n),new _l(t,{...r,x:e,y:n})},t.pointerX=function(t,{mode:e="x",x:n=f,...r}={}){return new _l(t,{...r,mode:e,x:n})},t.pointerY=function(t,{mode:e="y",y:n=f,...r}={}){return new _l(t,{...r,mode:e,y:n})},t.rect=function(t,e){return new Fa(t,Se(Pe(e)))},t.rectX=function(t,e={y:u,interval:1,x2:f}){return new Fa(t,Bi(Pe(zi(e))))},t.rectY=function(t,e={x:u,interval:1,y2:f}){return new Fa(t,Ni(Se(Oi(e))))},t.reverse=function(t){return{...er(t,rr),sort:null}},t.ruleX=Do,t.ruleY=jo,t.scale=function(t={}){let e;for(const n in t)if(pe.has(n)&&C(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=In(zn(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return Bl(e);case"last":return Nl(e)}if("function"==typeof t)return Dl(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=Rl(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Dl(n,r,e)},t.selectFirst=Bl,t.selectLast=Nl,t.selectMaxX=function(t){return Dl("x",ql,t)},t.selectMaxY=function(t){return Dl("y",ql,t)},t.selectMinX=function(t){return Dl("x",Tl,t)},t.selectMinY=function(t){return Dl("y",Tl,t)},t.selection=Kr,t.shuffle=function(t={}){const{seed:n,...r}=t;return{...er(r,sr(null==n?Math.random:e.randomLcg(n))),sort:null}},t.sort=ir,t.sphere=function({strokeWidth:t=1.5,...e}={}){return ba({type:"Sphere"},{strokeWidth:t,...e})},t.stackX=Ci,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{y1:n,y:r=n,x:i}=e,[o,a,s]=Pi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{y1:n,y:r=n,x:i}=e,[o,a,,s]=Pi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackY=Ri,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{x1:n,x:r=n,y:i}=e,[o,a,s]=Pi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=Si(t));const{x1:n,x:r=n,y:i}=e,[o,a,,s]=Pi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.text=Ua,t.textX=function(t,e={}){const{x:n=f,...r}=e;return new Ga(t,je({...r,x:n}))},t.textY=function(t,e={}){const{y:n=f,...r}=e;return new Ga(t,De({...r,y:n}))},t.tickX=Go,t.tickY=Xo,t.transform=Kn,t.tree=ks,t.treeLink=es,t.treeNode=ts,t.valueof=l,t.vector=function(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=S(n,r)),new Ms(t,{...i,x:n,y:r})},t.vectorX=function(t,e={}){const{x:n=f,...r}=e;return new Ms(t,{...r,x:n})},t.vectorY=function(t,e={}){const{y:n=f,...r}=e;return new Ms(t,{...r,y:n})},t.version="0.6.0",t.voronoi=function(t,e){return ha(ca,t,e)},t.voronoiMesh=function(t,e){return ha(ua,t,e)},t.window=yl,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),$o(yl(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),Mo(yl(t),e)},Object.defineProperty(t,"__esModule",{value:!0})}));
