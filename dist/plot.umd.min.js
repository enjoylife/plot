// @observablehq/plot v0.6.1 Copyright 2020-2022 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.7.0/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.7.0/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getUTCSeconds(),a=t.getUTCMilliseconds();return`${s=t.getUTCFullYear(),s<0?`-${r(-s,6)}`:s>9999?`+${r(s,6)}`:r(s,4)}-${r(t.getUTCMonth()+1,2)}-${r(t.getUTCDate(),2)}${n||i||o||a?`T${r(n,2)}:${r(i,2)}${o||a?`:${r(o,2)}${a?`.${r(a,3)}`:""}`:""}Z`:""}`;var s}function r(t,e){return`${t}`.padStart(e,"0")}const i=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function o(t,e){return i.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const a=Object.getPrototypeOf(Uint8Array),s=Object.prototype.toString;function l(t,e,n){const r=typeof e;return"string"===r?z(t,c(e),n):"function"===r?z(t,e,n):"number"===r||e instanceof Date||"boolean"===r?z(t,x(e),n):e&&"function"==typeof e.transform?A(e.transform(t),n):A(e,n)}const c=t=>e=>e[t],u=(t,e)=>e,f={transform:t=>t},h=()=>1,d=()=>!0,p=t=>null==t?t:`${t}`,m=t=>null==t?t:+t,g=t=>null==t?t:!!t,y=t=>t?t[0]:void 0,v=t=>t?t[1]:void 0,x=t=>()=>t,w=t=>t;function b(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function k(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:et(t)?[void 0,t]:[t,void 0]}function $(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function M(t,e,n){if(null!=t)return L(t,e,n)}function L(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function A(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof a?t:Array.from(t):t instanceof e?t:e.from(t)}function z(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function E(t,e=Array){return t instanceof e?t.slice():e.from(t)}function R(t){return t instanceof a}function C(t){return t?.toString===s}function O(t){return C(t)&&(void 0!==t.type||void 0!==t.domain)}function B(t){return C(t)&&"function"!=typeof t.transform}function N(t){return B(t)&&void 0===t.value&&void 0===t.channel}function S(t,e,n,r=f){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function P(t,e){return void 0===t&&void 0===e?[y,v]:[t,e]}function T({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=k(e)),void 0===t&&([t]=k(n)),t}function D(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function q(t,e){return D(t).filter((n=>e(t[n],n,t)))}function j(t,e){return z(e,(e=>t[e]))}function W(t){return null!==t&&"object"==typeof t?t.valueOf():t}function Y(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function I(t){let e;return[{transform:()=>e,label:_(t)},t=>e=t]}function F(t){return null==t?[t]:I(t)}function _(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function G(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return Z(r)||Z(i)?z(r,((t,e)=>new Date((+r[e]+ +i[e])/2))):z(r,((t,e)=>(+r[e]+ +i[e])/2),Float64Array)},label:t.label}}function X(t){return void 0===t||B(t)?t:{value:t}}function U(t){return t&&"function"==typeof t[Symbol.iterator]}function H(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function V(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Z(t){for(const e of t)if(null!=e)return e instanceof Date}function K(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&o(e)}function Q(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function J(t,e){for(const n of t)if(null!=n)return e(n)}function tt(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function et(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function nt(t){return null==t||rt(t)}function rt(t){return/^\s*none\s*$/i.test(t)}function it(t="middle"){return L(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function ot(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function at(t){return U(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const st=Symbol("position"),lt=Symbol("color"),ct=Symbol("radius"),ut=Symbol("length"),ft=Symbol("opacity"),ht=Symbol("symbol"),dt=new Map([["x",st],["y",st],["fx",st],["fy",st],["r",ct],["color",lt],["opacity",ft],["symbol",ht],["length",ut]]);function pt(t){return null!=t&&!Number.isNaN(t)}function mt(t,n){return+pt(n)-+pt(t)||e.ascending(t,n)}function gt(t,n){return+pt(n)-+pt(t)||e.descending(t,n)}function yt(t){return null!=t&&""!=`${t}`}function vt(t){return isFinite(t)?t:NaN}function xt(t){return t>0&&isFinite(t)?t:NaN}function wt(t){return t<0&&isFinite(t)?t:NaN}function bt(t={},e){let{filter:n,sort:r,reverse:i,transform:o,initializer:a,...s}=t;if(void 0===o&&(null!=n&&(o=At(n)),null==r||N(r)||(o=$t(o,Rt(r))),i&&(o=$t(o,zt))),null!=e&&null!=a)throw new Error("transforms cannot be applied after initializers");return{...s,...(null===r||N(r))&&{sort:r},transform:$t(o,e)}}function kt(t={},e){let{filter:n,sort:r,reverse:i,initializer:o,...a}=t;return void 0===o&&(null!=n&&(o=At(n)),null==r||N(r)||(o=Mt(o,Rt(r))),i&&(o=Mt(o,zt))),{...a,...(null===r||N(r))&&{sort:r},initializer:Mt(o,e)}}function $t(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,A(n),r)}}function Mt(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,i,...o){let a,s,l,c,u,f;return({data:s=n,facets:l=r,channels:a}=t.call(this,n,r,i,...o)),({data:u=s,facets:f=l,channels:c}=e.call(this,s,l,{...i,...a},...o)),{data:u,facets:f,channels:{...a,...c}}}}function Lt(t,e){return(null!=t.initializer?kt:bt)(t,e)}function At(t){return(e,n)=>{const r=l(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function zt(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Et(t,e){return{...(B(t)&&void 0!==t.channel?kt:Lt)(e,Rt(t)),sort:null}}function Rt(t){return("function"==typeof t&&1!==t.length?Ct:Ot)(t)}function Ct(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function Ot(t){let e,n;if(({channel:e,value:t,order:n=mt}={...X(t)}),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=mt;break;case"descending":n=gt;break;default:throw new Error(`invalid order: ${n}`)}return(r,i,o)=>{let a;if(void 0===e)a=l(r,t);else{if(void 0===o)throw new Error("channel sort requires an initializer");if(a=o[e],!a)return{};a=a.value}const s=(t,e)=>n(a[t],a[e]);return{data:r,facets:i.map((t=>t.slice().sort(s)))}}}function Bt(t,e){return Pt(null,null,t,e)}function Nt(t={y:"count"},e={}){const{x:n=f}=e;if(null==n)throw new Error("missing channel: x");return Pt(n,null,t,e)}function St(t={x:"count"},e={}){const{y:n=f}=e;if(null==n)throw new Error("missing channel: y");return Pt(null,n,t,e)}function Pt(t,e,{data:n=Xt,filter:r,sort:i,reverse:o,...a}={},s={}){a=Dt(a,s),n=Yt(n,f),i=null==i?void 0:qt("sort",i,s),r=null==r?void 0:jt("filter",r,s);const[c,u]=F(t),[h,d]=F(e),{z:p,fill:m,stroke:g,x1:y,x2:v,y1:x,y2:w,...b}=s,[$,M]=F(p),[L]=k(m),[A]=k(g),[z,E]=F(L),[R,C]=F(A);return{..."z"in s&&{z:$||p},..."fill"in s&&{fill:z||m},..."stroke"in s&&{stroke:R||g},...bt(b,((s,c)=>{const f=l(s,t),h=l(s,e),m=l(s,p),g=l(s,L),y=l(s,A),v=It(a,{z:m,fill:g,stroke:y}),x=[],w=[],b=f&&u([]),k=h&&d([]),$=m&&M([]),z=g&&E([]),R=y&&C([]);let O=0;for(const t of a)t.initialize(s);i&&i.initialize(s),r&&r.initialize(s);for(const t of c){const e=[];for(const e of a)e.scope("facet",t);i&&i.scope("facet",t),r&&r.scope("facet",t);for(const[o,l]of Wt(t,v))for(const[t,c]of Wt(l,h))for(const[l,u]of Wt(c,f))if(!r||r.reduce(u)){e.push(O++),w.push(n.reduce(u,s)),f&&b.push(l),h&&k.push(t),m&&$.push(v===m?o:m[u[0]]),g&&z.push(v===g?o:g[u[0]]),y&&R.push(v===y?o:y[u[0]]);for(const t of a)t.reduce(u);i&&i.reduce(u)}x.push(e)}return Ft(x,i,o),{data:w,facets:x}})),...!Tt(a,"x")&&(c?{x:c}:{x1:y,x2:v}),...!Tt(a,"y")&&(h?{y:h}:{y1:x,y2:w}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function Tt(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function Dt(t,e){const n=Object.entries(t);return null!=e.title&&void 0===t.title&&n.push(["title",Ht]),null!=e.href&&void 0===t.href&&n.push(["href",Ut]),n.map((([t,n])=>null==n?{name:t,initialize(){},scope(){},reduce(){}}:qt(t,n,e)))}function qt(t,e,n){const r=jt(t,e,n),[i,o]=I(r.label);let a;return{name:t,output:i,initialize(t){r.initialize(t),a=o([])},scope(t,e){r.scope(t,e)},reduce(t,e){a.push(r.reduce(t,e))}}}function jt(t,e,n){const r=Y(t,n),i=Yt(e,r);let o,a;return{label:_(i===Zt?null:r,i.label),initialize(t){o=void 0===r?t:l(t,r),"data"===i.scope&&(a=i.reduce(D(t),o))},scope(t,e){i.scope===t&&(a=i.reduce(e,o))},reduce:(t,e)=>null==i.scope?i.reduce(t,o,e):i.reduce(t,o,a,e)}}function Wt(t,n){return n?e.sort(e.group(t,(t=>n[t])),y):[[,t]]}function Yt(t,n){if(t&&"function"==typeof t.reduce)return t;if("function"==typeof t)return r=t,{reduce:(t,e,n)=>r(j(e,t),n)};var r;if(/^p\d{2}$/i.test(t))return _t(b(t));switch(`${t}`.toLowerCase()){case"first":return Ut;case"last":return Vt;case"count":return Zt;case"distinct":return Kt;case"sum":return null==n?Zt:Qt;case"proportion":return Jt(n,"data");case"proportion-facet":return Jt(n,"facet");case"deviation":return _t(e.deviation);case"min":return _t(e.min);case"min-index":return _t(e.minIndex);case"max":return _t(e.max);case"max-index":return _t(e.maxIndex);case"mean":return Gt(e.mean);case"median":return Gt(e.median);case"variance":return _t(e.variance);case"mode":return _t(e.mode);case"x":return ee;case"x1":return re;case"x2":return ie;case"y":return ne;case"y1":return oe;case"y2":return ae}throw new Error(`invalid reduce: ${t}`)}function It(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function Ft(t,e,n){if(e){const n=e.output.transform(),r=(t,e)=>mt(n[t],n[e]);t.forEach((t=>t.sort(r)))}n&&t.forEach((t=>t.reverse()))}function _t(t){return{reduce:(e,n)=>t(e,(t=>n[t]))}}function Gt(t){return{reduce(e,n){const r=t(e,(t=>n[t]));return Z(n)?new Date(r):r}}}const Xt={reduce:(t,e)=>j(e,t)},Ut={reduce:(t,e)=>e[t[0]]},Ht={reduce(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),v),i=r.slice(-5).reverse();if(i.length<r.length){const t=r.slice(0,-4);i[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,v)]}return i.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},Vt={reduce:(t,e)=>e[t[t.length-1]]},Zt={label:"Frequency",reduce:t=>t.length},Kt={label:"Distinct",reduce:(t,n)=>{const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},Qt=_t(e.sum);function Jt(t,n){return null==t?{scope:n,label:"Frequency",reduce:(t,e,n=1)=>t.length/n}:{scope:n,reduce:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function te(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const ee={reduce:(t,e,{x1:n,x2:r})=>te(n,r)},ne={reduce:(t,e,{y1:n,y2:r})=>te(n,r)},re={reduce:(t,e,{x1:n})=>n},ie={reduce:(t,e,{x2:n})=>n},oe={reduce:(t,e,{y1:n})=>n},ae={reduce:(t,e,{y2:n})=>n};function se(t,{scale:e,type:n,value:r,filter:i,hint:o}){return{scale:e,type:n,value:l(t,r),label:_(r),filter:i,hint:o}}function le(t,e){return Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{let i;return void 0!==n&&(i=e[n]),[t,void 0===i?r:z(r,i)]})))}function ce(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function ue(t,e,n){const r=fe(t,e);return z(fe(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function fe(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function he([t,n],[r,i]){return e.ascending(n,i)||e.ascending(t,r)}function de([t,n],[r,i]){return e.descending(n,i)||e.ascending(t,r)}const pe=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",ge(e.schemeBrBG,e.interpolateBrBG)],["prgn",ge(e.schemePRGn,e.interpolatePRGn)],["piyg",ge(e.schemePiYG,e.interpolatePiYG)],["puor",ge(e.schemePuOr,e.interpolatePuOr)],["rdbu",ge(e.schemeRdBu,e.interpolateRdBu)],["rdgy",ge(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",ge(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",ge(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",ge(e.schemeSpectral,e.interpolateSpectral)],["burd",ye(e.schemeRdBu,e.interpolateRdBu)],["buylrd",ye(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",me(e.schemeBlues,e.interpolateBlues)],["greens",me(e.schemeGreens,e.interpolateGreens)],["greys",me(e.schemeGreys,e.interpolateGreys)],["oranges",me(e.schemeOranges,e.interpolateOranges)],["purples",me(e.schemePurples,e.interpolatePurples)],["reds",me(e.schemeReds,e.interpolateReds)],["turbo",ve(e.interpolateTurbo)],["viridis",ve(e.interpolateViridis)],["magma",ve(e.interpolateMagma)],["inferno",ve(e.interpolateInferno)],["plasma",ve(e.interpolatePlasma)],["cividis",ve(e.interpolateCividis)],["cubehelix",ve(e.interpolateCubehelixDefault)],["warm",ve(e.interpolateWarm)],["cool",ve(e.interpolateCool)],["bugn",me(e.schemeBuGn,e.interpolateBuGn)],["bupu",me(e.schemeBuPu,e.interpolateBuPu)],["gnbu",me(e.schemeGnBu,e.interpolateGnBu)],["orrd",me(e.schemeOrRd,e.interpolateOrRd)],["pubu",me(e.schemePuBu,e.interpolatePuBu)],["pubugn",me(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",me(e.schemePuRd,e.interpolatePuRd)],["rdpu",me(e.schemeRdPu,e.interpolateRdPu)],["ylgn",me(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",me(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",me(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",me(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",xe(e.interpolateRainbow)],["sinebow",xe(e.interpolateSinebow)]]);function me(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function ge(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function ye(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function ve(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function xe(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function we(t){const e=`${t}`.toLowerCase();if(!pe.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return pe.get(e)}function be(t,e){const n=we(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const ke=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function $e(t){const e=`${t}`.toLowerCase();if(!ke.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return ke.get(e)}const Me=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Le(t){return null!=t&&Me.has(`${t}`.toLowerCase())}function Ae(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const ze=Ae((t=>new Intl.NumberFormat(t))),Ee=Ae(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),Re=Ae(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function Ce(t){return n(t,"Invalid Date")}const Oe=function(t="en-US"){const e=function(t="en-US"){const e=ze(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?Ce:"number"==typeof t?e:p)(t)}();let Be=0;function Ne(t){console.warn(t),++Be}const Se="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let Pe=0;function Te(){return"plot-clip-"+ ++Pe}function De(t,{title:e,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:l,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:m,strokeDasharray:g,strokeDashoffset:y,opacity:v,mixBlendMode:x,paintOrder:w,pointerEvents:b,shapeRendering:M},{ariaLabel:L,fill:A="currentColor",fillOpacity:z,stroke:E="none",strokeOpacity:R,strokeWidth:C,strokeLinecap:O,strokeLinejoin:B,strokeMiterlimit:N,paintOrder:S}){null===A&&(s=null,l=null),null===E&&(c=null,f=null),nt(A)?nt(E)||nt(s)||(E="none"):nt(E)&&!nt(c)&&(A="none");const[P,T]=k(s,A),[D,q]=$(l,z),[j,W]=k(c,E),[Y,I]=$(f,R),[F,_]=$(v);rt(W)||(void 0===u&&(u=C),void 0===d&&(d=O),void 0===h&&(h=B),void 0!==m||/^\s*round\s*$/i.test(h)||(m=N),rt(T)||void 0!==w||(w=S));const[G,X]=$(u);return null!==A&&(t.fill=Ze(T,"currentColor"),t.fillOpacity=Ke(q,1)),null!==E&&(t.stroke=Ze(W,"none"),t.strokeWidth=Ke(X,1),t.strokeOpacity=Ke(I,1),t.strokeLinejoin=Ze(h,"miter"),t.strokeLinecap=Ze(d,"butt"),t.strokeMiterlimit=Ke(m,4),t.strokeDasharray=Ze(g,"none"),t.strokeDashoffset=Ze(y,"0")),t.target=p(a),t.ariaLabel=p(L),t.ariaDescription=p(i),t.ariaHidden=p(o),t.opacity=Ke(_,1),t.mixBlendMode=Ze(x,"normal"),t.paintOrder=Ze(w,"normal"),t.pointerEvents=Ze(b,"auto"),t.shapeRendering=Ze(M,"auto"),{title:{value:e,optional:!0},href:{value:n,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:P,scale:"color",optional:!0},fillOpacity:{value:D,scale:"opacity",optional:!0},stroke:{value:j,scale:"color",optional:!0},strokeOpacity:{value:Y,scale:"opacity",optional:!0},strokeWidth:{value:G,optional:!0},opacity:{value:F,scale:"opacity",optional:!0}}}function qe(t,e){e&&t.text((t=>Oe(e[t])))}function je(t,e){e&&t.text((([t])=>Oe(e[t])))}function We(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Ue(t,"aria-label",(t=>n[t])),i&&Ue(t,"fill",(t=>i[t])),o&&Ue(t,"fill-opacity",(t=>o[t])),a&&Ue(t,"stroke",(t=>a[t])),s&&Ue(t,"stroke-opacity",(t=>s[t])),l&&Ue(t,"stroke-width",(t=>l[t])),c&&Ue(t,"opacity",(t=>c[t])),u&&Xe(t,(t=>u[t]),e),function(t,e){e&&t.filter((t=>yt(e[t]))).append("title").call(qe,e)}(t,r)}function Ye(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Ue(t,"aria-label",(([t])=>n[t])),i&&Ue(t,"fill",(([t])=>i[t])),o&&Ue(t,"fill-opacity",(([t])=>o[t])),a&&Ue(t,"stroke",(([t])=>a[t])),s&&Ue(t,"stroke-opacity",(([t])=>s[t])),l&&Ue(t,"stroke-width",(([t])=>l[t])),c&&Ue(t,"opacity",(([t])=>c[t])),u&&Xe(t,(([t])=>u[t]),e),function(t,e){e&&t.filter((([t])=>yt(e[t]))).append("title").call(je,e)}(t,r)}function Ie(t,n,r){const i=e.group(t,(t=>n[t]));return void 0===r&&i.size>t.length>>1&&Ne("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),i.values()}function*Fe(t,e,{z:n},r){const{z:i}=r,o=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:s,href:l}){return[t,e,n,r,i,o,a,s,l].filter((t=>void 0!==t))}(r),a=[...e,...o];for(const e of i?Ie(t,i,n):[t]){let t,n;t:for(const r of e){for(const t of a)if(!pt(t[r])){n&&n.push(-1);continue t}if(void 0!==t){n.push(r);for(let e=0;e<o.length;++e){if(W(o[e][r])!==t[e]){yield n,t=o.map((t=>W(t[r]))),n=[r];continue t}}}else n&&(yield n),t=o.map((t=>W(t[r]))),n=[r]}n&&(yield n)}}function _e(t,n,r,i,o){switch(Ue(t,"aria-label",n.ariaLabel),Ue(t,"aria-description",n.ariaDescription),Ue(t,"aria-hidden",n.ariaHidden),Ue(t,"fill",n.fill),Ue(t,"fill-opacity",n.fillOpacity),Ue(t,"stroke",n.stroke),Ue(t,"stroke-width",n.strokeWidth),Ue(t,"stroke-opacity",n.strokeOpacity),Ue(t,"stroke-linejoin",n.strokeLinejoin),Ue(t,"stroke-linecap",n.strokeLinecap),Ue(t,"stroke-miterlimit",n.strokeMiterlimit),Ue(t,"stroke-dasharray",n.strokeDasharray),Ue(t,"stroke-dashoffset",n.strokeDashoffset),Ue(t,"shape-rendering",n.shapeRendering),Ue(t,"paint-order",n.paintOrder),Ue(t,"pointer-events",n.pointerEvents),n.clip){case"frame":{const{x:e,y:n}=r,{width:o,height:a,marginLeft:s,marginRight:l,marginTop:c,marginBottom:u}=i,f=Te();t.attr("clip-path",`url(#${f})`).append("clipPath").attr("id",f).append("rect").attr("x",s-(e?.bandwidth?e.bandwidth()/2:0)).attr("y",c-(n?.bandwidth?n.bandwidth()/2:0)).attr("width",o-l-s).attr("height",a-c-u);break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=Te();t.attr("clip-path",`url(#${r})`).append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}}function Ge(t,e){He(t,"mix-blend-mode",e.mixBlendMode),Ue(t,"opacity",e.opacity)}function Xe(t,n,r){t.each((function(t){const i=n(t);if(null!=i){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",i),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Ue(t,e,n){null!=n&&t.attr(e,n)}function He(t,e,n){null!=n&&t.style(e,n)}function Ve(t,e,{x:n,y:r},i=Se,o=Se){i+=e.dx,o+=e.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&t.attr("transform",`translate(${i},${o})`)}function Ze(t,e){if((t=p(t))!==e)return t}function Ke(t,e){if((t=m(t))!==e)return t}const Qe=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Je(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!Qe.test(t))throw new Error(`invalid class name: ${t}`);return t}function tn(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function en({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-i:(a+e-i)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-o:(r+n-o)/2]}function nn({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=on(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function rn({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=on(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function on(t,e,n){return void 0===t&&void 0===e&&void 0===n?Se?[1,0]:[.5,.5]:[e,n]}function an(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("function"!=typeof t.floor||"function"!=typeof t.offset)throw new Error("invalid interval; missing floor or offset function");return t}}function sn(t,{interval:e}){return(t={...X(t)}).interval=an(void 0===t.interval?e:t.interval),t}function ln(t,e,n,r){const{[t]:i,[`${t}1`]:o,[`${t}2`]:a}=n,{value:s,interval:c}=sn(i,n);if(null==s||null==c&&!r)return n;const u=_(i);if(null==c){let e;const r={transform:t=>e||(e=l(t,s)),label:u};return{...n,[t]:void 0,[`${t}1`]:void 0===o?r:o,[`${t}2`]:void 0===a?r:a}}let f,h;function d(t){return void 0!==h&&t===f?h:h=z(l(f=t,s),(t=>c.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===o?{transform:d,label:u}:o,[`${t}2`]:void 0===a?{transform:t=>d(t).map((t=>c.offset(t))),label:u}:a})}function cn(t,e,n){const{[t]:r}=n,{value:i,interval:o}=sn(r,n);return null==i||null==o?n:e({...n,[t]:{label:_(r),transform:t=>{const e=z(l(t,i),(t=>o.floor(t))),n=e.map((t=>o.offset(t)));return e.map(Z(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function un(t={}){return ln("x",nn,t,!0)}function fn(t={}){return ln("y",rn,t,!0)}function hn(t={}){return ln("x",nn,t)}function dn(t={}){return ln("y",rn,t)}function pn(t={}){return cn("x",nn,t)}function mn(t={}){return cn("y",rn,t)}const gn=t=>e=>t(1-e),yn=[0,1],vn=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function xn(t){const e=`${t}`.toLowerCase();if(!vn.has(e))throw new Error(`unknown interpolator: ${e}`);return vn.get(e)}function wn(t,n,r,{type:i,nice:o,clamp:a,zero:s,domain:l=Mn(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(dt.get(t)===ct?An(r,l):dt.get(t)===ut?zn(r,l):dt.get(t)===ft?yn:void 0),interpolate:p=(dt.get(t)===lt?null==f&&void 0!==d?e.interpolateRgb:$e(void 0!==f?f:"cyclical"===i?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=an(h),"cyclical"!==i&&"sequential"!==i||(i="linear"),m=!!m,"function"!=typeof p&&(p=xn(p)),1===p.length?(m&&(p=gn(p),m=!1),void 0===d&&2===(d=Float64Array.from(l,((t,e)=>e/(l.length-1)))).length&&(d=yn),n.interpolate((d===yn?x:Cn)(p))):n.interpolate(p),s){const[t,n]=e.extent(l);(t>0||n<0)&&(ot(l=E(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return m&&(l=e.reverse(l)),n.domain(l).unknown(c),o&&(n.nice(!0===o?void 0:o),l=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:i,domain:l,range:d,scale:n,interpolate:p,interval:h}}function bn(t,n,{exponent:r=1,...i}){return wn(t,e.scalePow().exponent(r),n,{...i,type:"pow"})}function kn(t,n,{domain:r=[0],unknown:i,scheme:o="rdylbu",interpolate:a,range:s=(void 0!==a?e.quantize(a,r.length+1):dt.get(t)===lt?be(o,r.length+1):void 0),reverse:l}){const c=ot(A(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const i=e.descending(t,n);return 0===i||i===r}(t,n,c))))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(s=e.reverse(s)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===s?[]:s).unknown(i),domain:r,range:s}}function $n(t,n=vt){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function Mn(t,e){const n=dt.get(t);return(n===ct||n===ft||n===ut?Ln:$n)(e)}function Ln(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,vt))):1]}function An(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const i=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,xt))),o=n.map((t=>3*Math.sqrt(t/i))),a=30/e.max(o);return a<1?o.map((t=>t*a)):o}function zn(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),i=n.map((t=>12*t/r)),o=60/e.max(i);return o<1?i.map((t=>t*o)):i}function En(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return $n(t,xt);if(n<0)return $n(t,wt)}return[1,10]}function Rn(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Cn(t){return(e,n)=>r=>t(e+r*(n-e))}function On(t,n,r,i,{type:o,nice:a,clamp:s,domain:l=$n(i),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(dt.get(t)===lt?null==f&&void 0!==h?e.interpolateRgb:$e(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[g,y]=l;if(e.descending(g,y)<0&&([g,y]=[y,g],m=!m),g=Math.min(g,u),y=Math.max(y,u),"function"!=typeof p&&(p=xn(p)),void 0!==h&&(p=1===p.length?Cn(p)(...h):e.piecewise(p,h)),m&&(p=gn(p)),d){const t=r.apply(u),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,u,y]).unknown(c).interpolator(p),s&&n.clamp(s),a&&n.nice(a),{type:o,domain:[g,y],pivot:u,interpolate:p,scale:n}}function Bn(t,n,{exponent:r=1,...i}){return On(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Tn:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...i,type:"diverging-pow"})}function Nn(t,n,{constant:r=1,...i}){return On(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,i)}const Sn={apply:t=>t,invert:t=>t},Pn={apply:Math.log,invert:Math.exp},Tn={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Dn(t,e,n,r){return wn(t,e,n,r)}const qn=Math.sqrt(3),jn=2/qn,Wn={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*jn,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},Yn=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Wn],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolX],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function In(t){return t&&"function"==typeof t.draw}function Fn(t){return!!In(t)||"string"==typeof t&&Yn.has(t.toLowerCase())}function _n(t){if(null==t||In(t))return t;const e=Yn.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const Gn=Symbol("ordinal");function Xn(t,n,r,{type:i,interval:o,domain:a,range:s,reverse:l,hint:c}){return o=an(o),void 0===a&&(a=Vn(r,o,t)),"categorical"!==i&&i!==Gn||(i="ordinal"),l&&(a=e.reverse(a)),n.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),n.range(s)),{type:i,domain:a,range:s,scale:n,hint:c,interval:o}}function Un(t,n,{type:r,interval:i,domain:o,range:a,scheme:s,unknown:l,...c}){let u;if(i=an(i),void 0===o&&(o=Vn(n,i,t)),dt.get(t)===ht)u=function(t){return{fill:Zn(t,"fill"),stroke:Zn(t,"stroke")}}(n),a=void 0===a?function(t){return nt(t.fill)?e.symbolsStroke:e.symbolsFill}(u):z(a,_n);else if(dt.get(t)===lt&&(void 0!==a||"ordinal"!==r&&r!==Gn||(a=function(t,e="greys"){const n=new Set,[r,i]=be(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(i);else{if(!1!==e)return;n.add(r)}return[...n]}(o,s),void 0!==a&&(s=void 0)),void 0===s&&void 0===a&&(s="ordinal"===r?"turbo":"tableau10"),void 0!==s))if(void 0!==a){const t=$e(s),n=a[0],r=a[1]-a[0];a=({length:i})=>e.quantize((e=>t(n+r*e)),i)}else a=we(s);if(l===e.scaleImplicit)throw new Error("implicit unknown is not supported");return Xn(t,e.scaleOrdinal().unknown(l),n,{...c,type:r,domain:o,range:a,hint:u})}function Hn(t,e,n,r){let{round:i}=n;return void 0!==i&&t.round(i=!!i),(t=Xn(r,t,e,n)).round=i,t}function Vn(t,n,r){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&dt.get(r)===st)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(i,mt)}function Zn(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Kn(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,round:a,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...d}={}){const p={};for(const[e,m]of t){const t=d[e],g=ir(e,m,{round:dt.get(e)===st?a:void 0,nice:s,clamp:l,zero:c,align:u,padding:f,projection:h,...t});if(g){let{percent:a,transform:s,inset:l,insetTop:c=(void 0!==l?l:"y"===e?n:0),insetRight:u=(void 0!==l?l:"x"===e?r:0),insetBottom:f=(void 0!==l?l:"y"===e?i:0),insetLeft:h=(void 0!==l?l:"x"===e?o:0)}=t||{};if(null==s)s=void 0;else if("function"!=typeof s)throw new Error("invalid scale transform; not a function");g.percent=!!a,g.transform=s,"x"===e||"fx"===e?(g.insetLeft=+h,g.insetRight=+u):"y"!==e&&"fy"!==e||(g.insetTop=+c,g.insetBottom=+f),p[e]=g}}return p}function Qn(t){return Object.fromEntries(Object.entries(t).map((([t,{scale:e}])=>[t,e])))}function Jn(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,s=o+n,l=i-a-r;t.range=[s,Math.max(s,l)],cr(t)||(t.range=nr(t)),t.scale.range(t.range)}er(t)}function tr(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,s=o+n,l=i-a-r;t.range=[Math.max(s,l),s],cr(t)?t.range.reverse():t.range=nr(t),t.scale.range(t.range)}er(t)}function er(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),i=t.paddingInner?t.paddingInner():1,o=t.paddingOuter?t.paddingOuter():t.padding(),a=e-i,s=Math.abs(r-n)/Math.max(1,a+2*o);return(s-Math.floor(s))*a}(t)<=30&&t.scale.round(!0)}function nr(t){const e=t.scale.domain().length+ur(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,i)=>n+i/(e-1)*(r-n)))}function rr(t,e,n){return ir(t,void 0===n?void 0:[{hint:n}],{...e})}function ir(t,n=[],r={}){const i=function(t,e,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:s}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==s||(n=ar);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===ar)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const l=dt.get(t);if(l===lt&&void 0===i&&void 0===o&&lr(r,e,et))return"identity";if(l===ht&&void 0===i&&lr(r,e,Fn))return"identity";if(l===ct)return"sqrt";if(l===ft||l===ut)return"linear";if(l===ht)return"ordinal";if((r||i||[]).length>2)return sr(l);if(void 0!==r)return V(r)?sr(l):Z(r)?"utc":l!==lt||null==a&&!Le(o)?"linear":"diverging";const c=e.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(V)?sr(l):c.some(Z)?"utc":l!==lt||null==a&&!Le(o)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&cr({type:i})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Z)?Ne(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${or(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${or(i)}".`):e.some(K)?Ne(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${or(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${or(i)}".`):e.some(Q)&&Ne(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${or(i)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${or(i)}".`)}switch(r.type=i,i){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=dr(n,r,gr);break;case"identity":switch(dt.get(t)){case st:r=dr(n,r,gr);break;case ht:r=dr(n,r,pr)}break;case"utc":case"time":r=dr(n,r,mr)}switch(i){case"diverging":return function(t,n,r){return On(t,e.scaleDiverging(),Sn,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Bn(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Bn(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:i=1,domain:o=$n(n,i<0?wt:xt),...a}){return On(t,e.scaleDivergingLog().base(r=+r),Pn,n,{domain:o,pivot:i,...a})}(t,n,r);case"diverging-symlog":return Nn(t,n,r);case"categorical":case"ordinal":case Gn:return Un(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return wn(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return bn(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return kn(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:i=(void 0===r?5:(r=[...r]).length),n:o=i,scheme:a="rdylbu",domain:s=Rn(n),interpolate:l,reverse:c}){return void 0===r&&(r=void 0!==l?e.quantize(l,o):dt.get(t)===lt?be(a,o):void 0),kn(t,0,{domain:e.scaleQuantile(s,void 0===r?{length:o}:r).quantiles(),range:r,reverse:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:i=(void 0===r?5:(r=[...r]).length),scheme:o="rdylbu",domain:a=Mn(t,n),unknown:s,interpolate:l,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,i),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),i=h.length+1,r=void 0!==l?e.quantize(l,i):dt.get(t)===lt?be(o,i):void 0):(h=e.quantize(e.interpolateNumber(u,f),i+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),ot(A(a))<0&&h.reverse(),kn(t,0,{domain:h,range:r,reverse:c,unknown:s})}(t,n,r);case"pow":return bn(t,n,r);case"log":return function(t,n,{base:r=10,domain:i=En(n),...o}){return wn(t,e.scaleLog().base(r),n,{...o,domain:i})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...i}){return wn(t,e.scaleSymlog().constant(r),n,i)}(t,n,r);case"utc":return function(t,n,r){return Dn(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Dn(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:i=.5,...o}){return Hn(e.scalePoint().align(r).padding(i),n,o,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:i=.1,paddingInner:o=i,paddingOuter:a=("fx"===t||"fy"===t?0:i),...s}){return Hn(e.scaleBand().align(r).paddingInner(o).paddingOuter(a),n,s,t)}(t,n,r);case"identity":return dt.get(t)===st?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${i}`)}}function or(t){return"symbol"==typeof t?t.description:t}const ar={toString:()=>"projection"};function sr(t){switch(t){case st:return"point";case lt:return Gn;default:return"ordinal"}}function lr(t,e,n){return void 0!==t?J(t,n)&&tt(t,n):e.some((({value:t})=>void 0!==t&&J(t,n)))&&e.every((({value:t})=>void 0===t||tt(t,n)))}function cr({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Gn}function ur({type:t}){return"threshold"===t}function fr({range:t,domain:e=t}){return Math.sign(ot(e))*Math.sign(ot(t))}function hr(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function dr(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function pr(t){return z(t,_n)}function mr(t){return z(t,vr)}function gr(t){return R(t)?t:z(t,yr,Float64Array)}function yr(t){return null==t?NaN:+t}function vr(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?o(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function xr({scale:t,type:e,domain:n,range:r,label:i,interpolate:o,interval:a,transform:s,percent:l,pivot:c}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const u=t.unknown?t.unknown():void 0;return{type:e,domain:E(n),...void 0!==r&&{range:E(r)},...void 0!==s&&{transform:s},...l&&{percent:l},...void 0!==i&&{label:i},...void 0!==u&&{unknown:u},...void 0!==a&&{interval:a},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==c&&{pivot:c,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}const wr=Math.PI,br=2*wr,kr=.618;function $r({projection:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n}={},s){if(null==t)return;if("function"==typeof t.stream)return t;let l,c,u="frame";if(C(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:i=(void 0!==e?e:i),insetBottom:o=(void 0!==e?e:o),insetLeft:a=(void 0!==e?e:a),clip:u=u,...l}=t),null==t)return}"function"!=typeof t&&({type:t}=Mr(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:g}=s,y=f-d-p-a-i,v=h-m-g-r-o;if(t=t?.({width:y,height:v,clip:u,...l}),null==t)return;u=function(t,n,r,i,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,i,o);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-g);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[i,o]]=e.geoPath(t).bounds(c),a=Math.min(y/(i-n),v/(o-r));a>0?(w-=(a*(n+i)-y)/2,b-=(a*(r+o)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):Ne("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?zr():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function Mr(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Lr(e.geoAlbersUsa,.7463,.4673);case"albers":return Ar(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return Lr(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return Lr(e.geoAzimuthalEquidistant,br,br);case"conic-conformal":return Ar(e.geoConicConformal,br,br);case"conic-equal-area":return Ar(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return Ar(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return Lr(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return Lr(e.geoEquirectangular,br,wr);case"gnomonic":return Lr(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:zr};case"reflect-y":return{type:Er};case"mercator":return Lr(e.geoMercator,br,br);case"orthographic":return Lr(e.geoOrthographic,2,2);case"stereographic":return Lr(e.geoStereographic,2,2);case"transverse-mercator":return Lr(e.geoTransverseMercator,br,br);default:throw new Error(`unknown projection type: ${t}`)}}function Lr(t,e,n){return{type:({width:r,height:i,rotate:o,precision:a=.15,clip:s})=>{const l=t();return null!=a&&l.precision?.(a),null!=o&&l.rotate?.(o),"number"==typeof s&&l.clipAngle?.(s),l.scale(Math.min(r/e,i/n)),l.translate([r/2,i/2]),l},aspectRatio:n/e}}function Ar(t,e,n){const{type:r,aspectRatio:i}=Lr(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:i,height:o}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([i,o],{type:"Sphere"})),a},aspectRatio:i}}const zr=x({stream:t=>t}),Er=x(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function Rr(t,e,n,r,i){const o=n[t]&&"x"===n[t].scale,a=n[e]&&"y"===n[e].scale;if(o&&a)!function(t,e,n,r){const i=n[t],o=n[e],a=i.length,s=n[t]=new Float64Array(a).fill(NaN),l=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){s[c]=t,l[c]=e}});for(c=0;c<a;++c)u.point(i[c],o[c])}(t,e,r,i.projection);else{if(o)throw new Error(`projection requires paired x and y channels; ${t} is missing ${e}`);if(a)throw new Error(`projection requires paired x and y channels; ${e} is missing ${t}`)}}function Cr(t,e,n){const r=le({...t.x&&{x:t.x},...t.y&&{y:t.y}},e);return n.projection&&Rr("x","y",t,r,n),r.x&&(r.x=gr(r.x)),r.y&&(r.y=gr(r.y)),r}function Or(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:$r(t,e)}}function Br(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const Nr=Math.PI/180;class Sr{constructor({name:t="x",axis:e,ticks:n,tickSize:r=("fx"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:y}={}){this.name=t,this.axis=L(e,"axis",["top","bottom"]),this.ticks=Dr(n),this.tickSize=m(r),this.tickPadding=m(i),this.tickFormat=qr(o),this.fontVariant=Ze(a,"normal"),this.grid=g(s),this.label=p(l),this.labelAnchor=M(c,"labelAnchor",["center","left","right"]),this.labelOffset=m(u),this.line=g(f),this.tickRotate=m(h),this.ariaLabel=p(d),this.ariaDescription=p(y)}render(t,{[this.name]:n,fy:r},{width:i,height:o,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetLeft:u=0,facetMarginTop:f,facetMarginBottom:h,labelMarginLeft:d=0,labelMarginRight:p=0},m){const{axis:g,fontVariant:y,grid:v,label:x,labelAnchor:w,labelOffset:b,line:k,name:$,tickRotate:M}=this,L="top"===g?-1:1,A=L*("x"===$?0:"top"===g?a-f:l-h)+("top"===g?a:o-l);return Br("svg:g",m).call(Tr,this).attr("transform",`translate(${u},${A})`).call(Wr("top"===g?e.axisTop:e.axisBottom,n,this)).call(Yr,M).attr("font-size",null).attr("font-family",null).attr("font-variant",y).call(k?()=>{}:t=>t.select(".domain").remove()).call(v?r?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?j(i,t):i).map((t=>`M0,${e(t)+n}v${r}`)).join(""))}(t,r,-A):(z=L*(l+a-o),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("y2",z)):()=>{}).call(x?t=>t.append("text").attr("fill","currentColor").attr("transform",`translate(${"center"===w?(i+c-s)/2:"right"===w?i+p:-d},${b*L})`).attr("dy","top"===g?"1em":"-0.32em").attr("text-anchor","center"===w?"middle":"right"===w?"end":"start").text(x):()=>{}).node();var z}}class Pr{constructor({name:t="y",axis:e,ticks:n,tickSize:r=("fy"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:y}={}){this.name=t,this.axis=L(e,"axis",["left","right"]),this.ticks=Dr(n),this.tickSize=m(r),this.tickPadding=m(i),this.tickFormat=qr(o),this.fontVariant=Ze(a,"normal"),this.grid=g(s),this.label=p(l),this.labelAnchor=M(c,"labelAnchor",["center","top","bottom"]),this.labelOffset=m(u),this.line=g(f),this.tickRotate=m(h),this.ariaLabel=p(d),this.ariaDescription=p(y)}render(t,{[this.name]:n,fx:r},{width:i,height:o,marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,offsetTop:u=0,facetMarginLeft:f,facetMarginRight:h},d){const{axis:p,fontVariant:m,grid:g,label:y,labelAnchor:v,labelOffset:x,line:w,name:b,tickRotate:k}=this,$="left"===p?-1:1,M=$*("y"===b?0:"left"===p?c-f:s-h)+("right"===p?i-s:c);return Br("svg:g",d).call(Tr,this).attr("transform",`translate(${M},${u})`).call(Wr("right"===p?e.axisRight:e.axisLeft,n,this)).call(Yr,k).attr("font-size",null).attr("font-family",null).attr("font-variant",m).call(w?()=>{}:t=>t.select(".domain").remove()).call(g?r?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?j(i,t):i).map((t=>`M${e(t)+n},0h${r}`)).join(""))}(t,r,-M):(L=$*(c+s-i),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("x2",L)):()=>{}).call(y?t=>t.append("text").attr("fill","currentColor").attr("font-variant",null==m?null:"normal").attr("transform",`translate(${x*$},${"center"===v?(o+a-l)/2:"bottom"===v?o-l:a})${"center"===v?" rotate(-90)":""}`).attr("dy","center"===v?"right"===p?"-0.32em":"0.75em":"bottom"===v?"1.4em":"-1em").attr("text-anchor","center"===v?"middle":"right"===p?"end":"start").text(y):()=>{}).node();var L}}function Tr(t,{name:e,label:n,ariaLabel:r=`${e}-axis`,ariaDescription:i=n}){Ue(t,"aria-label",r),Ue(t,"aria-description",i)}function Dr(t){return null===t?[]:t}function qr(t){return null===t?()=>null:t}function jr(t,n){return void 0===t?Z(n)?Ce:p:"function"==typeof t?t:("string"==typeof t?Z(n)?e.utcFormat:e.format:x)(t)}function Wr(t,e,{ticks:n,tickSize:r,tickPadding:i,tickFormat:o}){return e.tickFormat||(o=jr(o,e.domain())),t(e).ticks(Array.isArray(n)?null:n,"function"==typeof o?null:o).tickFormat("function"==typeof o?o:null).tickSizeInner(r).tickSizeOuter(0).tickPadding(i).tickValues(Array.isArray(n)?n:null)}function Yr(t,e){if(e=+e)for(const n of t.selectAll("text")){const t=+n.getAttribute("x"),r=+n.getAttribute("y");if(Math.abs(r)>Math.abs(t)){const t=Math.sign(r);n.setAttribute("transform",`translate(0, ${r+4*t*Math.cos(e*Nr)}) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)<10?"middle":e<0^t>0?"start":"end")}else{const r=Math.sign(t);n.setAttribute("transform",`translate(${t+4*r*Math.abs(Math.sin(e*Nr))}, 0) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)>60?"middle":r>0?"start":"end")}n.removeAttribute("x"),n.removeAttribute("y"),n.setAttribute("dy","0.32em")}}function Ir(t,n,r){if(void 0===n.ticks){const i=t.interval;if(void 0!==i){const[r,o]=e.extent(t.scale.domain());n.ticks=i.range(i.floor(r),i.offset(i.floor(o)))}else{const[i,o]=e.extent(t.scale.range());n.ticks=(o-i)/r}}void 0===n.tickFormat&&cr(t)&&(n.tickFormat=Oe)}function Fr(t,e,n){void 0===t.labelAnchor&&(t.labelAnchor=cr(e)?"center":fr(e)<0?"left":"right"),void 0===t.label&&(t.label=Xr(n,e,t,"x")),e.label=t.label}function _r(t,e,n,r){void 0===t.labelAnchor&&(t.labelAnchor=cr(n)?"center":e&&"top"===e.axis?"bottom":"top"),void 0===t.label&&(t.label=Xr(r,n,t,"y")),n.label=t.label}function Gr(t,e,n,r){r&&(e.label=r.label),void 0===e.label&&(e.label=Xr(n,e,null,t))}function Xr(t=[],e,n,r){let i;for(const{label:e}of t)if(void 0!==e)if(void 0===i)i=e;else if(i!==e)return;if(void 0!==i){if(function({type:t}){return"time"===t||"utc"===t}(e)&&/^(date|time|year)$/i.test(i))return;if(!cr(e)&&(e.percent&&(i=`${i} (%)`),"x"===r||"y"===r)){const t=fr(e);t&&(i="x"===r||n&&"center"===n.labelAnchor?"x"===r==t<0?`← ${i}`:`${i} →`:`${t<0?"↑ ":"↓ "}${i}`)}}return i}function Ur(t){return cr(t)&&void 0===t.interval?void 0:"tabular-nums"}function Hr({y:t,fy:e,fx:n},r,{projection:i},{width:o,marginTopDefault:a,marginBottomDefault:s,marginRightDefault:l,marginLeftDefault:c}){const u=e?e.scale.domain().length:1,f=function(t,e){if("function"==typeof t?.stream)return kr;if(C(t)&&(t=t.type),null==t)return e?kr:void 0;if("function"!=typeof t){const{aspectRatio:e}=Mr(t);if(e)return e}return kr}(i,r);if(f){const t=(1.1*u-.1)/(1.1*(n?n.scale.domain().length:1)-.1)*f,e=Math.max(.1,Math.min(10,t));return Math.round((o-c-l)*e+a+s)}const h=t?cr(t)?t.scale.domain().length:Math.max(7,17/u):1;return!(!t&&!e)*Math.max(1,Math.min(60,h*u))*20+30*!!n+60}function Vr(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Zr(t,e={},n,r){let{columns:i,tickFormat:o,fontVariant:a=Ur(t),swatchSize:s=15,swatchWidth:l=s,swatchHeight:c=s,marginLeft:u=0,className:f,style:h,width:d}=e;const p=Or(e);f=Je(f),o=jr(o,t.domain);const m=Br("div",p).attr("class",f).attr("style",`\n        --swatchWidth: ${+l}px;\n        --swatchHeight: ${+c}px;\n      `);let g;return null!=i?(g=`\n      .${f}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${f}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${f}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,m.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(n,t).call((t=>t.append("div").attr("class",`${f}-label`).attr("title",o).text(o)))):(g=`\n      .${f} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${f}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(n,t).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`\n        .${f} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===u?"":`\n          margin-left: ${+u}px;`}${void 0===d?"":`\n          width: ${d}px;`}\n        }\n        ${r(f)}\n        ${g}\n      `))).style("font-variant",Ze(a,"normal")).call(tn,h).node()}const Kr=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:i=(void 0!==t.hint?.stroke?t.hint.stroke:nt(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:a=1.5,r:s=4.5,...l}={},c){const[u,f]=k(n),[h,d]=k(i),p=Vr(c,u),m=Vr(c,h),g=s*s*Math.PI;return r=$(r)[1],o=$(o)[1],a=$(a)[1],Zr(t,l,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===u?t=>p.scale(t):null).attr("stroke","color"===h?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.path();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${o};\n      }`))}],["color",Jr],["opacity",function({type:t,interpolate:n,...r},{legend:i=!0,color:o=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===i&&(i="ramp");if("ramp"!==`${i}`.toLowerCase())throw new Error(`${i} opacity legends are not supported`);return Jr({type:t,...r,interpolate:ti(o)},{legend:i,...a})}]]);function Qr(t,{label:e,ticks:n,tickFormat:r}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const i=r[e];n===t?n={...n,[e]:i}:n[e]=i}return n}(i,t,{label:e,ticks:n,tickFormat:r})}function Jr(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!cr(t)&&!ur(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Zr(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:i=6,width:o=240,height:a=44+i,marginTop:s=18,marginRight:l=0,marginBottom:c=16+i,marginLeft:u=0,style:f,ticks:h=(o-u-l)/64,tickFormat:d,fontVariant:p=Ur(t),round:m=!0,className:g}=n;const y=Or(n);g=Je(g),null===d&&(d=()=>null);const v=Br("svg",y).attr("class",g).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",a).attr("viewBox",`0 0 ${o} ${a}`).call((t=>t.append("style").text(`\n        .${g} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${g} text {\n          white-space: pre;\n        }\n      `))).call(tn,f);let x,w=t=>t.selectAll(".tick line").attr("y1",s+c-a);const b=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:k,domain:$,range:M,interpolate:L,scale:A,pivot:E}=t;if(L){const t=void 0===M?L:e.piecewise(1===L.length?Cn(L):L,M);x=b(A.copy(),e.quantize(e.interpolateNumber(u,o-l),Math.min($.length+(void 0!==E),void 0===M?1/0:M.length)));const n=256,r=y.document.createElement("canvas");r.width=n,r.height=1;const i=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)i.fillStyle=t(e/r),i.fillRect(e,0,1,1);v.append("image").attr("x",u).attr("y",s).attr("width",o-u-l).attr("height",a-s-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===k){const t=$,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;x=b(e.scaleLinear().domain([-1,M.length-1]),[u,o-l]),v.append("g").selectAll().data(M).enter().append("rect").attr("x",((t,e)=>x(e-1))).attr("y",s).attr("width",((t,e)=>x(e)-x(e-1))).attr("height",a-s-c).attr("fill",(t=>t)),h=z(t,((t,e)=>e)),d=e=>n(t[e],e)}else x=b(e.scaleBand().domain($),[u,o-l]),v.append("g").selectAll().data($).enter().append("rect").attr("x",x).attr("y",s).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",a-s-c).attr("fill",A),w=()=>{};return v.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(x).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(i).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Ze(p,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&v.append("text").attr("x",u).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(r),v.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function ti(t){const{r:n,g:r,b:i}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${i},${t})`}const ei=Symbol("selection");function ni(t={}){const{facet:n,style:r,caption:i,ariaLabel:o,ariaDescription:a}=t,s=Je(t.className),l=void 0===t.marks?[]:t.marks.flat(1/0).map(oi),c=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const i=A(t.data);if(null==i)throw new Error("missing facet data");const o={};null!=n&&(o.fx=se(i,{value:n,scale:"fx"}));null!=r&&(o.fy=se(i,{value:r,scale:"fy"}));li(o,e);const a=hi(i,o),s=a.size>1||o.fx&&o.fy&&1===a.size&&[...a][0][1].size>1?i.length:void 0;return{channels:o,groups:a,data:t.data,dataLength:s}}(n,t),u=new Map;for(const e of l){const n=mi(e,c,t);n&&u.set(e,n)}const f=new Map;c&&ui(f,[c]),ui(f,u);let h=function(t,n){const{fx:r,fy:i}=Kn(t,n),o=r?.scale.domain(),a=i?.scale.domain();return o&&a?e.cross(o,a).map((([t,e])=>({x:t,y:e}))):o?o.map((t=>({x:t}))):a?a.map((t=>({y:t}))):void 0}(f,t);if(void 0!==h){const t=c?gi(h,c):void 0;for(const e of l){if(null===e.facet)continue;const n=u.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?gi(h,n):t)}const e=new Set;for(const{facetsIndex:t}of u.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));if(0<e.size&&e.size<h.length){h=h.filter(((t,n)=>e.has(n)));for(const t of u.values()){const{facetsIndex:n}=t;n&&(t.facetsIndex=n.filter(((t,n)=>e.has(n))))}}for(const t of l)if("exclude"===t.facet){const e=u.get(t);e.facetsIndex=pi(e.facetsIndex)}}for(const e of dt.keys())O(t[e])&&"fx"!==e&&"fy"!==e&&f.set(e,[]);const d=new Map;for(const e of l){if(d.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=u.get(e)||{},{data:i,facets:o,channels:a}=e.initialize(n,r);li(a,t),d.set(e,{data:i,facets:o,channels:a})}const p=Kn(ui(f,d),t),m=Qn(p),g=function({x:t,y:e,fx:n,fy:r},{x:i={},y:o={},fx:a={},fy:s={},axis:l=!0,grid:c,line:u,label:f,facet:{axis:h=l,grid:d,label:p=f}={}}={}){let{axis:m=l}=i,{axis:g=l}=o,{axis:y=h}=a,{axis:v=h}=s;return t?!0===m&&(m="bottom"):m=null,e?!0===g&&(g="left"):g=null,n?!0===y&&(y="bottom"===m?"top":"bottom"):y=null,r?!0===v&&(v="left"===g?"right":"left"):v=null,{...m&&{x:new Sr({grid:c,line:u,label:f,fontVariant:Ur(t),...i,axis:m})},...g&&{y:new Pr({grid:c,line:u,label:f,fontVariant:Ur(e),...o,axis:g})},...y&&{fx:new Sr({name:"fx",grid:d,label:p,fontVariant:Ur(n),...a,axis:y})},...v&&{fy:new Pr({name:"fy",grid:d,label:p,fontVariant:Ur(r),...s,axis:v})}}}(p,t),y=function(t,e,n,r={}){const{x:{axis:i}={},y:{axis:o}={},fx:{axis:a}={},fy:{axis:s}={}}=n;let{facet:{margin:l,marginTop:c=(void 0!==l?l:"top"===a?30:0),marginRight:u=(void 0!==l?l:"right"===s?40:0),marginBottom:f=(void 0!==l?l:"bottom"===a?30:0),marginLeft:h=(void 0!==l?l:"left"===s?40:0)}={}}=r;c=+c,u=+u,f=+f,h=+h;const d=Math.max(("top"===i?30:0)+c,o||s?20:.5-Se),p=Math.max(("bottom"===i?30:0)+f,o||s?20:.5+Se),m=Math.max(("right"===o?40:0)+u,i||a?20:.5+Se),g=Math.max(("left"===o?40:0)+h,i||a?20:.5-Se);let{margin:y,marginTop:v=(void 0!==y?y:d),marginRight:x=(void 0!==y?y:m),marginBottom:w=(void 0!==y?y:p),marginLeft:b=(void 0!==y?y:g)}=r;v=+v,x=+x,w=+w,b=+b;let{width:k=640,height:$=Hr(t,e,r,{width:k,marginTopDefault:d,marginBottomDefault:p,marginRightDefault:m,marginLeftDefault:g})+Math.max(0,v-d+w-p)}=r;return k=+k,$=+$,{width:k,height:$,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,facetMarginTop:c,facetMarginRight:u,facetMarginBottom:f,facetMarginLeft:h}}(p,function(t){for(const{channels:e}of t.values())if(e.geometry)return!0;return!1}(d),g,t);!function({x:t,y:e,fx:n,fy:r},i){n&&Jn(n,i),r&&tr(r,i),t&&Jn(t,n?{width:n.scale.bandwidth()}:i),e&&tr(e,r?{height:r.scale.bandwidth()}:i)}(p,y),function({x:t,y:e,fx:n,fy:r},{x:i,y:o,fx:a,fy:s}){a&&Ir(n,a,80),s&&Ir(r,s,35),i&&Ir(t,i,80),o&&Ir(e,o,35)}(p,g);const{fx:v,fy:x}=m,w=x&&{marginTop:0,marginBottom:0,height:x.bandwidth()},b=v&&{marginRight:0,marginLeft:0,width:v.bandwidth()},k={...y,...b,...w},$=Or(t,k),M=new Set;for(const[e,n]of d)if(null!=e.initializer){const{facets:r,channels:i}=e.initializer(n.data,n.facets,n.channels,m,k,$);if(void 0!==r&&(n.facets=r),void 0!==i){ci(i),li(i,t),Object.assign(n.channels,i);for(const{scale:t}of Object.values(i))null!=t&&M.add(t)}}if(M.size){for(const t of M)if(dt.get(t)===st)throw new Error(`initializers cannot declare position scales: ${t}`);const e=Kn(ui(new Map,d,(t=>M.has(t))),t),n=Qn(e);Object.assign(p,e),Object.assign(m,n)}!function(t,e,{x:n,y:r,fx:i,fy:o},a,s){if(i&&(Fr(i,e.fx,t.get("fx")),void 0===i.labelOffset)){const{facetMarginTop:t,facetMarginBottom:e}=a;i.labelOffset="top"===i.axis?t:e}if(o&&(_r(o,i,e.fy,t.get("fy")),void 0===o.labelOffset)){const{facetMarginLeft:t,facetMarginRight:e}=a;o.labelOffset="left"===o.axis?t:e}if(n&&(Fr(n,e.x,t.get("x")),void 0===n.labelOffset)){const{marginTop:t,marginBottom:e,facetMarginTop:r,facetMarginBottom:i}=a;n.labelOffset="top"===n.axis?t-r:e-i}if(r&&(_r(r,n,e.y,t.get("y")),void 0===r.labelOffset)){const{marginRight:t,marginLeft:e,facetMarginLeft:n,facetMarginRight:i}=a;r.labelOffset="left"===r.axis?e-n:t-i}for(const[n,r]of dt)r!==st&&e[n]&&Gr(n,e[n],t.get(n),s[n])}(f,p,g,y,t);for(const t of d.values())t.values=le(t.channels,m);if($.projection)for(const[t,e]of d)t.project(e.channels,e.values,$);const{width:L,height:z}=y,E=Br("svg",$).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",L).attr("height",z).attr("viewBox",`0 0 ${L} ${z}`).attr("aria-label",o).attr("aria-description",a).call((t=>t.append("style").text(`\n        .${s} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${s} text,\n        .${s} tspan {\n          white-space: pre;\n        }\n      `))).call(tn,r).node(),R=g[void 0!==h&&x?"fy":"y"],C=g[void 0!==h&&v?"fx":"x"];R&&E.appendChild(R.render(null,m,y,$)),C&&E.appendChild(C.render(null,m,y,$));let B=[];if(void 0!==h){const t=v?.domain(),n=x?.domain(),r=e.select(E),i=v&&x&&(g.x||g.y)?e.group(h,(({x:t})=>t),(({y:t})=>t)):void 0;if(x&&g.y){const e=g.y,o=fi(e),a="bottom"===e.labelAnchor?n.length-1:"center"===e.labelAnchor?n.length>>1:0;r.selectAll().data(n).enter().append(((n,r)=>(r===a?e:o).render(v&&q(t,(t=>i.get(t).has(n))),m,{...y,...w,offsetTop:x(n)},$)))}if(v&&g.x){const e=g.x,o=fi(e),a="right"===e.labelAnchor?t.length-1:"center"===e.labelAnchor?t.length>>1:0,{marginLeft:s,marginRight:l}=y;r.selectAll().data(t).enter().append(((t,r)=>(r===a?e:o).render(x&&q(n,(e=>i.get(t).has(e))),m,{...y,...b,labelMarginLeft:s,labelMarginRight:l,offsetLeft:v(t)},$)))}const o=new Map(h.map(((t,e)=>[t,e])));r.selectAll().data(function(t,n,r){const i=n&&new e.InternMap(n.domain().map(((t,e)=>[t,e]))),o=r&&new e.InternMap(r.domain().map(((t,e)=>[t,e])));return e.sort(t,((t,e)=>i&&i.get(t.x)-i.get(e.x)||o&&o.get(t.y)-o.get(e.y)))}(h,v,x)).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e){return t&&e?({x:n,y:r})=>`translate(${t(n)},${e(r)})`:t?({x:e})=>`translate(${t(e)},0)`:({y:t})=>`translate(0,${e(t)})`}(v,x)).each((function(t){for(const[e,{channels:n,values:r,facets:i}]of d){let a=null;if(i){if(a=i[o.get(t)]??i[0],!a)continue;a=e.filter(a,n,r)}const s=e.render(a,m,r,k,$);null!=s&&this.appendChild(s)}}))}else for(const[t,{channels:e,values:n,facets:r}]of d){let i=null;if(r){if(i=r[0],!i)continue;i=t.filter(i,e,n)}const o=t.render(i,m,n,y,$);null!=o&&(E.appendChild(o),void 0!==o[ei]&&(B=ai(t,o[ei]),o.addEventListener("input",(()=>{N.value=ai(t,o[ei])}))))}let N=E;const S=function(t,e,n){const r=[];for(const[i,o]of Kr){const a=n[i];if(a?.legend&&i in t){const n=o(t[i],Qr(e,t[i],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(p,$,t);if(null!=i||S.length>0){const{document:t}=$;N=t.createElement("figure"),N.style.maxWidth="initial";for(const t of S)N.appendChild(t);if(N.appendChild(E),null!=i){const e=t.createElement("figcaption");e.appendChild(i instanceof Node?i:t.createTextNode(i)),N.appendChild(e)}}N.scale=function(t){return e=>{if(!dt.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?xr(t[e]):void 0}}(p),N.legend=function(t,e,n={}){return(r,i)=>{if(!Kr.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Kr.get(r)(t[r],Qr(e,n[r],i),(e=>t[e]))}}(p,$,t),N.value=B;const P=function(){const t=Be;return Be=0,t}();return P>0&&e.select(E).append("text").attr("x",L).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${P.toLocaleString("en-US")} warning${1===P?"":"s"}. Please check the console.`),N}class ri{constructor(t,e={},n={},r){const{facet:i="auto",fx:o,fy:a,sort:s,dx:l,dy:c,clip:u,channels:f}=n;this.data=t,this.sort=N(s)?s:null,this.initializer=kt(n).initializer,this.transform=this.initializer?n.transform:bt(n).transform,null===i||!1===i?this.facet=null:(this.facet=L(!0===i?"include":i,"facet",["auto","include","exclude"]),this.fx=o,this.fy=a),e=at(e),void 0!==f&&(e={...at(f),...e}),void 0!==r&&(e={...De(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+l||0,this.dy=+c||0,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),M(t,"clip",["frame","sphere"])}(u)}initialize(t,n){let r=A(this.data);void 0===t&&null!=r&&(t=[D(r)]),null!=this.transform&&(({facets:t,data:r}=this.transform(r,t)),r=A(r));const i=function(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,se(e,n)])))}(this.channels,r);return null!=this.sort&&function(t,n,r,i){const{reverse:o,reduce:a=!0,limit:s}=i;for(const l in i){if(!dt.has(l))continue;let{value:c,reverse:u=o,reduce:f=a,limit:h=s}=X(i[l]);if(void 0===u&&(u="width"===c||"height"===c),null==f||!1===f)continue;const d=ce(t,l)||n&&ce(n,l);if(!d)throw new Error(`missing channel for scale: ${l}`);const p=d.value,[m=0,g=1/0]=U(h)?h:h<0?[h]:[0,h];if(null==c)d.domain=()=>{let t=p;return u&&(t=t.slice().reverse()),0===m&&g===1/0||(t=t.slice(m,g)),t};else{const n="data"===c?r:"height"===c?ue(t,"y1","y2"):"width"===c?ue(t,"x1","x2"):fe(t,c,"y"===c?"y2":"x"===c?"x2":void 0),i=Yt(!0===f?"max":f,n);d.domain=()=>{let t=e.rollup(D(p),(t=>i.reduce(t,n)),(t=>p[t]));return t=e.sort(t,u?de:he),0===m&&g===1/0||(t=t.slice(m,g)),t.map(y)}}}}(i,n,r,this.sort),{data:r,facets:t,channels:i}}filter(t,e,n){for(const r in e){const{filter:i=pt}=e[r];if(null!==i){const e=n[r];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){Rr("x","y",t,e,n),Rr("x1","y1",t,e,n),Rr("x2","y2",t,e,n)}plot({marks:t=[],...e}={}){return ni({...e,marks:[...t,this]})}}function ii(...t){return t.plot=ri.prototype.plot,t}function oi(t){return"function"==typeof t?.render?t:new si(t)}function ai(t,e){return null===e?t.data:j(t.data,e)}class si extends ri{constructor(t){if(super(),null!=t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");this.render=t}}render(){}}function li(t,e){for(const n in t){const r=t[n],{scale:i}=r;if(null!=i){const{percent:t,interval:n,transform:o=(t?t=>100*t:an(n)?.floor)}=e[i]||{};null!=o&&(r.value=z(r.value,o))}}return t}function ci(t){for(const e in t){const n=t[e];let{scale:r}=n;if(!0===r){switch(e){case"fill":case"stroke":r="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":r="opacity";break;default:r=dt.has(e)?e:null}n.scale=r}}}function ui(t,e,n=d){for(const{channels:r}of e.values())for(const e in r){const i=r[e],{scale:o}=i;if(null!=o&&n(o)){const e=t.get(o);void 0!==e?e.push(i):t.set(o,[i])}}return t}function fi(t){return void 0===t||void 0===t.label?t:Object.assign(Object.create(t),{label:void 0})}function hi(t,{fx:n,fy:r}){const i=D(t);return n&&r?function(t,{value:n},{value:r}){return e.group(t,(t=>n[t]),(t=>r[t]))}(i,n,r):di(i,n||r)}function di(t,{value:n}){return e.group(t,(t=>n[t]))}function pi(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let i=0;for(const n of t)e!==n&&(r.set(n,i),i+=n.length);n.push(r.slice(0,i))}return n}function mi(t,e,n){if(null===t.facet)return;const{fx:r,fy:i}=t;if(null!=r||null!=i){const e=A(t.data);if(null==e)throw new Error(`missing facet data in ${t.ariaLabel}`);const o={};return null!=r&&(o.fx=se(e,{value:r,scale:"fx"})),null!=i&&(o.fy=se(e,{value:i,scale:"fy"})),li(o,n),{channels:o,groups:hi(e,o)}}if(void 0===e)return;const{channels:o,groups:a,data:s,dataLength:l}=e;if("auto"!==t.facet||t.data===s)return{channels:o,groups:a};void 0!==l&&A(t.data)?.length===l&&Ne(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function gi(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e))):e?t.map((({x:t})=>r.get(t))):t.map((({y:t})=>r.get(t)))}const yi=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function vi(t=e.curveLinear,n){if("function"==typeof t)return t;const r=yi.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function xi(t={y:"count"},e={}){[t,e]=Li(t,e);const{x:n,y:r}=e;return Mi(Ai(n,e,f),null,null,r,t,nn(e))}function wi(t={x:"count"},e={}){[t,e]=Li(t,e);const{x:n,y:r}=e;return Mi(null,Ai(r,e,f),n,null,t,rn(e))}function bi(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?Ut:n.reduce,filter:null},n)}function ki(t){return bi(xi,"y",t)}function $i(t){return bi(wi,"x",t)}function Mi(t,e,n,r,{data:i=Xt,filter:o=Zt,sort:a,reverse:s,...c}={},u={}){t=zi(t),e=zi(e),c=Dt(c,u),i=Yt(i,f),a=null==a?void 0:qt("sort",a,u),o=null==o?void 0:jt("filter",o,u),null!=n&&Tt(c,"x","x1","x2")&&(n=null),null!=r&&Tt(c,"y","y1","y2")&&(r=null);const[h,d]=F(t),[p,m]=F(t),[g,y]=F(e),[v,x]=F(e),[w,b]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[$,M]=F(w),{x:L,y:A,z:z,fill:E,stroke:R,x1:C,x2:O,y1:B,y2:N,picker:S,domain:P,cumulative:T,thresholds:D,interval:q,...j}=u,[W,Y]=F(z),[I]=k(E),[_]=k(R),[X,U]=F(I),[H,V]=F(_),[,Z]=F(S);return{..."z"in u&&{z:W||z},..."fill"in u&&{fill:X||E},..."stroke"in u&&{stroke:H||R},...bt(j,((n,r)=>{const u=l(n,w),f=l(n,z),h=l(n,I),p=l(n,_),g=It(c,{z:f,fill:h,stroke:p}),v=[],b=[],k=u&&M([]),$=f&&Y([]),L=h&&U([]),A=p&&V([]),E=t?t(n):[[,,t=>t]],R=e?e(n):[[,,t=>t]],C=t&&d([]),O=t&&m([]),B=e&&y([]),N=e&&x([]);let S=0;for(const t of c)t.initialize(n);a&&a.initialize(n),o&&o.initialize(n);for(const t of r){const e=[];for(const e of c)e.scope("facet",t);a&&a.scope("facet",t),o&&o.scope("facet",t);for(const[r,s]of Wt(t,g))for(const[t,l]of Wt(s,u))for(const[s,d,m]of E){const y=m(l);for(const[l,m,v]of R){const x={x1:s,x2:d,y1:l,y2:m},w=v(y);if(!o||o.reduce(w,x)){e.push(S++),b.push(i.reduce(w,n,x)),u&&k.push(t),f&&$.push(g===f?r:f[w[0]]),h&&L.push(g===h?r:h[w[0]]),p&&A.push(g===p?r:p[w[0]]),C&&(C.push(s),O.push(d)),B&&(B.push(l),N.push(m));for(const t of c)t.reduce(w,x);a&&a.reduce(w)}}}v.push(e)}return Z&&Z(b),Ft(v,a,s),{data:b,facets:v}})),...!Tt(c,"x")&&(h?{x1:h,x2:p,x:G(h,p)}:{x:L,x1:C,x2:O}),...!Tt(c,"y")&&(g?{y1:g,y2:v,y:G(g,v)}:{y:A,y1:B,y2:N}),...$&&{[b]:$},...Object.fromEntries(c.map((({name:t,output:e})=>[t,e])))}}function Li({cumulative:t,domain:e,thresholds:n,interval:r,...i},o){return[i,{cumulative:t,domain:e,thresholds:n,interval:r,...o}]}function Ai(t,{cumulative:n,domain:r,thresholds:i,interval:o},a){return void 0===(t={...X(t)}).domain&&(t.domain=r),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=i),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=a),t.thresholds=function(t,n){if(void 0===t)return void 0===n?Ei:function(t){if(t=an(t),!Ri(t))throw new Error(`invalid interval: ${t}`);return t}(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return Ei}throw new Error(`invalid thresholds: ${t}`)}return t}(t.thresholds,t.interval),t}function zi(t){if(null==t)return;const{value:n,cumulative:r,domain:i=e.extent,thresholds:o}=t,a=t=>{let a=l(t,n,Array);const s=e.bin().value((t=>a[t]));if(Z(a)||(function(t){return Ri(t)&&"function"==typeof t&&t()instanceof Date}(c=o)||U(c)&&Z(c))){a=a.map(vr);let[t,n]="function"==typeof i?i(a):i,r="function"!=typeof o||Ri(o)?o:o(a,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),Ri(r)&&(i===e.extent&&(t=r.floor(t),n=r.ceil(new Date(+n+1))),r=r.range(t,n)),s.thresholds(r).domain([t,n])}else{a=a.map(yr);let t=i,n=o;if(Ri(n)){let[r,i]="function"==typeof t?t(a):t;t===e.extent&&(r=n.floor(r),i=n.offset(n.floor(i)),t=[r,i]),n=n.range(r,i)}s.thresholds(n).domain(t)}var c;let u=s(D(t)).map(Ci);return r&&(u=(r<0?u.reverse():u).map(Oi)),u.map(Bi)};return a.label=_(n),a}function Ei(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function Ri(t){return!!t&&"function"==typeof t.range}function Ci(t){return[t,new Set(t)]}function Oi([t],e,n){return[t,{get size(){for(let t=0;t<=e;++t)if(n[t][1].size)return 1;return 0},has(t){for(let r=0;r<=e;++r)if(n[r][1].has(t))return!0;return!1}}]}function Bi([{x0:t,x1:e},n]){return[t,e,n.size?t=>t.filter(n.has,n):Ni]}function Ni(){return new Uint32Array(0)}function Si(t={}){const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:f}:t}function Pi(t={}){const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:f}:t}function Ti(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{y1:n,y:r=n,x:i,...o}=e,[a,s,l,c]=Yi(r,i,"x",t,o);return{...a,y1:n,y:s,x1:l,x2:c,x:G(l,c)}}function Di(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{x1:n,x:r=n,y:i,...o}=e,[a,s,l,c]=Yi(r,i,"y",t,o);return{...a,x1:n,x:s,y1:l,y2:c,y:G(l,c)}}function qi({x:t,x1:e,x2:n,...r}={}){return void 0===e&&void 0===n?Ti({x:t,...r}):([e,n]=S(t,e,n),{...r,x1:e,x2:n})}function ji({y:t,y1:e,y2:n,...r}={}){return void 0===e&&void 0===n?Di({y:t,...r}):([e,n]=S(t,e,n),{...r,y1:e,y2:n})}function Wi(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}const Yi=function(t,n=h,r,{offset:i,order:o,reverse:a},s){const u=T(s),[f,d]=F(t),[p,m]=I(n),[g,y]=I(n);return i=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Fi;case"center":case"silhouette":return _i;case"wiggle":return Gi}throw new Error(`unknown offset: ${t}`)}(i),o=function(t,e,n){if(void 0===t&&e===Gi)return Qi;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return Hi;case"z":return Vi;case"sum":return Zi;case"appearance":return Ki;case"inside-out":return Qi}return Ji(c(t))}if("function"==typeof t)return Ji(t);if(Array.isArray(t))return r=t,(t,e,n,i)=>to(i,r);var r;throw new Error(`invalid order: ${t}`)}(o,i,r),[bt(s,((r,s)=>{const c=null==t?void 0:d(l(r,t)),f=l(r,n,Float64Array),h=l(r,u),p=o&&o(r,c,f,h),g=r.length,v=m(new Float64Array(g)),x=y(new Float64Array(g)),w=[];for(const t of s){const n=c?Array.from(e.group(t,(t=>c[t])).values()):[t];p&&eo(n,p);for(const t of n){let e=0,n=0;a&&t.reverse();for(const r of t){const t=f[r];t<0?e=x[r]=(v[r]=e)+t:t>0?n=x[r]=(v[r]=n)+t:x[r]=v[r]=n}}w.push(n)}return i&&i(w,v,x,h),{data:r,facets:s}})),f,p,g]};function Ii(t,e){let n=0,r=0;for(const i of t){const t=e[i];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function Fi(t,e,n){for(const r of t)for(const t of r){const[r,i]=Ii(t,n);for(const o of t){const t=1/(i-r||1);e[o]=t*(e[o]-r),n[o]=t*(n[o]-r)}}}function _i(t,e,n){for(const r of t){for(const t of r){const[r,i]=Ii(t,n);for(const o of t){const t=(i+r)/2;e[o]-=t,n[o]-=t}}Xi(r,e,n)}Ui(t,e,n)}function Gi(t,n,r,i){for(const o of t){const t=new e.InternMap;let a=0;for(const s of o){let o=-1;const l=s.map((t=>Math.abs(r[t]-n[t]))),c=s.map((e=>{o=i?i[e]:++o;const a=r[e]-n[e],s=t.has(o)?a-t.get(o):0;return t.set(o,a),s})),u=[0,...e.cumsum(c)];for(const t of s)n[t]+=a,r[t]+=a;const f=e.sum(l);f&&(a-=e.sum(l,((t,e)=>(c[e]/2+u[e])*t))/f)}Xi(o,n,r)}Ui(t,n,r)}function Xi(t,n,r){const i=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=i,r[t]-=i}function Ui(t,n,r){const i=t.length;if(1===i)return;const o=t.map((t=>t.flat())),a=o.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),s=e.min(a);for(let t=0;t<i;t++){const e=s-a[t];for(const i of o[t])n[i]+=e,r[i]+=e}}function Hi(t,e,n){return n}function Vi(t,e,n,r){return r}function Zi(t,n,r,i){return to(i,e.groupSort(D(t),(t=>e.sum(t,(t=>r[t]))),(t=>i[t])))}function Ki(t,n,r,i){return to(i,e.groupSort(D(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])))}function Qi(t,n,r,i){const o=D(t),a=e.groupSort(o,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])),s=e.rollup(o,(t=>e.sum(t,(t=>r[t]))),(t=>i[t])),l=[],c=[];let u=0;for(const t of a)u<0?(u+=s.get(t),l.push(t)):(u-=s.get(t),c.push(t));return to(i,c.reverse().concat(l))}function Ji(t){return e=>l(e,t)}function to(t,n){return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function eo(t,e){for(const n of t)n.sort(((t,n)=>mt(e[t],e[n])))}const no={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ro extends ri{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,z:a,curve:s,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0},z:{value:T(e),optional:!0}},e,no),this.z=a,this.curve=vi(s,l)}filter(t){return t}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:c=s}=r;return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,n,0,0).call((n=>n.selectAll().data(Fe(t,[a,s,l,c],this,r)).enter().append("path").call(Ge,this).call(Ye,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>s[t])).x1((t=>l[t])).y1((t=>c[t]))))).node()}}function io(t,e){const{x:n=u,...r}=ki(e);return new ro(t,ji(Pi({...r,x1:n,x2:void 0})))}function oo(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}={}){t.markerStart=ao(n),t.markerMid=ao(r),t.markerEnd=ao(i)}function ao(t){if(null==t||!1===t)return null;if(!0===t)return co;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return so;case"dot":return lo;case"circle":case"circle-fill":return co;case"circle-stroke":return uo}throw new Error(`invalid marker: ${t}`)}function so(t,e){return Br("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function lo(t,e){return Br("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function co(t,e){return Br("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function uo(t,e){return Br("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let fo=0;function ho(t,e,{stroke:n}={}){return mo(t,e,n&&(t=>n[t]))}function po(t,e,{stroke:n}={}){return mo(t,e,n&&(([t])=>n[t]))}function mo(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:i},o=(()=>i)){const a=new Map;function s(t){return function(e){const n=o(e);let r=a.get(t);r||a.set(t,r=new Map);let i=r.get(n);if(!i){const e={document:this.ownerDocument},o=this.parentNode.insertBefore(t(n,e),this),a="plot-marker-"+ ++fo;o.setAttribute("id",a),r.set(n,i=`url(#${a})`)}return i}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}const go={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class yo extends ri{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,curve:a,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,go),this.curve=vi(a,s),oo(this,e)}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:c=s}=r,{curve:u}=this;return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(Ge,this).attr("d",(t=>{const n=e.path(),r=u(n);return r.lineStart(),r.point(a[t],s[t]),r.point(l[t],c[t]),r.lineEnd(),n})).call(We,this,r).call(ho,this,r))).node()}}function vo(t,e={}){let{x:n,x1:r,x2:i,y:o,y1:a,y2:s,...l}=e;return[r,i]=xo(n,r,i),[a,s]=xo(o,a,s),new yo(t,{...l,x1:r,x2:i,y1:a,y2:s})}function xo(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const wo={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class bo extends ri{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,bend:a=0,headAngle:s=60,headLength:l=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,wo),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+s,this.headLength=+l,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,i){const{x1:o,y1:a,x2:s=o,y2:l=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,g=c?t=>c[t]:x(void 0===u?1:u),y=f*Nr,v=h*Nr/2,w=d/1.5;return Br("svg:g",i).call(_e,this,e,r,i).call(Ve,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Ge,this).attr("d",(t=>{let e=o[t],n=a[t],r=s[t],i=l[t];const c=Math.hypot(r-e,i-n);if(c<=p+m)return null;let u=Math.atan2(i-n,r-e);const f=Math.min(w*g(t),c/3),h=Math.hypot(c/Math.tan(y),c)/2;if(p||m)if(h<1e5){const t=Math.sign(y),[o,a]=function([t,e],[n,r],i,o){const a=n-t,s=r-e,l=Math.hypot(a,s),c=o*Math.sqrt(i*i-l*l/4)/l;return[(t+n)/2-s*c,(e+r)/2+a*c]}([e,n],[r,i],h,t);if(p&&([e,n]=ko([o,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=ko([o,a,h],[r,i,m],t*Math.sign(m));u+=Math.atan2(n-a,e-o)-Math.atan2(i-a,r-o),r=e,i=n}}else{const t=r-e,o=i-n,a=Math.hypot(t,o);p&&(e+=t/a*p,n+=o/a*p),m&&(r-=t/a*m,i-=o/a*m)}const d=u+y,x=d+v,b=d-v,k=r-f*Math.cos(x),$=i-f*Math.sin(x),M=r-f*Math.cos(b),L=i-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${y>0?1:0} `:"L"}${r},${i}M${k},${$}L${r},${i}L${M},${L}`})).call(We,this,n))).node()}}function ko([t,e,n],[r,i,o],a){const s=r-t,l=i-e,c=Math.hypot(s,l),u=(s*s+l*l-o*o+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(s*u+l*f)/c,e+(l*u-s*f)/c]}class $o extends ri{constructor(t,e,n={},r){super(t,e,n,r);const{inset:i=0,insetTop:o=i,insetRight:a=i,insetBottom:s=i,insetLeft:l=i,rx:c,ry:u}=n;var f;this.insetTop=m(o),this.insetRight=m(a),this.insetBottom=m(s),this.insetLeft=m(l),this.rx=Ze(c,"auto"),this.ry=Ze(u,"auto"),this.cursor=null!=(f=e.picker)&&f.value&&f.value!==w?"pointer":null}render(t,e,n,r,i){const{rx:o,ry:a}=this;return Br("svg:g",i).call(_e,this,e,r,i).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("rect").call(Ge,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).on("click",this._click(e,n)).call(He,"cursor",this.cursor).call(Ue,"rx",o).call(Ue,"ry",a).call(We,this,n))).node()}_click(t,{picker:e}){return e?(t,n)=>{t.target.dispatchEvent(new CustomEvent("pick",{bubbles:!0,detail:{type:t.type,picked:e[n]}}))}:()=>{}}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:i}){const{insetLeft:o,insetRight:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:i}){const{insetTop:o,insetBottom:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}}const Mo={ariaLabel:"bar"};class Lo extends $o{constructor(t,e={}){const{x1:n,x2:r,y:i,picker:o=w}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0},picker:{value:o,optional:!0}},e,Mo)}_transform(t,e,{x:n}){t.call(Ve,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:i}=this;return hr(t)?r+i:t=>Math.min(e[t],n[t])+i}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this;return hr(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}class Ao extends $o{constructor(t,e={}){const{x:n,y1:r,y2:i,picker:o=w}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:i,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0},picker:{value:o,optional:!0}},e,Mo)}_transform(t,e,{y:n}){t.call(Ve,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:i}=this;return hr(t)?r+i:t=>Math.min(e[t],n[t])+i}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this;return hr(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}function zo(t,e={y:u,x2:f}){return new Lo(t,qi(hn(Si(e))))}function Eo(t,e={x:u,y2:f}){return new Ao(t,ji(dn(Pi(e))))}function Ro(t,e={}){return Bo(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Co(t,e={}){return Bo(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Oo(t={},n={}){const r=T(n),i=Object.entries(t).map((([t,e])=>{const r=Y(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[i,o]=I(r);return{key:t,input:r,output:i,setOutput:o,map:No(e)}}));return{...bt(n,((t,n)=>{const o=l(t,r),a=i.map((({input:e})=>l(t,e))),s=i.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of o?e.group(t,(t=>o[t])).values():[t])i.forEach((({map:t},e)=>t.map(n,a[e],s[e])));return{data:t,facets:n}})),...Object.fromEntries(i.map((({key:t,output:e})=>[t,e])))}}const Bo=Oo;function No(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return Po(t);switch(`${t}`.toLowerCase()){case"cumsum":return To;case"rank":return Po(e.rank);case"quantile":return Po(So)}throw new Error(`invalid map: ${t}`)}function So(t){const n=e.count(t)-1;return e.rank(t).map((t=>t/n))}function Po(t){return{map(e,n,r){const i=t(j(n,e));if(i.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=i[t]}}}const To={map(t,e,n){let r=0;for(const i of t)n[i]=r+=e[i]}},Do={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function qo(t){return void 0===t.sort&&void 0===t.reverse?Et({channel:"r",order:"descending"},t):t}class jo extends ri{constructor(t,n={}){const{x:r,y:i,r:o,rotate:a,symbol:s=e.symbolCircle,frameAnchor:l}=n,[c,u]=$(a,0),[f,h]=function(t){if(null==t||In(t))return[void 0,t];if("string"==typeof t){const e=Yn.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[d,p]=$(o,null==f?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:d,scale:"r",filter:xt,optional:!0},rotate:{value:c,optional:!0},symbol:{value:f,scale:"symbol",optional:!0}},qo(n),Do),this.r=p,this.rotate=u,this.symbol=h,this.frameAnchor=it(l);const{channels:m}=this,{symbol:g}=m;if(g){const{fill:t,stroke:e}=m;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,r:u,rotate:f,symbol:h}=r,[d,p]=en(this,i),m=this.symbol===e.symbolCircle,{r:g}=this;return wt(g)&&(t=[]),Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,{x:l&&a,y:c&&s}).call((n=>n.selectAll().data(t).enter().append(m?"circle":"path").call(Ge,this).call(m?t=>{t.attr("cx",l?t=>l[t]:d).attr("cy",c?t=>c[t]:p).attr("r",u?t=>u[t]:g)}:t=>{const n=l&&c?t=>`translate(${l[t]},${c[t]})`:l?t=>`translate(${l[t]},${p})`:c?t=>`translate(${d},${c[t]})`:()=>`translate(${d},${p})`;t.attr("transform",f?t=>`${n(t)} rotate(${f[t]})`:this.rotate?t=>`${n(t)} rotate(${this.rotate})`:n).attr("d",(t=>{const n=e.path(),r=u?u[t]:g;return(h?h[t]:this.symbol).draw(n,r*r*Math.PI),n}))}).call(We,this,r))).node()}}function Wo(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=P(n,r)),new jo(t,{...i,x:n,y:r})}const Yo={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Io extends ri{constructor(t,e={}){const{x:n,y1:r,y2:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Yo),this.insetTop=m(a),this.insetBottom=m(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y1:l,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return Br("svg:g",i).call(_e,this,e,r).call(Ve,this,{x:s&&o},Se,0).call((e=>e.selectAll().data(t).enter().append("line").call(Ge,this).attr("x1",s?t=>s[t]:(p+u-d)/2).attr("x2",s?t=>s[t]:(p+u-d)/2).attr("y1",l&&!hr(a)?t=>l[t]+g:h+g).attr("y2",c&&!hr(a)?a.bandwidth?t=>c[t]+a.bandwidth()-y:t=>c[t]-y:f-m-y).call(We,this,n))).node()}}class Fo extends ri{constructor(t,e={}){const{x1:n,x2:r,y:i,inset:o=0,insetRight:a=o,insetLeft:s=o}=e;super(t,{y:{value:i,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},e,Yo),this.insetRight=m(a),this.insetLeft=m(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{y:s,x1:l,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return Br("svg:g",i).call(_e,this,e,r,i).call(Ve,this,{y:s&&a},0,Se).call((e=>e.selectAll().data(t).enter().append("line").call(Ge,this).attr("x1",l&&!hr(o)?t=>l[t]+g:p+g).attr("x2",c&&!hr(o)?o.bandwidth?t=>c[t]+o.bandwidth()-y:t=>c[t]-y:u-d-y).attr("y1",s?t=>s[t]:(h+f-m)/2).attr("y2",s?t=>s[t]:(h+f-m)/2).call(We,this,n))).node()}}function _o(t,e){let{x:n=f,y:r,y1:i,y2:o,...a}=dn(e);return[i,o]=Xo(r,i,o),new Io(t,{...a,x:n,y1:i,y2:o})}function Go(t,e){let{y:n=f,x:r,x1:i,x2:o,...a}=hn(e);return[i,o]=Xo(r,i,o),new Fo(t,{...a,y:n,x1:i,x2:o})}function Xo(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Uo={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Ho extends ri{constructor(t,e,n){super(t,e,n,Uo)}render(t,e,n,r,i){return Br("svg:g",i).call(_e,this,e,r,i).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(Ge,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(We,this,n))).node()}}class Vo extends Ho{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetTop:o=i,insetBottom:a=i}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=m(o),this.insetBottom=m(a)}_transform(t,e,{x:n}){t.call(Ve,e,{x:n},Se,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}}class Zo extends Ho{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetRight:o=i,insetLeft:a=i}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=m(o),this.insetLeft=m(a)}_transform(t,e,{y:n}){t.call(Ve,e,{y:n},0,Se)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Ko(t,e={}){const{x:n=f,...r}=e;return new Vo(t,{...r,x:n})}function Qo(t,e={}){const{y:n=f,...r}=e;return new Zo(t,{...r,y:n})}function Jo(t){const e=ta(t),n=ea(t);return t.map((t=>t<e||t>n?t:NaN))}function ta(t,n){const r=2.5*na(t,n)-1.5*ra(t,n);return e.min(t,(t=>t>=r?t:NaN))}function ea(t,n){const r=2.5*ra(t,n)-1.5*na(t,n);return e.max(t,(t=>t<=r?t:NaN))}function na(t,n){return e.quantile(t,.25,n)}function ra(t,n){return e.quantile(t,.75,n)}const ia={ariaLabel:"cell"};class oa extends $o{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,ia)}_transform(t,e){t.call(Ve,e,{},0,0)}}const aa={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},sa={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},la={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},ca={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ua={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class fa extends ri{constructor(t,e={}){const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:i,optional:!0}},e,aa),this.curve=vi(o,a),oo(this,e)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,{curve:f}=this,[h,d]=en(this,i),p=l?t=>l[t]:x(h),m=c?t=>c[t]:x(d),g=this;function y(t){let n=-1;const i=[],o={};for(const t in r)o[t]=[];const a=[],s=[],l=[],c=[];function u(e,u){e=t[e],u=t[u],i.push(++n),a[n]=p(e),l[n]=m(e),s[n]=p(u),c[n]=m(u);for(const t in r)o[t].push(r[t][u])}const{halfedges:h,hull:d,triangles:y}=e.Delaunay.from(t,p,m);for(let t=0;t<h.length;++t){const e=h[t];e>t&&u(y[t],y[e])}for(let t=0;t<d.length;++t)u(d[t],d[(t+1)%d.length]);e.select(this).selectAll().data(i).join("path").call(Ge,g).attr("d",(t=>{const n=e.path(),r=f(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n})).call(We,g,o).call(ho,g,o)}return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class ha extends ri{constructor(t,e={},n,r=(({z:t})=>t)){const{x:i,y:o}=e;super(t,{x:{value:i,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=en(this,i),d=l?t=>l[t]:x(f),p=c?t=>c[t]:x(h),m=this;function g(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(Ge,m).attr("d",m._render(n,i)).call(We,m,r)}return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class da extends ha{constructor(t,e={}){super(t,e,sa),this.fill="none"}_render(t){return t.render()}}class pa extends ha{constructor(t,e={}){super(t,e,la,T)}_render(t){return t.renderHull()}}class ma extends ri{constructor(t,e={}){const{x:n,y:r,z:i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:i,optional:!0}},e,ca)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:c,z:u}=r,[f,h]=en(this,i),d=l?t=>l[t]:x(f),p=c?t=>c[t]:x(h);function m(t){const n=ya(e.Delaunay.from(t,d,p),i);e.select(this).selectAll().data(t).enter().append("path").call(Ge,this).attr("d",((t,e)=>n.renderCell(e))).call(We,this,r)}return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,{x:l&&a,y:c&&s}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(m):e=>e.datum(t).each(m)).node()}}class ga extends ha{constructor(t,e){super(t,e,ua),this.fill="none"}_render(t,e){return ya(t,e).render()}}function ya(t,e){const{width:n,height:r,marginTop:i,marginRight:o,marginBottom:a,marginLeft:s}=e;return t.voronoi([s,i,n-o,r-a])}function va(t,e,{x:n,y:r,...i}={}){return[n,r]=P(n,r),new t(e,{...i,x:n,y:r})}const xa={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class wa extends ri{constructor(t,{x:n,y:r,z:i,weight:o,fill:a,stroke:s,...l}={}){const c=ka(a)&&(a="currentColor",!0),u=ka(s)&&(s="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:T({z:i,fill:a,stroke:s}),optional:!0},weight:{value:o,optional:!0}},function(t,n,r){const i=100;let{bandwidth:o,thresholds:a}=t;return o=void 0===o?20:+o,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?gr(a):+a,kt(t,(function(t,s,l,c,u,f){const h=l.weight?gr(l.weight.value):null,d=l.z?.value,{z:p}=this,[m,g]=en(this,u),{width:y,height:v}=u,{x:x,y:w}=Cr(l,c,f),b=Object.fromEntries(Object.entries(l).filter((([t])=>!ba.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],$=r&&[],M=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:g).weight(h?t=>h[t]:1).size([y,v]).bandwidth(o),L=[];for(const t of s){const e=[];L.push(e);for(const n of d?Ie(t,d,p):[t]){const t=M.contours(n);e.push([n,t])}}let A=a;if(!R(A)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}A=Float64Array.from({length:a-1},((e,n)=>t*i*(n+1)/a))}const z=[],E=[];for(const t of L){const e=[];z.push(e);for(const[n,r]of t)for(const t of A){e.push(E.length),E.push(r(t/i)),k&&k.push(t),$&&$.push(t);for(const t in b)b[t].value.push(l[t].value[n[0]])}}return k&&k.push(0),$&&$.push(0),{data:t,facets:z,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...$&&{stroke:{value:$,scale:"color"}},contours:{value:E}}}}))}({...l,fill:a,stroke:s},c,u),xa),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=i}filter(t){return t}render(t,n,r,i,o){const{contours:a}=r,s=e.geoPath();return e.create("svg:g",o).call(_e,this,n,i,o).call(Ve,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(Ge,this).call(We,this,r).attr("d",(t=>s(a[t]))))).node()}}const ba=new Set(["x","y","z","weight"]);function ka(t){return/^density$/i.test(t)}const $a={ariaLabel:"frame",fill:"none",stroke:"currentColor"};class Ma extends ri{constructor(t={}){const{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,rx:a,ry:s}=t;super(void 0,void 0,t,$a),this.insetTop=m(n),this.insetRight=m(r),this.insetBottom=m(i),this.insetLeft=m(o),this.rx=m(a),this.ry=m(s)}render(t,e,n,r,i){const{marginTop:o,marginRight:a,marginBottom:s,marginLeft:l,width:c,height:u}=r,{insetTop:f,insetRight:h,insetBottom:d,insetLeft:p,rx:m,ry:g}=this;return Br("svg:rect",i).call(_e,this,e,r,i).call(Ge,this).call(Ve,this,{}).attr("x",l+p).attr("y",o+f).attr("width",c-l-a-p-h).attr("height",u-o-s-f-d).attr("rx",m).attr("ry",g).node()}}const La={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Aa extends ri{constructor(t,e={}){const[n,r]=$(e.r,3);super(t,{geometry:{value:e.geometry},r:{value:n,scale:"r",filter:xt,optional:!0}},qo(e),La),this.r=r}render(t,n,r,i,o){const{geometry:a,r:s}=r,l=e.geoPath(o.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:c}=this;return wt(c)?t=[]:void 0!==c&&l.pointRadius(c),Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(Ge,this).attr("d",s?t=>l.pointRadius(s[t])(a[t]):t=>l(a[t])).call(We,this,r)})).node()}}function za(t,{geometry:e=f,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Aa(t,{geometry:e,...n})}const Ea=.5;function Ra(t,e,n,r){const i=r*(1.5/qn),o=new Map;for(const a of t){let t=e[a],s=n[a];if(isNaN(t)||isNaN(s))continue;let l=Math.round(s=(s-0)/i),c=Math.round(t=(t-Ea)/r-(1&l)/2),u=s-l;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=l+(s<l?-1:1),i=t-n,o=s-r;e*e+u*u>i*i+o*o&&(c=n+(1&l?1:-1)/2,l=r)}const f=`${c},${l}`;let h=o.get(f);void 0===h&&(o.set(f,h=[]),h.x=(c+(1&l)/2)*r+Ea,h.y=l*i+0),h.push(a)}return o.values()}const Ca={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Oa extends ri{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(void 0,void 0,{clip:e,...n},Ca),this.binWidth=m(t)}render(t,e,n,r,i){const{binWidth:o}=this,{marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,width:u,height:f}=r,h=c-Ea,d=u-s-Ea,p=a-0,m=f-l-0,g=o/2,y=g*jn,v=y/2,x=2*g,w=1.5*y,b=`m0,${-y}l${g},${v}v${y}l${-g},${v}`,k=Math.floor(h/x),$=Math.ceil(d/x),M=Math.floor((p+v)/w),L=Math.ceil((m-v)/w)+1,A=[];for(let t=M;t<L;++t)for(let e=k;e<$;++e)A.push(`M${e*x+(1&t)*g},${t*w}${b}`);return Br("svg:g",i).call(_e,this,e,r,i).call((t=>t.append("path").call(Ge,this).call(Ve,this,{},Se+Ea,Se+0).attr("d",A.join("")))).node()}}const Ba={ariaLabel:"image",fill:null,stroke:null};class Na extends ri{constructor(t,e={}){let{x:n,y:r,width:i,height:o,src:a,preserveAspectRatio:s,crossOrigin:l,frameAnchor:c}=e;void 0===i&&void 0!==o?i=o:void 0===o&&void 0!==i&&(o=i);const[u,f]="string"==typeof(h=a)&&(function(t){return/^\.*\//.test(t)}(h)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(h))?[void 0,h]:[h,void 0];var h;const[d,m]=$(i,16),[g,y]=$(o,16);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},width:{value:d,filter:xt,optional:!0},height:{value:g,filter:xt,optional:!0},src:{value:u,optional:!0}},e,Ba),this.src=f,this.width=m,this.height=y,this.preserveAspectRatio=Ze(s,"xMidYMid"),this.crossOrigin=p(l),this.frameAnchor=it(c)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,width:c,height:u,src:f}=n,[h,d]=en(this,r);return Br("svg:g",i).call(_e,this,e,r,i).call(Ve,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(Ge,this).attr("x",c&&s?t=>s[t]-c[t]/2:c?t=>h-c[t]/2:s?t=>s[t]-this.width/2:h-this.width/2).attr("y",u&&l?t=>l[t]-u[t]/2:u?t=>d-u[t]/2:l?t=>l[t]-this.height/2:d-this.height/2).attr("width",c?t=>c[t]:this.width).attr("height",u?t=>u[t]:this.height).call(Ue,"href",f?t=>f[t]:this.src).call(Ue,"preserveAspectRatio",this.preserveAspectRatio).call(Ue,"crossorigin",this.crossOrigin).call(We,this,n))).node()}}const Sa={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};function Pa(t){return e.curveLinear(t)}class Ta extends ri{constructor(t,e={}){const{x:n,y:r,z:i}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:T(e),optional:!0}},e,Sa),this.z=i,this.curve=function({curve:t=Pa,tension:e}){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Pa:vi(t,e)}(e),oo(this,e)}filter(t){return t}project(t,e,n){this.curve!==Pa&&super.project(t,e,n)}render(t,n,r,i,o){const{x:a,y:s}=r,{curve:l}=this;return Br("svg:g",o).call(_e,this,n,i,o).call(Ve,this,n).call((n=>n.selectAll().data(Fe(t,[a,s],this,r)).enter().append("path").call(Ge,this).call(Ye,this,r).call(po,this,r).attr("d",l===Pa&&o.projection?function(t,n,r){const i=e.geoPath(t);return n=gr(n),r=gr(r),t=>{let e=[];const o=[e];for(const i of t)-1===i?(e=[],o.push(e)):e.push([n[i],r[i]]);return i({type:"MultiLineString",coordinates:o})}}(o.projection,a,s):e.line().curve(l).defined((t=>t>=0)).x((t=>a[t])).y((t=>s[t]))))).node()}}function Da(t,e,n){var r=0===t||1===t?0:Math.exp(ja(e+n)-ja(e)-ja(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*qa(t,e,n)/e:1-r*qa(1-t,n,e)/n)}function qa(t,e,n){var r,i,o,a,s=1e-30,l=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<s&&(d=s),a=d=1/d;l<=100&&(d=1+(i=l*(n-l)*t/((f+(r=2*l))*(e+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=(d=1/d)*h,d=1+(i=-(e+l)*(c+l)*t/((e+r)*(u+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=o=(d=1/d)*h,!(Math.abs(o-1)<3e-7));l++);return a}function ja(t){var e,n,r,i=0,o=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);i<6;i++)a+=o[i]/++n;return Math.log(2.506628274631*a/e)-r}function Wa(t,e){var n=function(t,e,n){var r,i,o,a,s,l,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(o=t<.5?t:1-t,l=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(o))))/(1+a*(.99229+.04481*a))-a,t<.5&&(l=-l),c=(l*l-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=l*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),l=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),i=Math.log(n/(e+n)),l=t<(a=Math.exp(e*r)/e)/(f=a+(s=Math.exp(n*i)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-ja(e)-ja(n)+ja(e+n);m<10;m++){if(0===l||1===l)return l;if((l-=a=(s=(Da(l,e,n)-t)/(a=Math.exp(d*Math.log(l)+p*Math.log(1-l)+h)))/(1-.5*Math.min(1,s*(d/l-p/(1-l)))))<=0&&(l=.5*(l+a)),l>=1&&(l=.5*(l+a+1)),Math.abs(a)<1e-8*l&&m>0)break}return l}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Ya={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ia extends ri{constructor(t,e={}){const{x:n,y:r,z:i,ci:o=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:T(e),optional:!0}},e,Ya),this.z=i,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${o}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,i){const{x:o,y:a,z:s}=n,{ci:l}=this;return Br("svg:g",i).call(_e,this,e,r,i).call(Ve,this,e).call((e=>e.selectAll().data(s?Ie(t,s,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(Ge,this).call(Ye,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,o,a))).call(l&&!rt(this.fill)?t=>t.select(Fa).attr("stroke","none").call(Ge,this).call(Ye,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,o,a))):()=>{}))))).node()}}function Fa(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class _a extends Ia{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>r[t])),l=Xa(t,r,n),c=Ua(t,r,n,(1-i)/2,l);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>r[t])),a=Xa(t,r,n);return`M${a(i)},${i}L${a(o)},${o}`}}class Ga extends Ia{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>n[t])),l=Xa(t,n,r),c=Ua(t,n,r,(1-i)/2,l);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=Xa(t,n,r);return`M${i},${a(i)}L${o},${a(o)}`}}function Xa(t,e,n){let r=0,i=0,o=0,a=0;for(const s of t){const t=e[s],l=n[s];r+=t,i+=l,o+=t*l,a+=t*t}const s=t.length,l=(s*o-r*i)/(s*a-r*r),c=(i-l*r)/s;return t=>l*t+c}function Ua(t,n,r,i,o){const a=e.sum(t,(t=>n[t]))/t.length;let s=0,l=0;for(const e of t)s+=(n[e]-a)**2,l+=(r[e]-o(n[e]))**2;const c=Math.sqrt(l/(t.length-2)),u=Wa(i,t.length-2);return(e,n)=>{const r=o(e),i=c*Math.sqrt(1/t.length+(e-a)**2/s);return r+n*u*i}}const Ha={ariaLabel:"rect"};class Va extends ri{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,inset:a=0,insetTop:s=a,insetRight:l=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:i,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,Ha),this.insetTop=m(s),this.insetRight=m(l),this.insetBottom=m(c),this.insetLeft=m(u),this.rx=Ze(f,"auto"),this.ry=Ze(h,"auto")}render(t,e,n,r,i){const{x:o,y:a}=e,{x1:s,y1:l,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:g}=r,{projection:y}=i,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return Br("svg:g",i).call(_e,this,e,r,i).call(Ve,this,{x:s&&c&&o,y:l&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(Ge,this).attr("x",s&&c&&(y||!hr(o))?t=>Math.min(s[t],c[t])+b:p+b).attr("y",l&&u&&(y||!hr(a))?t=>Math.min(l[t],u[t])+v:f+v).attr("width",s&&c&&(y||!hr(o))?t=>Math.max(0,Math.abs(c[t]-s[t])-b-x):m-h-p-x-b).attr("height",l&&u&&(y||!hr(a))?t=>Math.max(0,Math.abs(l[t]-u[t])-v-w):g-f-d-v-w).call(Ue,"rx",k).call(Ue,"ry",$).call(We,this,n))).node()}}const Za={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class Ka extends ri{constructor(t,e={}){const{x:n,y:r,text:i=(U(t)&&H(t)?f:u),frameAnchor:o,textAnchor:a=(/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle"),lineAnchor:s=(/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle"),lineHeight:c=1,lineWidth:h=1/0,monospace:d,fontFamily:m=(d?"ui-monospace, monospace":void 0),fontSize:g,fontStyle:y,fontVariant:v,fontWeight:x,rotate:w}=e,[b,k]=$(w,0),[M,A]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),es.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(g);var z;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:M,optional:!0},rotate:{value:(z=b,null==z?null:{transform:t=>l(t,z,Float64Array),label:_(z)}),optional:!0},text:{value:i,filter:yt}},e,Za),this.rotate=k,this.textAnchor=Ze(a,"middle"),this.lineAnchor=L(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+h,this.monospace=!!d,this.fontFamily=p(m),this.fontSize=A,this.fontStyle=p(y),this.fontVariant=p(v),this.fontWeight=p(x),this.frameAnchor=it(o)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,rotate:c,text:u,fontSize:f}=n,{rotate:h}=this,[d,p]=en(this,r);return Br("svg:g",i).call(_e,this,e,r,i).call(ts,this,u,r).call(Ve,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(Ge,this).call(Qa,this,u).attr("transform",c?s&&l?t=>`translate(${s[t]},${l[t]}) rotate(${c[t]})`:s?t=>`translate(${s[t]},${p}) rotate(${c[t]})`:l?t=>`translate(${d},${l[t]}) rotate(${c[t]})`:t=>`translate(${d},${p}) rotate(${c[t]})`:h?s&&l?t=>`translate(${s[t]},${l[t]}) rotate(${h})`:s?t=>`translate(${s[t]},${p}) rotate(${h})`:l?t=>`translate(${d},${l[t]}) rotate(${h})`:`translate(${d},${p}) rotate(${h})`:s&&l?t=>`translate(${s[t]},${l[t]})`:s?t=>`translate(${s[t]},${p})`:l?t=>`translate(${d},${l[t]})`:`translate(${d},${p})`).call(Ue,"font-size",f&&(t=>f[t])).call(We,this,n))).node()}}function Qa(t,{monospace:n,lineAnchor:r,lineHeight:i,lineWidth:o},a){if(!a)return;const s=isFinite(o)?n?t=>ns(t,o,os):t=>ns(t,100*o,is):t=>t.split(/\r\n?|\n/g);t.each((function(t){const n=s(Oe(a[t])),o=n.length,l="top"===r?.71:"bottom"===r?1-o:(164-100*o)/200;if(o>1)for(let t=0;t<o;++t){if(!n[t])continue;const r=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");r.setAttribute("x",0),r.setAttribute("y",(l+t)*i+"em"),r.textContent=n[t],this.appendChild(r)}else l&&this.setAttribute("y",l*i+"em"),this.textContent=n[0]}))}function Ja(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=P(n,r)),new Ka(t,{...i,x:n,y:r})}function ts(t,e,n){Ue(t,"text-anchor",e.textAnchor),Ue(t,"font-family",e.fontFamily),Ue(t,"font-size",e.fontSize),Ue(t,"font-style",e.fontStyle),Ue(t,"font-variant",void 0===e.fontVariant&&(function(t){for(const e of t)if(null!=e)return"number"==typeof e}(n)||Z(n))?"tabular-nums":e.fontVariant),Ue(t,"font-weight",e.fontWeight)}const es=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function ns(t,e,n=((t,e,n)=>n-e)){const r=[];let i,o=0;for(const[a,s,l]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===i&&(i=a),o>i&&n(t,i,s)>e&&(r.push(t.slice(i,o)),i=a),l?(r.push(t.slice(i,s)),i=void 0):o=s;return r}const rs={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47};function is(t,e,n){let r=0;for(let i=e;i<n;++i){r+=rs[t[i]]||rs.e;const e=t.charCodeAt(i);if(e>=55296&&e<=56319){const e=t.charCodeAt(i+1);e>=56320&&e<=57343&&++i}}return r}function os(t,e,n){return n-e}function as(t={}){let{path:n=f,delimiter:r,frameAnchor:i,treeLayout:o=e.tree,treeSort:a,treeSeparation:s,treeAnchor:c,...u}=t;c=ls(c),a=fs(a),void 0===i&&(i=c.frameAnchor);const d=ds(r),p=zs(u,ms),[m,g]=I(),[y,v]=I();return{x:m,y:y,frameAnchor:i,...bt(u,((t,r)=>{const i=d(l(t,n)),u=g([]),f=v([]);let m=-1;const y=[],x=[],w=e.stratify().path((t=>i[t])),b=o();b.nodeSize&&b.nodeSize([1,1]),b.separation&&void 0!==s&&b.separation(s??h);for(const t of p)t[As]=t[Ms]([]);for(const e of r){const n=[],r=w(e.filter((t=>null!=i[t]))).each((e=>e.data=t[e.data]));null!=a&&r.sort(a),b(r);for(const t of r.descendants()){n.push(++m),y[m]=t.data,c.position(t,m,u,f);for(const e of p)e[As][m]=e[Ls](t)}x.push(n)}return{data:y,facets:x}})),...Object.fromEntries(p)}}function ss(t={}){let{path:n=f,delimiter:r,curve:i="bump-x",stroke:o="#555",strokeWidth:a=1.5,strokeOpacity:s=.5,treeLayout:c=e.tree,treeSort:u,treeSeparation:d,treeAnchor:p,...m}=t;p=ls(p),u=fs(u),m={curve:i,stroke:o,strokeWidth:a,strokeOpacity:s,...m};const g=ds(r),y=zs(m,gs),[v,x]=I(),[w,b]=I(),[k,$]=I(),[M,L]=I();return{x1:v,x2:w,y1:k,y2:M,...bt(m,((t,r)=>{const i=g(l(t,n)),o=x([]),a=b([]),s=$([]),f=L([]);let m=-1;const v=[],w=[],k=e.stratify().path((t=>i[t])),M=c();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==d&&M.separation(d??h);for(const t of y)t[As]=t[Ms]([]);for(const e of r){const n=[],r=k(e.filter((t=>null!=i[t]))).each((e=>e.data=t[e.data]));null!=u&&r.sort(u),M(r);for(const{source:t,target:e}of r.links()){n.push(++m),v[m]=e.data,p.position(t,m,o,s),p.position(e,m,a,f);for(const n of y)n[As][m]=n[Ls](e,t)}w.push(n)}return{data:v,facets:w}})),...Object.fromEntries(y)}}function ls(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return cs;case"right":return us}throw new Error(`invalid tree anchor: ${t}`)}const cs={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,i){r[n]=e,i[n]=-t}},us={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,i){r[n]=-e,i[n]=-t}};function fs(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?hs(ms(t)):hs(function(t){return e=>e.data?.[t]}(t))}function hs(t){return(e,n)=>mt(t(e),t(n))}function ds(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function ps(t){return C(t)&&"function"==typeof t.node}function ms(t){if(ps(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return vs;case"node:path":return ys;case"node:internal":return bs;case"node:depth":return xs;case"node:height":return ws}throw new Error(`invalid node value: ${t}`)}}function gs(t){if(ps(t))return t.node;if(C(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return ks(vs);case"parent:path":return ks(ys);case"parent:depth":return ks(xs);case"parent:height":return ks(ws);case"node:name":return vs;case"node:path":return ys;case"node:internal":return bs;case"node:depth":return xs;case"node:height":return ws}throw new Error(`invalid link value: ${t}`)}}function ys(t){return t.id}function vs(t){return function(t){let e=t.length;for(;--e>0&&!$s(t,e););return t.slice(e+1)}(t.id)}function xs(t){return t.depth}function ws(t){return t.height}function bs(t){return!!t.children}function ks(t){return(e,n)=>null==n?void 0:t(n)}function $s(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const Ms=2,Ls=3,As=4;function zs(t,e){const n=[];for(const r in t){const i=t[r],o=e(i);void 0!==o&&n.push([r,...I(i),o])}return n}function Es(t,e={}){let{fill:n,stroke:r,strokeWidth:i,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=nt(h)&&nt(d),text:m="node:name",textStroke:g="white",title:y="node:path",dx:v,dy:x,...w}=e;return void 0===v&&(v=ls(w.treeAnchor).dx),ii(vo(t,ss({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:i,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:s,strokeMiterlimit:l,strokeDasharray:c,strokeDashoffset:u,...w})),p?Wo(t,as({fill:void 0===n?"node:internal":n,title:y,...w})):null,null!=m?Ja(t,as({text:m,fill:void 0===n?"currentColor":n,stroke:g,dx:v,dy:x,title:y,...w})):null)}const Rs={ariaLabel:"vector",fill:null,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round"};class Cs extends ri{constructor(t,e={}){const{x:n,y:r,length:i,rotate:o,anchor:a="middle",frameAnchor:s}=e,[l,c]=$(i,12),[u,f]=$(o,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:l,scale:"length",optional:!0},rotate:{value:u,optional:!0}},e,Rs),this.length=c,this.rotate=f,this.anchor=L(a,"anchor",["start","middle","end"]),this.frameAnchor=it(s)}render(t,e,n,r,i){const{x:o,y:a}=e,{x:s,y:l,length:c,rotate:u}=n,{length:f,rotate:h,anchor:d}=this,[p,m]=en(this,r),g=c?t=>c[t]:()=>f,y=u?t=>u[t]:()=>h,v=s?t=>s[t]:()=>p,x=l?t=>l[t]:()=>m,w="start"===d?0:"end"===d?1:.5;return Br("svg:g",i).attr("fill","none").call(_e,this,e,r,i).call(Ve,this,{x:s&&o,y:l&&a}).call((e=>e.selectAll().data(t).enter().append("path").call(Ge,this).attr("d",(t=>{const e=g(t),n=y(t)*Nr,r=Math.sin(n)*e,i=-Math.cos(n)*e,o=(r+i)/5,a=(r-i)/5;return`M${v(t)-r*w},${x(t)-i*w}l${r},${i}m${-a},${-o}l${a},${o}l${-o},${a}`})).call(We,this,n))).node()}}function Os(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(o=a,i=a-1):r=a+1}return o}function Bs(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(o=a,i=a-1):r=a+1}return o}function Ns(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(o=a,r=a+1):i=a-1}return o}function Ss(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(o=a,r=a+1):i=a-1}return o}function Ps(t,e,n,r,i){for(;r<=i;){var o=r+i>>>1,a=t[o],s=void 0!==n?n(a,e):a-e;if(0===s)return o;s<=0?r=o+1:i=o-1}return-1}function Ts(t,e,n,r,i,o){return"function"==typeof n?o(t,e,n,void 0===r?0:0|r,void 0===i?t.length-1:0|i):o(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Ds={ge:function(t,e,n,r,i){return Ts(t,e,n,r,i,Os)},gt:function(t,e,n,r,i){return Ts(t,e,n,r,i,Bs)},lt:function(t,e,n,r,i){return Ts(t,e,n,r,i,Ns)},le:function(t,e,n,r,i){return Ts(t,e,n,r,i,Ss)},eq:function(t,e,n,r,i){return Ts(t,e,n,r,i,Ps)}},qs=function(t){if(!t||0===t.length)return new Qs(null);return new Qs(Ks(t))};function js(t,e,n,r,i){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=i,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Ws=js.prototype;function Ys(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function Is(t,e){var n=Ks(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function Fs(t,e){var n=t.intervals([]);n.push(e),Is(t,n)}function _s(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),Is(t,n),1)}function Gs(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var i=n(t[r]);if(i)return i}}function Xs(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var i=n(t[r]);if(i)return i}}function Us(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Hs(t,e){return t-e}function Vs(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Zs(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Ks(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Hs);var r=e[e.length>>1],i=[],o=[],a=[];for(n=0;n<t.length;++n){var s=t[n];s[1]<r?i.push(s):r<s[0]?o.push(s):a.push(s)}var l=a,c=a.slice();return l.sort(Vs),c.sort(Zs),new js(r,Ks(i),Ks(o),l,c)}function Qs(t){this.root=t}Ws.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Ws.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?Fs(this,t):this.left.insert(t):this.left=Ks([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?Fs(this,t):this.right.insert(t):this.right=Ks([t]);else{var n=Ds.ge(this.leftPoints,t,Vs),r=Ds.ge(this.rightPoints,t,Zs);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Ws.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?_s(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?_s(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var i=this.left,o=this.right;n.count-=r.count,n.right=r.left,r.left=i,r.right=o}Ys(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Ys(this,this.left):Ys(this,this.right);return 1}for(i=Ds.ge(this.leftPoints,t,Vs);i<this.leftPoints.length&&this.leftPoints[i][0]===t[0];++i)if(this.leftPoints[i]===t){this.count-=1,this.leftPoints.splice(i,1);for(o=Ds.ge(this.rightPoints,t,Zs);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),1}return 0},Ws.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Gs(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Xs(this.rightPoints,t,e)}return Us(this.leftPoints,e)},Ws.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Gs(this.leftPoints,e,n):t>this.mid?Xs(this.rightPoints,t,n):Us(this.leftPoints,n)};var Js=Qs.prototype;Js.insert=function(t){this.root?this.root.insert(t):this.root=new js(t[0],null,null,[t],[t])},Js.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Js.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Js.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Js,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Js,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});const tl=({marginLeft:t})=>[1,t],el=({width:t,marginRight:e})=>[-1,t-e],nl=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],rl=({marginTop:t})=>[1,t],il=({height:t,marginBottom:e})=>[-1,t-e],ol=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function al(t){return"string"==typeof t?{anchor:t}:t}function sl(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function ll(t,e,n,r,i){const{r:o}=i;if(null!=o&&"number"!=typeof o){const{channels:t,sort:e,reverse:n}=i;i={...i,channels:{r:{value:o,scale:"r"},...at(t)}},void 0===e&&void 0===n&&(i.sort={channel:"r",order:"descending"})}return kt(i,(function(o,a,s,c,u,h){let{[e]:d,r:p}=s;if(!s[e])throw new Error(`missing channel: ${e}`);({[e]:d}=Cr(s,c,h));const g=p?void 0:void 0!==this.r?this.r:void 0!==i.r?m(i.r):3;p&&(p=gr(l(p.value,c[p.scale]||f)));let[y,v]=n(u);const x=y?ul:cl,w=new Float64Array(d.length),b=p?t=>p[t]:()=>g;for(let t of a){const e=qs();t=t.filter(p?t=>vt(d[t])&&xt(p[t]):t=>vt(d[t]));const n=new Float64Array(2*t.length+2);for(const i of t){const t=b(i),o=y?t+r:0,a=d[i]-t,s=d[i]+t;let l=2;e.queryInterval(a-r,s+r,(([,,t])=>{const e=w[t]-o,a=d[i]-d[t],s=r+(p?p[i]+p[t]:2*g),c=Math.sqrt(s*s-a*a);n[l++]=e-c,n[l++]=e+c}));let c=n.slice(0,l);y&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(x)){for(let e=0;e<l;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;w[i]=t+o;break}e.insert([a,s,i])}}y||(y=1);for(const t of a)for(const e of t)w[e]=w[e]*y+v;return{data:o,facets:a,channels:{[e]:{value:d},[t]:{value:w},...p&&{r:{value:p}}}}}))}function cl(t,e){return Math.abs(t)-Math.abs(e)}function ul(t,e){return t-e}function fl(t){if(void 0===t)return ml;if("function"==typeof t)return hl(((e,n)=>t(j(n,e))));if(/^p\d{2}$/i.test(t))return dl(b(t));switch(`${t}`.toLowerCase()){case"deviation":return yl;case"first":return ml;case"last":return gl;case"max":return vl;case"mean":return xl;case"median":return wl;case"min":return bl;case"sum":return kl;case"extent":return pl}throw new Error(`invalid basis: ${t}`)}function hl(t){return{map(e,n,r){const i=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/i}}}function dl(t){return hl(((e,n)=>t(e,(t=>n[t]))))}const pl={map(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=o-i;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-i)/a}},ml=hl(((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(pt(r))return r}})),gl=hl(((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(pt(r))return r}})),yl={map(t,n,r){const i=e.mean(t,(t=>n[t])),o=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:o?(n[e]-i)/o:0}},vl=dl(e.max),xl=dl(e.mean),wl=dl(e.median),bl=dl(e.min),kl=dl(e.sum);function $l(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:i,anchor:o,strict:a}=t;if(void 0===o&&void 0!==i&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(i),Ne(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return Ll(b(t));switch(t.toLowerCase()){case"deviation":return Ll(e.deviation);case"max":return Al(e.max);case"mean":return El;case"median":return Ll(e.median);case"min":return Al(e.min);case"mode":return Al(e.mode);case"sum":return zl;case"variance":return Ll(e.variance);case"difference":return Nl;case"ratio":return Sl;case"first":return Pl;case"last":return Tl}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return Al(t)}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(o,n),a)}function Ml(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function Ll(t){return(e,n,r)=>r?{map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));let s=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++s;for(let i=0,l=r.length-e+1;i<l;++i)isNaN(a[i+e-1])&&++s,o[r[i+n]]=0===s?t(a.subarray(i,i+e)):NaN,isNaN(a[i])&&--s}}:{map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));for(let i=-n;i<0;++i)o[r[i+n]]=t(a.subarray(0,i+e));for(let i=0,s=r.length-n;i<s;++i)o[r[i+n]]=t(a.subarray(i,i+e))}}}function Al(t){return(e,n,r)=>r?{map(r,i,o){let a=0;for(let t=0;t<e-1;++t)a+=pt(i[r[t]]);for(let s=0,l=r.length-e+1;s<l;++s)a+=pt(i[r[s+e-1]]),a===e&&(o[r[s+n]]=t(j(i,Ml(r,s,s+e)))),a-=pt(i[r[s]])}}:{map(r,i,o){for(let a=-n;a<0;++a)o[r[a+n]]=t(j(i,Ml(r,0,a+e)));for(let a=0,s=r.length-n;a<s;++a)o[r[a+n]]=t(j(i,Ml(r,a,a+e)))}}}function zl(t,e,n){return n?{map(n,r,i){let o=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++o:a+=+t}for(let s=0,l=n.length-t+1;s<l;++s){const l=r[n[s]],c=r[n[s+t-1]];null===c||isNaN(c)?++o:a+=+c,i[n[s+e]]=0===o?a:NaN,null===l||isNaN(l)?--o:a-=+l}}}:{map(n,r,i){let o=0;const a=n.length;for(let i=0,s=Math.min(a,t-e-1);i<s;++i)o+=+r[n[i]]||0;for(let s=-e,l=a-e;s<l;++s)o+=+r[n[s+t-1]]||0,i[n[s+e]]=o,o-=+r[n[s]]||0}}}function El(t,e,n){if(n){const r=zl(t,e,n);return{map(n,i,o){r.map(n,i,o);for(let r=0,i=n.length-t+1;r<i;++r)o[n[r+e]]/=t}}}return{map(n,r,i){let o=0,a=0;const s=n.length;for(let i=0,l=Math.min(s,t-e-1);i<l;++i){let t=r[n[i]];null===t||isNaN(t=+t)||(o+=t,++a)}for(let l=-e,c=s-e;l<c;++l){let s=r[n[l+t-1]],c=r[n[l]];null===s||isNaN(s=+s)||(o+=s,++a),i[n[l+e]]=o/a,null===c||isNaN(c=+c)||(o-=c,--a)}}}}function Rl(t,e,n,r){for(let i=n+r;n<i;++n){const r=t[e[n]];if(pt(r))return r}}function Cl(t,e,n,r){for(let i=n+r-1;i>=n;--i){const n=t[e[i]];if(pt(n))return n}}function Ol(t,e,n,r){for(let i=n+r;n<i;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function Bl(t,e,n,r){for(let i=n+r-1;i>=n;--i){let n=t[e[i]];if(null!==n&&!isNaN(n=+n))return n}}function Nl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s-a}}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Bl(r,n,o,t)-Ol(r,n,o,t)}}}function Sl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s/a}}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Bl(r,n,o,t)/Ol(r,n,o,t)}}}function Pl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o]]}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Rl(r,n,o,t)}}}function Tl(t,e,n){return n?{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o+t-1]]}}:{map(n,r,i){for(let o=-e,a=n.length-t+e+1;o<a;++o)i[n[o+e]]=Cl(r,n,o,t)}}}function Dl(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Il;case"max":return Fl}throw new Error(`unknown selector: ${t}`)}function ql(t){return _l(null,Wl,t)}function jl(t){return _l(null,Yl,t)}function*Wl(t){yield t[0]}function*Yl(t){yield t[t.length-1]}function*Il(t,n){yield e.least(t,(t=>n[t]))}function*Fl(t,n){yield e.greatest(t,(t=>n[t]))}function _l(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const i=T(r);return bt(r,((r,o)=>{const a=l(r,i),s=l(r,t),c=[];for(const t of o){const r=[];for(const i of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(i,s))r.push(t);c.push(r)}return{data:r,facets:c}}))}const Gl={ariaLabel:"brush",fill:"#777",fillOpacity:.3,stroke:"#fff"};class Xl extends ri{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",optional:!0},y:{value:n,scale:"y",optional:!0}},r,Gl),this.initialX=r.initialX,this.initialY=r.initialY,this.activeElement=null}render(t,n,r,i,o){const{x:a,y:s}=r,{x:l,y:c}=n,{ariaLabel:u,ariaDescription:f,ariaHidden:h,...d}=this,{marginLeft:p,width:m,marginRight:g,marginTop:y,height:v,marginBottom:x}=i,w=this,b=(a&&s?e.brush:a?e.brushX:e.brushY)().extent([[p,y],[m-g,v-x]]),k=e.create("svg:g",o).call(_e,{ariaLabel:u,ariaDescription:f,ariaHidden:h},n,i,o).call(b).call((t=>t.selectAll(".selection").attr("shape-rendering",null).call(_e,d,i,o).call(Ve,this,n)));if(this.initialX&&this.initialY&&l&&c){const[t,e]=this.initialX.map(l),[n,r]=this.initialY.map(c);k.call(b.move,[[t,n],[e,r]])}if(this.initialX&&a){const[t,e]=this.initialX.map(l);k.call(b.move,[t,e])}else if(this.initialY&&s){const[t,e]=this.initialY.map(c);k.call(b.move,[t,e])}b.on("start end brush",(function(n){const{type:r,selection:i}=n;"start"===r&&w.activeElement!==this&&(null!==w.activeElement&&(e.select(w.activeElement).call(n.target.clear,n),w.activeElement[ei]=null),w.activeElement=this);let o,u,f=null;if(i){if(f=t,a){let[t,e]=s?[i[0][0],i[1][0]]:i;o=[l.invert(t),l.invert(e)],l.bandwidth&&(t-=l.bandwidth()),f=f.filter((n=>t<=a[n]&&a[n]<=e))}if(s){let[t,e]=a?[i[0][1],i[1][1]]:i;u=[c.invert(t),c.invert(e)],c.bandwidth&&(t-=c.bandwidth()),f=f.filter((n=>t<=s[n]&&s[n]<=e))}}if(!function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;++r)if(t[r]!==e[r])return!1;return!0}(this[ei],f)||"end"===n.type){this[ei]=f;const t=null===f?w.data:j(w.data,f);this.dispatchEvent(new CustomEvent("input",{bubbles:!0,detail:{type:n.type,selected:t,extentX:o,extentY:u}}))}}));const $=k.node();return $[ei]=null,$}}const Ul={ariaLabel:"pointer",fill:"none",stroke:"#3b5fc0",strokeWidth:1.5};class Hl extends ri{constructor(t,{x:e,y:n,n:r=1,r:i=(isFinite(r)?120:20),mode:o="auto",...a}={}){super(t,[{name:"x",value:e,scale:"x",optional:!0},{name:"y",value:n,scale:"y",optional:!0}],a,Ul),this.n=+r,this.r=+i,this.mode=function(t="auto",e,n){switch(t=`${t}`.toLowerCase()){case"auto":t=null==n?"x":null==e?"y":"xy";break;case"x":case"y":case"xy":break;default:throw new Error(`invalid mode: ${t}`)}if(/^x/.test(t)&&null==e)throw new Error("missing channel: x");if(/y$/.test(t)&&null==n)throw new Error("missing channel: y");return t}(o,e,n)}render(t,{x:n,y:r},{x:i,y:o},a){const{marginLeft:s,width:l,marginRight:c,marginTop:u,height:f,marginBottom:h}=a,{mode:d,n:p,r:m}=this,g=m*m,y=new Set;let v=[],x=null;const w=e.create("svg:g"),b=w.append("g").call(_e,this,a).call(Ge,this).node(),k=n?.bandwidth?.(),$=r?.bandwidth?.(),M=i&&o?k&&$?t=>Vl("rect",{x:i[t],y:o[t],width:k,height:$}):k?t=>Vl("line",{x1:i[t],x2:i[t]+k,y1:o[t],y2:o[t]}):$?t=>Vl("line",{x1:i[t],x2:i[t],y1:o[t],y2:o[t]+$}):t=>Vl("circle",{cx:i[t],cy:o[t],r:4}):i?k?t=>Vl("rect",{x:i[t],y:u,width:k,height:f-h-u}):t=>Vl("line",{x1:i[t],x2:i[t],y1:u,y2:f-h}):$?t=>Vl("rect",{x:s,y:o[t],width:l-c-s,height:$}):t=>Vl("line",{y1:o[t],y2:o[t],x1:s,x2:l-c});function L(t){const e=[];let n=!1;return t.forEach((t=>{let r=v[t];r||(r=M(t),b.appendChild(r),n=!0),e[t]=r})),v.forEach(((t,r)=>{e[r]||(t.remove(),n=!0)})),n&&(v=e),n}function A(t){if(null===t)L([]);else if(!L(t))return;z[ei]=t,z.dispatchEvent(new Event("input",{bubbles:!0}))}w.append("rect").attr("fill","none").attr("pointer-events","all").attr("width",l+s+c).attr("height",f+u+h).on("pointerdown pointerover pointermove",(a=>{if("pointerdown"===a.type){const t=!x;if(y.add(a.pointerId),!t&&a.shiftKey||(x=[]),!t&&!a.shiftKey)return A(x)}if(x&&!y.has(a.pointerId))return;let[s,l]=e.pointer(a);n.bandwidth&&(s-=n.bandwidth()/2),r.bandwidth&&(l-=r.bandwidth()/2);let c=t;switch(d){case"xy":m<1/0&&(c=c.filter((t=>{const e=i[t]-s,n=o[t]-l;return e*e+n*n<=g}))),c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=i[t]-s,r=o[t]-l,a=i[e]-s,c=o[e]-l;return n*n+r*r-(a*a+c*c)})),c=c.slice(0,p));break;case"x":if(m<1/0){const[t,e]=[s-m,s+m];c=c.filter((n=>t<=i[n]&&i[n]<=e))}c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=i[t]-s,r=i[e]-s;return n*n-r*r})),c=c.slice(0,p));break;case"y":if(m<1/0){const[t,e]=[l-m,l+m];c=c.filter((n=>t<=o[n]&&o[n]<=e))}c.length>p&&(c=c.slice(),e.quickselect(c,p,void 0,void 0,((t,e)=>{const n=o[t]-l,r=o[e]-l;return n*n-r*r})),c=c.slice(0,p))}A(x?x=Array.from(e.union(x,c)):c)})).on("pointerup",(t=>{x&&!x.length&&A(x=null),y.delete(t.pointerId)})).on("pointerout",(()=>{x||A(null)}));const z=w.node();return z[ei]=null,z}}function Vl(t,n){const r=document.createElementNS(e.namespaces.svg,t);for(const t in n)r.setAttribute(t,n[t]);return r}t.Area=ro,t.Arrow=bo,t.BarX=Lo,t.BarY=Ao,t.Brush=Xl,t.Cell=oa,t.Density=wa,t.Dot=jo,t.Frame=Ma,t.Geo=Aa,t.Hexgrid=Oa,t.Image=Na,t.Line=Ta,t.Link=yo,t.Mark=ri,t.Pointer=Hl,t.Rect=Va,t.RuleX=Io,t.RuleY=Fo,t.Text=Ka,t.TickX=Vo,t.TickY=Zo,t.Vector=Cs,t.area=function(t,e){return void 0===e?io(t,{x:y,y:v}):new ro(t,e)},t.areaX=function(t,e){const{y:n=u,...r}=$i(e);return new ro(t,qi(Si({...r,y1:n,y2:void 0})))},t.areaY=io,t.arrow=function(t,e={}){let{x:n,x1:r,x2:i,y:o,y1:a,y2:s,...l}=e;return[r,i]=xo(n,r,i),[a,s]=xo(o,a,s),new bo(t,{...l,x1:r,x2:i,y1:a,y2:s})},t.barX=zo,t.barY=Eo,t.bin=function(t={fill:"count"},e={}){[t,e]=Li(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Ai(e,t),n=Ai(n,t),[e.value,n.value]=P(e.value,n.value),{x:e,y:n}}(e);return Mi(n,r,null,null,t,nn(rn(e)))},t.binX=xi,t.binY=wi,t.boxX=function(t,e={}){const{x:n={transform:t=>t},y:r=null,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?St:Bt;return ii(Go(t,f({x1:ta,x2:ea},{x:n,y:r,stroke:a,strokeOpacity:s,...u})),zo(t,f({x1:"p25",x2:"p75"},{x:n,y:r,fill:i,fillOpacity:o,...u})),Ko(t,f({x:"p50"},{x:n,y:r,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),Wo(t,Oo({x:Jo},{x:n,y:r,z:r,stroke:a,strokeOpacity:s,...u})))},t.boxY=function(t,e={}){const{y:n={transform:t=>t},x:r=null,fill:i="#ccc",fillOpacity:o,stroke:a="currentColor",strokeOpacity:s,strokeWidth:l=2,sort:c,...u}=e,f=null!=r?Nt:Bt;return ii(_o(t,f({y1:ta,y2:ea},{x:r,y:n,stroke:a,strokeOpacity:s,...u})),Eo(t,f({y1:"p25",y2:"p75"},{x:r,y:n,fill:i,fillOpacity:o,...u})),Qo(t,f({y:"p50"},{x:r,y:n,stroke:a,strokeOpacity:s,strokeWidth:l,sort:c,...u})),Wo(t,Oo({y:Jo},{x:r,y:n,z:r,stroke:a,strokeOpacity:s,...u})))},t.brush=function(t,{x:e,y:n,...r}={}){return[e,n]=P(e,n),new Xl(t,{...r,x:e,y:n})},t.brushX=function(t,{x:e=f,...n}={}){return new Xl(t,{...n,x:e})},t.brushY=function(t,{y:e=f,...n}={}){return new Xl(t,{...n,y:e})},t.cell=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=P(n,r),new oa(t,{...i,x:n,y:r})},t.cellX=function(t,e={}){let{x:n=u,fill:r,stroke:i,...o}=e;return void 0===r&&void 0===k(i)[0]&&(r=f),new oa(t,{...o,x:n,fill:r,stroke:i})},t.cellY=function(t,e={}){let{y:n=u,fill:r,stroke:i,...o}=e;return void 0===r&&void 0===k(i)[0]&&(r=f),new oa(t,{...o,y:n,fill:r,stroke:i})},t.circle=function(t,e){return Wo(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return Es(t,{...n,treeLayout:e.cluster})},t.column=I,t.delaunayLink=function(t,e){return va(fa,t,e)},t.delaunayMesh=function(t,e){return va(da,t,e)},t.density=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=P(n,r),new wa(t,{...i,x:n,y:r})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=sl(t));let{anchor:n="left",padding:r=1}=al(t);switch(`${n}`.toLowerCase()){case"left":n=tl;break;case"right":n=el;break;case"middle":n=nl;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return ll("x","y",n,m(r),e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=sl(t));let{anchor:n="bottom",padding:r=1}=al(t);switch(`${n}`.toLowerCase()){case"top":n=rl;break;case"bottom":n=il;break;case"middle":n=ol;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return ll("y","x",n,m(r),e)},t.dot=Wo,t.dotX=function(t,e={}){const{x:n=f,...r}=e;return new jo(t,mn({...r,x:n}))},t.dotY=function(t,e={}){const{y:n=f,...r}=e;return new jo(t,pn({...r,y:n}))},t.filter=function(t,e){return Lt(e,At(t))},t.formatIsoDate=Ce,t.formatMonth=function(t="en-US",e="short"){const n=Ee(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=Re(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=function(t){return new Ma(t)},t.geo=za,t.graticule=function({strokeOpacity:t=.1,...n}={}){return za(e.geoGraticule10(),{strokeOpacity:t,...n})},t.group=function(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=P(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Pt(n,r,t,e)},t.groupX=Nt,t.groupY=St,t.groupZ=Bt,t.hexagon=function(t,e){return Wo(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){e=void 0===e?20:m(e),t=Dt(t,n);const{z:r,fill:i,stroke:o}=n;return void 0===o&&nt(i)&&Tt(t,"fill")&&(n.stroke="none"),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||Tt(t,"r")||(n.r=e/2),kt(n,((n,i,o,a,s,c)=>{let{x:u,y:f,z:h,fill:d,stroke:p,symbol:m}=o;if(void 0===u)throw new Error("missing channel: x");if(void 0===f)throw new Error("missing channel: y");({x:u,y:f}=Cr(o,a,c)),h=h?h.value:l(n,r),d=d?.value,p=p?.value,m=m?.value;const g=It(t,{z:h,fill:d,stroke:p,symbol:m}),y=h&&[],v=d&&[],x=p&&[],w=m&&[],b=[],k=[],$=[];let M=-1;for(const e of t)e.initialize(n);for(const n of i){const r=[];for(const e of t)e.scope("facet",n);for(const[i,o]of Wt(n,g))for(const n of Ra(o,u,f,e)){r.push(++M),k.push(n.x),$.push(n.y),h&&y.push(g===h?i:h[n[0]]),d&&v.push(g===d?i:d[n[0]]),p&&x.push(g===p?i:p[n[0]]),m&&w.push(g===m?i:m[n[0]]);for(const e of t)e.reduce(n)}b.push(r)}return{data:n,facets:b,channels:{x:{value:k},y:{value:$},...h&&{z:{value:y}},...d&&{fill:{value:v,scale:!0}},...p&&{stroke:{value:x,scale:!0}},...m&&{symbol:{value:w,scale:!0}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:!0,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Oa(t)},t.hull=function(t,e){return va(pa,t,e)},t.image=function(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=P(n,r)),new Na(t,{...i,x:n,y:r})},t.initializer=kt,t.legend=function(t={}){for(const[e,n]of Kr){const r=t[e];if(O(r)){const i=Or(t);let o;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&O(t.color)?"color":void 0)}=t;o={fill:e,stroke:n}}return n(rr(e,r,o),Qr(i,r,t),(e=>O(t[e])?rr(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=function(t,e={}){let{x:n,y:r,...i}=e;return[n,r]=P(n,r),new Ta(t,{...i,x:n,y:r})},t.lineX=function(t,e={}){const{x:n=f,y:r=u,...i}=e;return new Ta(t,$i({...i,x:n,y:r}))},t.lineY=function(t,e={}){const{x:n=u,y:r=f,...i}=e;return new Ta(t,ki({...i,x:n,y:r}))},t.linearRegressionX=function(t,e={}){const{y:n=u,x:r=f,stroke:i,fill:o=(nt(i)?"currentColor":i),...a}=e;return new _a(t,$i({...a,x:r,y:n,fill:o,stroke:i}))},t.linearRegressionY=function(t,e={}){const{x:n=u,y:r=f,stroke:i,fill:o=(nt(i)?"currentColor":i),...a}=e;return new Ga(t,ki({...a,x:n,y:r,fill:o,stroke:i}))},t.link=vo,t.map=Oo,t.mapX=Ro,t.mapY=Co,t.marks=ii,t.normalize=fl,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Ro(fl(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Co(fl(t),e)},t.plot=ni,t.pointer=function(t,{x:e,y:n,...r}={}){return[e,n]=P(e,n),new Hl(t,{...r,x:e,y:n})},t.pointerX=function(t,{mode:e="x",x:n=f,...r}={}){return new Hl(t,{...r,mode:e,x:n})},t.pointerY=function(t,{mode:e="y",y:n=f,...r}={}){return new Hl(t,{...r,mode:e,y:n})},t.rect=function(t,e){return new Va(t,un(fn(e)))},t.rectX=function(t,e={y:u,interval:1,x2:f}){return new Va(t,qi(fn(Si(e))))},t.rectY=function(t,e={x:u,interval:1,y2:f}){return new Va(t,ji(un(Pi(e))))},t.reverse=function(t){return{...Lt(t,zt),sort:null}},t.ruleX=_o,t.ruleY=Go,t.scale=function(t={}){let e;for(const n in t)if(dt.has(n)&&O(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=xr(rr(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return ql(e);case"last":return jl(e)}if("function"==typeof t)return _l(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=Dl(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return _l(n,r,e)},t.selectFirst=ql,t.selectLast=jl,t.selectMaxX=function(t){return _l("x",Fl,t)},t.selectMaxY=function(t){return _l("y",Fl,t)},t.selectMinX=function(t){return _l("x",Il,t)},t.selectMinY=function(t){return _l("y",Il,t)},t.selection=ei,t.shuffle=function(t={}){const{seed:n,...r}=t;return{...Lt(r,Ot(null==n?Math.random:e.randomLcg(n))),sort:null}},t.sort=Et,t.sphere=function({strokeWidth:t=1.5,...e}={}){return za({type:"Sphere"},{strokeWidth:t,...e})},t.stackX=Ti,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{y1:n,y:r=n,x:i}=e,[o,a,s]=Yi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{y1:n,y:r=n,x:i}=e,[o,a,,s]=Yi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackY=Di,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{x1:n,x:r=n,y:i}=e,[o,a,s]=Yi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=Wi(t));const{x1:n,x:r=n,y:i}=e,[o,a,,s]=Yi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.text=Ja,t.textX=function(t,e={}){const{x:n=f,...r}=e;return new Ka(t,mn({...r,x:n}))},t.textY=function(t,e={}){const{y:n=f,...r}=e;return new Ka(t,pn({...r,y:n}))},t.tickX=Ko,t.tickY=Qo,t.transform=bt,t.tree=Es,t.treeLink=ss,t.treeNode=as,t.valueof=l,t.vector=function(t,e={}){let{x:n,y:r,...i}=e;return void 0===e.frameAnchor&&([n,r]=P(n,r)),new Cs(t,{...i,x:n,y:r})},t.vectorX=function(t,e={}){const{x:n=f,...r}=e;return new Cs(t,{...r,x:n})},t.vectorY=function(t,e={}){const{y:n=f,...r}=e;return new Cs(t,{...r,y:n})},t.version="0.6.1",t.voronoi=function(t,e){return va(ma,t,e)},t.voronoiMesh=function(t,e){return va(ga,t,e)},t.window=$l,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),Ro($l(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),Co($l(t),e)}}));
